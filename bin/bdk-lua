#!/bin/sh

if [ "${BDK_ROOT}" = "" ]
then
    echo "The BDK_ROOT environment variable is not set"
    exit 1
fi

ARCH=`uname -m`
if [ "${ARCH}" = "octeon" ]
then
    LUA_BIN=${BDK_ROOT}/bin/bdk-lua-octeon
elif [ "${ARCH}" = "octeon2" ]
then
    LUA_BIN=${BDK_ROOT}/bin/bdk-lua-octeon
elif [ "${ARCH}" = "mips64" ]
then
    LUA_BIN=${BDK_ROOT}/bin/bdk-lua-octeon
elif [ "${ARCH}" = "ppc" ]
then
    LUA_BIN=${BDK_ROOT}/bin/bdk-lua-ppc
else
    LUA_BIN=${BDK_ROOT}/bin/bdk-lua-x86
fi

if [ ! -x "${LUA_BIN}" ]
then
    echo "Unable to find executable bdk-lua at the expected path."
    echo "Are you sure BDK_ROOT is correct?"
    echo "BDK_ROOT=${BDK_ROOT}"
    exit 1
fi

LUA_PATH="${LUA_PATH};${BDK_ROOT}/lua-modules/?.lua" "${LUA_BIN}" $*
