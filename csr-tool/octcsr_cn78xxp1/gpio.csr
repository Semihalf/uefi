# -*- csr3 -*-
# You must run "csr3 rtl" after editing this file!
---
name: GPIO
enums:
  - name: GPIO_INTSN_E
    attributes:
      width: "20"
    description: Enumerates the different generated interrupts.
    values:
      - name: GPIO_INTR(0..15)
        value: 0x03000 + a
        attributes:
          intsn_lsb_mismatch: "True"
        description: GPIO general interrupts; see GPIO_INTR(0..15)[INTR].

      - name: GPIO_MC_INTR(4..7)_PP(0..47)
        value: 0x03800 + (a-4)*0x100 + b
        description: GPIO multicast interrupts; see GPIO_MC_INTR(4..7)[INTR<b>].


  - name: GPIO_OUTSEL_E
    attributes:
      width: "5"
    description: Enumerates the different GPIO output selections for GPIO_BIT_CFG(0..19)[OUTPUT_SEL].
    values:
      - name: TX
        value: 0x00
        description: Normal GPIO output, controlled by GPIO_TX_SET, GPIO_TX_CLR.

      - name: PTP_CKOUT
        value: 0x01
        description: PTP CKOUT output; see MIO_PTP_CLOCK_CFG.

      - name: PTP_PPS
        value: 0x02
        description: PTP PPS output; see MIO_PTP_CLOCK_CFG.

      - name: CLK_SYNCE(0..1)
        value: 0x03 + a
        description: CLK_SYNCE(a); see GPIO_CLK_SYNCE(0..1).

      - name: MCD(0..2)
        value: 0x05 + a
        description: Multichip debug output; see TBD.

      - name: LMC_ECC(0..2)
        value: 0x08 + a
        description: LMC ECC error detected; see TBD.

      - name: CLK(0..3)
        value: 0x10 + a
        description: GPIO clock generator; see GPIO_CLK_GEN(0..3).

      - name: USBH_VBUS_CTRL
        value: 0x14
        description: USBH Vbus control; see TBD.


registers:
  - name: GPIO_RX_DAT
    title: GPIO Receive Data Register
    address: 0x1070000000880
    bus: NCB
    description: This register contains the state of the GPIO pins.
    fields:
      - name: --
        bits: 63..20
        access: ---
        reset: --
        typical: --
        description: Reserved.

      - name: DAT
        bits: 19..0
        access: RO/H
        reset: 0x0
        typical: 0x0
        description: GPIO read data.


  - name: GPIO_TX_SET
    title: GPIO Transmit Set Mask Register
    address: 0x1070000000888
    bus: NCB
    fields:
      - name: --
        bits: 63..20
        access: ---
        reset: --
        typical: --
        description: Reserved.

      - name: SET
        bits: 19..0
        access: R/W1S/H
        reset: 0x0
        typical: 0x0
        description: |
          Set mask. Bit mask to indicate which GPIO_TX_DAT bits to set to 1. When read, SET returns
          the GPIO_TX_DAT storage.


  - name: GPIO_TX_CLR
    title: GPIO Transmit Clear Mask Register
    address: 0x1070000000890
    bus: NCB
    fields:
      - name: --
        bits: 63..20
        access: ---
        reset: --
        typical: --
        description: Reserved.

      - name: CLR
        bits: 19..0
        access: R/W1C/H
        reset: 0x0
        typical: 0x0
        description: |
          Clear mask. Bit mask to indicate which GPIO_TX_DAT bits to set to 0. When read, CLR
          returns the GPIO_TX_DAT storage.


  - name: GPIO_USBH_CTL
    title: GPIO USBH Pin Register
    address: 0x1070000000898
    bus: NCB
    fields:
      - name: --
        bits: 63..5
        access: ---
        reset: --
        typical: --
        description: Reserved.

      - name: SEL
        bits: 4..0
        access: R/W
        reset: 0x1f
        typical: 0x0
        description: |
          Selects the GPIO(0..19) input pin for USBH over-current control. With SEL values 20-31,
          signal is always zero.


  - name: GPIO_TIM_CTL
    title: GPIO Timer Pin Register
    address: 0x10700000008A0
    bus: NCB
    fields:
      - name: --
        bits: 63..5
        access: ---
        reset: --
        typical: --
        description: Reserved.

      - name: SEL
        bits: 4..0
        access: R/W
        reset: 0x0
        typical: 0x0
        description: Selects the GPIO(0..19) input pin to use in the Timer coprocessor for GPIO-based timing.


  - name: GPIO_OCLA_EXTEN_TRIG
    title: GPIO OCLA External Trigger Register
    address: 0x10700000008A8
    bus: NCB
    fields:
      - name: --
        bits: 63..5
        access: ---
        reset: --
        typical: --
        description: Reserved.

      - name: SEL
        bits: 4..0
        access: R/W
        reset: 0x0
        typical: 0x0
        description: Selects the GPIO(0..19) input pin to use in the OCLA coprocessor for GPIO-based triggering.


  - name: GPIO_MULTI_CAST
    title: GPIO Multicast Register
    address: 0x10700000008B0
    bus: NCB
    description: This register enables multicast GPIO interrupts.
    fields:
      - name: --
        bits: 63..1
        access: ---
        reset: --
        typical: --
        description: Reserved.

      - name: EN
        bits: 0
        access: R/W
        reset: 0
        typical: 0
        description: |
          Enable GPIO interrupt multicast mode. When EN is set, GPIO<7:4> functions in multicast
          mode allowing these four GPIOs to interrupt multiple cores. Multicast functionality allows
          the GPIO to exist as per-cnMIPS interrupts as opposed to a global interrupt.


  - name: GPIO_CLK_GEN(0..3)
    title: GPIO Clock Generator Registers
    address: 0x10700000008C0 + a*0x8
    bus: NCB
    fields:
      - name: --
        bits: 63..32
        access: ---
        reset: --
        typical: --
        description: Reserved.

      - name: N
        bits: 31..0
        access: R/W
        reset: 0x0
        typical: --
        description: |
          Determines the frequency of the GPIO clock generator. N should be less than or equal to
          231-1.
          The frequency of the GPIO clock generator equals the coprocessor-clock frequency times N
          divided by 232.
          Writing N = 0x0 stops the clock generator.


  - name: GPIO_CLK_SYNCE(0..1)
    title: GPIO Clock SyncE Registers
    address: 0x10700000008E0 + a*0x8
    bus: NCB
    description: |
      A QLM can be configured as a clock source. The following table shows the clock speed output
      for different modes.
    fields:
      - name: --
        bits: 63..12
        access: ---
        reset: --
        typical: --
        description: Reserved.

      - name: QLM_SEL
        bits: 11..8
        access: R/W
        reset: 0x0
        typical: 0x0
        description: Selects which QLM(0..7) to select from.

      - name: --
        bits: 7..4
        access: ---
        reset: --
        typical: --
        description: Reserved.

      - name: DIV
        bits: 3..2
        access: R/W
        reset: 0x0
        typical: 0x0
        description: Internal clock divider. 0 = DIV2, 1 = DIV4, 2 = DIV8, 3 = DIV16.

      - name: LANE_SEL
        bits: 1..0
        access: R/W
        reset: 0x0
        typical: 0x0
        description: |
          Selects which RX lane clock from QLMx to use as the GPIO internal QLMx clock. The GPIO
          block can support up to two unique clocks to send out any GPIO pin as configured by
          GPIO_BIT_CFG(0..19)[SYNCE_SEL]. The clock can be divided by 2, 4, 8 or 16 of the selected
          RX lane clock.


  - name: GPIO_BIT_CFG(0..19)
    title: GPIO Bit Configuration Registers
    address: 0x1070000000900 + a*0x8
    bus: NCB
    description: Each register provides configuration information for the corresponding GPIO pin.
    fields:
      - name: --
        bits: 63..21
        access: ---
        reset: --
        typical: --
        description: Reserved.

      - name: OUTPUT_SEL
        bits: 20..16
        access: R/W
        reset: 0x0
        typical: 0x0
        description: |
          Selects GPIO output. When [TX_OE] is set, selects what output data is driven. Enumerated
          by GPIO_OUTSEL_E.

      - name: --
        bits: 15..12
        access: ---
        reset: --
        typical: --
        description: Reserved.

      - name: FIL_SEL
        bits: 11..8
        access: R/W
        reset: 0x0
        typical: 0x0
        description: Filter select. Global counter bit-select (controls sample rate).

      - name: FIL_CNT
        bits: 7..4
        access: R/W
        reset: 0x0
        typical: 0x0
        description: Filter count. Specifies the number of consecutive samples to change state.

      - name: INT_EDGE
        bits: 3
        access: R/W
        reset: 0
        typical: 0
        description: Type of interrupt when pin is an input. When set, rising edge interrupt, else level interrupt.

      - name: --
        bits: 2
        access: ---
        reset: --
        typical: --
        description: Reserved.

      - name: RX_XOR
        bits: 1
        access: R/W
        reset: 0
        typical: 0
        description: Receive inversion. When set to 1, inverts the received GPIO signal.

      - name: TX_OE
        bits: 0
        access: R/W
        reset: 0
        typical: 0
        description: Transmit output enable. When set to 1, the GPIO pin is driven as an output pin.


  - name: GPIO_INTR(0..15)
    title: GPIO Bit Interrupt Registers
    address: 0x1070000000A00 + a*0x8
    bus: NCB
    description: Each register provides interrupt information for the corresponding GPIO pin.
    fields:
      - name: --
        bits: 63..1
        access: ---
        reset: --
        typical: --
        description: Reserved.

      - name: INTR
        bits: 0
        access: R/W1C/H
        reset: 0
        typical: 0
        description: |
          GPIO signalled interrupt. If interrupts are edge sensitive, write one to clear, otherwise
          will clear automatically when GPIO pin de-asserts. Throws GPIO_INTSN_E::GPIO_INTR(0..15).


  - name: GPIO_MC_INTR(4..7)
    title: GPIO Bit Multicast Interrupt Registers
    address: 0x1070000000C00 + a*0x8
    bus: NCB
    description: Each register provides interrupt multicasting for GPIO(4..7).
    fields:
      - name: --
        bits: 63..48
        access: ---
        reset: --
        typical: --
        description: Reserved.

      - name: INTR
        bits: 47..0
        access: R/W1C/H
        reset: 0x0
        typical: 0x0
        description: |
          GPIO interrupt for each core. When corresponding GPIO4-7 is edge-triggered and MILTI_CAST
          is enabled, a GPIO assertion will set all 48 bits. Each bit is expected to be routed to
          interrupt a different core using the CIU, and each core will then write one to clear its
          corresponding bit in this register. Throws GPIO_INTSN_E::GPIO_MC_INTR(4..7)_PP(0..47).


  - name: GPIO_COMP
    title: GPIO Compensation Register
    address: 0x1070000000D00
    bus: NCB
    fields:
      - name: --
        bits: 63..11
        access: ---
        reset: --
        typical: --
        description: Reserved.

      - name: PCTL
        bits: 10..8
        access: R/W
        reset: 0x6
        typical: --
        description: |
          GPIO bus driver PCTL. Suggested values:
          0x4 = 75 ohm.
          0x6 = 50 ohm.
          0x7 = 40 ohm.

      - name: --
        bits: 7..3
        access: ---
        reset: --
        typical: --
        description: Reserved.

      - name: NCTL
        bits: 2..0
        access: R/W
        reset: 0x6
        typical: --
        description: |
          GPIO bus driver NCTL. Suggested values:
          0x4 = 75 ohm.
          0x6 = 50 ohm.
          0x7 = 40 ohm.



