# -*- csr3 -*-
# You must run "csr3 rtl" after editing this file!
---
name: MIO_TWS
enums:
  - name: TWS_INTSN_E
    description: Enumerates the different generated interrupts.
    values:
      - name: MIO_TWS(0..1)_INT_ST
        value: 20'h0b000 + a*0x100
        description: See MIO_TWS0/1_INT[ST_INT].

      - name: MIO_TWS(0..1)_INT_TS
        value: 20'h0b001 + a*0x100
        description: See MIO_TWS0/1_INT[TS_INT].

      - name: MIO_TWS(0..1)_INT_CORE
        value: 20'h0b002 + a*0x100
        description: See MIO_TWS0/1_INT[CORE_INT].


registers:
  - name: MIO_TWS(0..1)_SW_TWSI
    title: Software to TWSI Register
    address: 0x1180000001000 + a*0x200
    bus: RSL
    description: |
      This register allows software to:
      Initiate master-mode operations with a write operation, and read the result with a
      read operation.
      Load four bytes for later retrieval (slave mode) with a write operation and check validity
      with a read operation.
      Launch a configuration read/write operation with a write operation and read the result with a
      read operation.
      This register should be read or written by software, and read by the TWSI device. The TWSI
      device can use either two-byte or five-byte read operations to reference this register.
      The TWSI device considers this register valid when [V] = 1 and [SLONLY] = 1.
    fields:
      - name: V
        bits: 63
        access: RC/W/H
        reset: 0
        typical: --
        description: |
          Valid bit:
          set on a write operation (should always be written with a 1)
          cleared when a TWSI master-mode operation completes
          cleared when a TWSI configuration register access completes
          cleared when the TWSI device reads the register if SLONLY = 1

      - name: SLONLY
        bits: 62
        access: R/W
        reset: 0
        typical: --
        description: |
          Slave-only mode.
          When this bit is set, no operations are initiated with a write operation. Only the D field
          is updated in this case
          When this bit is clear, a write operation initiates either a master-mode operation or a
          TWSI configuration register access.

      - name: EIA
        bits: 61
        access: R/W
        reset: 0
        typical: --
        description: |
          Extended internal address. Sends an additional internal address byte (the MSB of IA is
          from MIO_TWS_SW_TWSI_EXT[IA]).

      - name: OP
        bits: 60..57
        access: R/W
        reset: 0x0
        typical: --
        description: |
          Opcode field. When the register is written with SLONLY = 0, this field initiates one of
          the following read or write operations:
          0000 = 7-bit byte master-mode operation
          0001 = 7-bit byte combined-read master-mode operation,
          7-bit byte write-with-IA master-mode operation
          0010 = 10-bit byte master-mode operation
          0011 = 10-bit byte combined-read master-mode operation,
          10-bit byte write-with-IA master-mode operation
          0100 = TWSI master-clock register, TWSI_CLK in TWSI Master Clock Register
          0110 = See EOP_IA field
          1000 = 7-bit 4-byte master-mode operation
          1001 = 7-bit 4-byte combined-read master-mode operation,
          7-bit 4-byte write-with-IA master-mode operation
          1010 = 10-bit 4-byte master-mode operation
          1011 = 10-bit 4-byte combined-read master-mode operation
          10-bit 4-byte write-with-IA master-mode operation

      - name: R
        bits: 56
        access: R/W/H
        reset: 0
        typical: --
        description: |
          Read bit or result. If this bit is set on a CSR write when SLONLY = 0, the operation is a
          read operation (if clear, it is a write operation).
          On a CSR read, this bit returns the result indication for the most recent master-mode
          operation, 1 = success, 0 = failure.

      - name: SOVR
        bits: 55
        access: R/W
        reset: 0
        typical: --
        description: |
          Size override. If this bit is set, use the SIZE field to determine the master-mode
          operation size rather than what OP specifies. For operations greater than four bytes, the
          additional data is contained in MIO_TWS_SW_TWSI_EXT[D].

      - name: SIZE
        bits: 54..52
        access: R/W
        reset: 0x0
        typical: --
        description: |
          Size minus one. Specifies the size in bytes of the master-mode operation if SOVR = 1. (0 =
          1 byte, 1 = 2 bytes, ... 7 = 8 bytes).

      - name: SCR
        bits: 51..50
        access: R/W
        reset: 0x0
        typical: --
        description: Scratch. Unused, but retain state.

      - name: ADDR
        bits: 49..40
        access: R/W
        reset: 0x0
        typical: --
        description: |
          Address field. The address of the remote device for a master-mode operation. ADDR<9:7> are
          only used for 10-bit addressing.
          Note that when mastering a 7-bit OP, ADDR<6:0> should not take any of the values 0x78,
          0x79, 0x7A nor 0x7B. (These 7-bit addresses are reserved to extend to 10-bit addressing).

      - name: IA
        bits: 39..35
        access: R/W
        reset: 0x0
        typical: --
        description: |
          Internal Address. Used when launching a combined master-mode operation. The lower 3
          address bits are contained in EOP_IA.

      - name: EOP_IA
        bits: 34..32
        access: R/W
        reset: 0x0
        typical: --
        description: |
          Extra opcode, used when OP<3:0>  =  0110 and SLONLY = 0.
          000 = TWSI slave address register (TWSI_SLAVE_ADD)
          001 = TWSI data register (TWSI_DATA)
          010 = TWSI control register (TWSI_CTL)
          011 = (when R =  0) TWSI clock control register (TWSI_CLKCTL)
          011 = (when R = 1) TWSI status register (TWSI_STAT)
          100 = TWSI extended slave register (TWSI_SLAVE_ADD_EXT)
          111 = TWSI soft reset register (TWSI_RST)
          Also provides the lower 3 bits of internal address when launching a combined master-mode
          operation.

      - name: DATA
        bits: 31..0
        access: R/W/H
        reset: 0x0
        typical: --
        description: |
          Data field.
          Used on a write operation when:
          Initiating a master-mode write operation (SLONLY = 0)
          Writing a TWSI configuration register (SLONLY = 0)
          A slave-mode write operation (SLONLY = 1)
          The read value is updated by:
          A write operation to this register
          Master-mode completion (contains error code)
          TWSI configuration-register read (contains result)


  - name: MIO_TWS(0..1)_TWSI_SW
    title: TWSI to Software Register
    address: 0x1180000001008 + a*0x200
    bus: RSL
    description: |
      This register allows the TWSI device to transfer data to software and later check that
      software has received the information.
      This register should be read or written by the TWSI device, and read by software. The TWSI
      device can use one-byte or four-byte payload write operations, and two-byte payload read
      operations. The TWSI device considers this register valid when V = 1.
    fields:
      - name: V
        bits: 63..62
        access: RC/W/H
        reset: 0x0
        typical: --
        description: |
          Valid bits. These bits are not directly writable. They are set to 11 on any write
          operation by the TWSI device. They are cleared to 00 on any read operation by software.

      - name: --
        bits: 61..32
        access: ---
        reset: --
        typical: --
        description: Reserved.

      - name: DATA
        bits: 31..0
        access: R/W
        reset: --
        typical: --
        description: Data field. Updated on a write operation by the TWSI device.


  - name: MIO_TWS(0..1)_INT
    title: TWSI Interrupt Register
    address: 0x1180000001010 + a*0x200
    bus: RSL
    description: This register contains the TWSI interrupt-enable mask and the interrupt-source bits.
    fields:
      - name: --
        bits: 63..12
        access: ---
        reset: --
        typical: --
        description: Reserved.

      - name: SCL
        bits: 11
        access: RO/H
        reset: --
        typical: --
        description: SCL signal.

      - name: SDA
        bits: 10
        access: RO/H
        reset: --
        typical: --
        description: SDA signal.

      - name: SCL_OVR
        bits: 9
        access: R/W
        reset: 0
        typical: --
        description: SCL override.

      - name: SDA_OVR
        bits: 8
        access: R/W
        reset: 0
        typical: --
        description: SDA override.

      - name: --
        bits: 7..3
        access: ---
        reset: --
        typical: --
        description: Reserved.

      - name: CORE_INT
        bits: 2
        access: RO/H
        reset: 0
        typical: --
        description: |
          TWSI core interrupt. Ignored when the HLC is enabled. Throws
          TWS_INTSN_E::MIO_TWS_INT_CORE.

      - name: TS_INT
        bits: 1
        access: R/W1C/H
        reset: 0
        typical: --
        description: |
          MIO_TWS_TWSI_SW register-update interrupt. Ignored when the HLC is disabled. Throws
          TWS_INTSN_E::MIO_TWS_INT_TS.

      - name: ST_INT
        bits: 0
        access: R/W1C/H
        reset: 0
        typical: --
        description: |
          MIO_TWS_SW_TWSI register-update interrupt. Ignored when the HLC is disabled. Throws
          TWS_INTSN_E::MIO_TWS_INT_ST.


  - name: MIO_TWS(0..1)_SW_TWSI_EXT
    title: Software to TWSI Extension Register
    address: 0x1180000001018 + a*0x200
    bus: RSL
    description: |
      This register contains an additional byte of internal address and four additional bytes of
      data to be used with TWSI master-mode operations.
      The IA field is sent as the first byte of internal address when performing master-mode
      combined-read/write-with-IA operations and MIO_TWS_SW_TWSI[EIA] is set. The D field extends
      the data field of MIO_TWS_SW_TWSI for a total of 8 bytes (SOVR must be set to perform
      operations greater than 4 bytes).
    fields:
      - name: --
        bits: 63..40
        access: ---
        reset: --
        typical: --
        description: Reserved.

      - name: IA
        bits: 39..32
        access: R/W
        reset: 0x0
        typical: --
        description: |
          Extended internal address. Sent as the first byte of internal address when performing
          master-mode combined-read/write-with-IA operations and MIO_TWS_SW_TWSI[EIA] is set.

      - name: DATA
        bits: 31..0
        access: R/W/H
        reset: 0x0
        typical: --
        description: |
          Extended data. Extends the data field of MIO_TWS_SW_TWSI for a total of eight bytes
          (MIO_TWS_SW_TWSI[SOVR] must be set to 1 to perform operations greater than four bytes).



