# -*- csr3 -*-
# You must run "csr3 rtl" after editing this file!
---
name: BCH
registers:
  - name: BCH_CTL
    title: BCH Control Register
    address: 0x1180071000000
    bus: RSL
    fields:
      - name: --
        bits: 63..23
        access: --
        reset: 0x0
        typical: 0x0
        description: Reserved.

      - name: FREE_ENA
        bits: 22
        access: R/W
        reset: 0
        typical: 0
        description: Enable freeing of command buffers.

      - name: EARLY_TERM
        bits: 21..18
        access: R/W
        reset: 0x5
        typical: 0x5
        description: |
          Threshold of zero delta interations before declaring early termination.
          0 will force all iterations to run.  Diagnostic only.

      - name: ONE_CMD
        bits: 17
        access: --
        reset: 0
        typical: 0
        description: Execute a single operation at a time.  Diagnostic only.

      - name: ERASE_DISABLE
        bits: 16
        access: R/W
        reset: 0
        typical: 0
        description: |
          When ERASE_DISABLE=0, erased blocks bypass the BCH correction.   The 16B result word
          contains an erased block indication.

          A block is considered erased if the number of zeros found in the block (data+ECC) is
          less than half the ECC level.   For instance, a 2KB block using ECC32 is considered
          erased if few than 16 zeroes are found in the 2048+60 bytes.

      - name: --
        bits: 15..6
        access: --
        reset: 0x0
        typical: 0x0
        description: Reserved.

      - name: MAX_READ
        bits: 5..2
        access: R/W
        reset: 0x8
        typical: 0x8
        description: |
          Maximum number of outstanding data read commands. MAX_READ is a throttle to control IOB
          usage. Values greater than 0x8 are illegal.

      - name: STORE_LE
        bits: 1
        access: R/W
        reset: 0
        typical: 0
        description: Force STORE0 byte write address to little endian.

      - name: RESET
        bits: 0
        access: R/W1
        reset: 0
        typical: 0
        description: Reset oneshot pulse (lasts for 4 cycles).


  - name: BCH_CMD_BUF
    title: Command Buffer Register
    address: 0x1180071000008
    bus: RSL
    description: This register sets the command-buffer parameters.
    fields:
      - name: --
        bits: 63..58
        access: --
        reset: 0x0
        typical: 0x0
        description: Reserved.

      - name: DWB
        bits: 57..49
        access: R/W
        reset: 0x0
        typical: --
        description: Number of DontWriteBacks.

      - name: POOL
        bits: 48..46
        access: R/W
        reset: 0x0
        typical: --
        description: Free list used to free command buffer segments.

      - name: SIZE
        bits: 45..33
        access: R/W
        reset: 0x0
        typical: --
        description: Number of uint64s per command buffer segment.

      - name: PTR
        bits: 32..0
        access: R/W
        reset: 0x0
        typical: --
        description: |
          Initial command buffer pointer[39:7] (128B-aligned).


  - name: BCH_ERR_CFG
    title: BCH Error Configuration Register
    address: 0x1180071000010
    bus: RSL
    fields:
      - name: --
        bits: 63..18
        access: --
        reset: --
        typical: --
        description: Reserved.

      - name: DAT_FLIP
        bits: 17..16
        access: R/W
        reset: 0x0
        typical: 0x0
        description: |
          Testing feature. Flip syndrome bits <1:0> on writes to the DAT ram to test single-bit or
          double-bit errors.

      - name: --
        bits: 15..1
        access: --
        reset: --
        typical: --
        description: Reserved.

      - name: DAT_COR_DIS
        bits: 0
        access: R/W
        reset: 0
        typical: 0
        description: Disable ECC corrector on DAT RAM.


  - name: BCH_BIST_RESULT
    title: BCH BIST Result Register
    address: 0x1180071000080
    bus: RSL
    description: |
      This register provides access to internal BIST results. Each bit is the BIST result of an
      individual memory (per bit, 0 = pass, 1 = fail).
    fields:
      - name: --
        bits: 63..6
        access: --
        reset: --
        typical: --
        description: Reserved.

      - name: NCB_OUB
        bits: 5
        access: RO
        reset: X
        typical: 0
        description: BIST result of the NCB_OUB memories.

      - name: NCB_INB
        bits: 4
        access: RO
        reset: X
        typical: 0
        description: BIST result of the NCB_INB memories.

      - name: DAT
        bits: 3..0
        access: RO
        reset: X
        typical: 0x0
        description: BIST result of the DAT memories.


  - name: BCH_GEN_INT
    title: BCH General Interrupt Register
    address: 0x1180071000088
    bus: RSL
    fields:
      - name: --
        bits: 63..3
        access: --
        reset: --
        typical: --
        description: Reserved.

      - name: DAT_DBE
        bits: 2
        access: R/W1C/H
        reset: 0
        typical: 0
        description: An ECC uncorrectable error has occurred in the DAT RAM.

      - name: DAT_SBE
        bits: 1
        access: R/W1C/H
        reset: 0
        typical: 0
        description: An ECC correctable error has occurred in the DAT RAM.

      - name: DOORBELL
        bits: 0
        access: R/W1C/H
        reset: 0
        typical: 0
        description: Error bit indicating a doorbell count has overflowed. 


  - name: BCH_GEN_INT_EN
    title: BCH Interrupt Mask Register
    address: 0x1180071000090
    bus: RSL
    description: When a mask bit is set, the corresponding interrupt is enabled.
    fields:
      - name: --
        bits: 63..3
        access: --
        reset: --
        typical: --
        description: Reserved.

      - name: DAT_DBE
        bits: 2
        access: R/W
        reset: 0
        typical: 0
        description: Interrupt-enable bit mask corresponding to the error mask in BCH_GEN_INT.

      - name: DAT_SBE
        bits: 1
        access: R/W
        reset: 0
        typical: 0
        description: Interrupt-enable bit mask corresponding to the error mask in BCH_GEN_INT.

      - name: DOORBELL
        bits: 0
        access: R/W
        reset: 0
        typical: 0
        description: Interrupt-enable bit mask corresponding to the error mask in BCH_GEN_INT.



