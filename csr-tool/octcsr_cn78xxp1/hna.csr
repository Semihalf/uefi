# -*- csr3 -*-
# You must run "csr3 rtl" after editing this file!
---
name: HNA
attributes:
  dv_fc_scratch_exempt: "NCB"
enums:
  - name: HNA_INTSN_E
    title: HNA Interrupt Source Number Enumeration
    attributes:
      width: "20"
    description: Enumerates the different HNA-generated interrupts.
    values:
      - name: HNA_ERROR_DBLOVF
        value: 0x47000
        attributes:
          cib_rtl_module: "hna"
        description: See HNA_ERROR[DBLOVF].

      - name: HNA_ERROR_SVSTCK_SBE
        value: 0x47001
        attributes:
          cib_rtl_module: "hna"
        description: See HNA_ERROR[HPU_SVSTCK_SBE].

      - name: HNA_ERROR_SVSTCK_DBE
        value: 0x47002
        attributes:
          cib_rtl_module: "hna"
        description: See HNA_ERROR[HPU_SVSTCK_DBE].

      - name: HNA_ERROR_RNSTCK_SBE
        value: 0x47003
        attributes:
          cib_rtl_module: "hna"
        description: See HNA_ERROR[HPU_RNSTCK_SBE].

      - name: HNA_ERROR_RNSTCK_DBE
        value: 0x47004
        attributes:
          cib_rtl_module: "hna"
        description: See HNA_ERROR[HPU_RNSTCK_DBE].

      - name: HNA_ERROR_PDB_PAR_ERR
        value: 0x47005
        attributes:
          cib_rtl_module: "hna"
        description: See HNA_ERROR[HPU_PDB_PAR_ERR].

      - name: HNA_ERROR_INST_ERR
        value: 0x4700B
        attributes:
          cib_rtl_module: "hna"
        description: See HNA_ERROR[HNA_INST_ERR].

      - name: HNA_ERROR_HNC_OVFERR
        value: 0x4700C
        attributes:
          cib_rtl_module: "hna"
        description: See HNA_ERROR[HNC_OVFERR].

      - name: HNA_ERROR_DLC0_OVFERR
        value: 0x4700D
        attributes:
          cib_rtl_module: "hna"
        description: See HNA_ERROR[DLC0_OVFERR].

      - name: HNA_ERROR_DLC1_OVFERR
        value: 0x4700E
        attributes:
          cib_rtl_module: "hna"
        description: See HNA_ERROR[DLC1_OVFERR].

      - name: HNA_ERROR_DLC0_DBE
        value: 0x4700F
        attributes:
          cib_rtl_module: "hna"
        description: See HNA_ERROR[DLC0_DBE].

      - name: HNA_ERROR_DLC1_DBE
        value: 0x47010
        attributes:
          cib_rtl_module: "hna"
        description: See HNA_ERROR[DLC1_DBE].

      - name: HNA_ERROR_HNANXM
        value: 0x47011
        attributes:
          cib_rtl_module: "hna"
        description: See HNA_ERROR[HNANXM].

      - name: HNA_ERROR_REPLERR
        value: 0x47012
        attributes:
          cib_rtl_module: "hna"
        description: See HNA_ERROR[REPLERR].

      - name: HNA_ERROR_OSMERR
        value: 0x47013
        attributes:
          cib_rtl_module: "hna"
        description: See HNA_ERROR[OSMERR].

      - name: HNA_ERROR_HNC_PARERR
        value: 0x47014
        attributes:
          cib_rtl_module: "hna"
        description: See HNA_ERROR[HNC_PARERR].


  - name: HNA_PFC_SEL_E
    title: |
      INTERNAL: HNA Performance Counter Select Enumeration
    attributes:
      width: "6"
    description: Enumerates the different HNA performance counter selects.
    values:
      - name: HPU_ALL_MATCH
        value: 0x00
        description: Any node match cycle in selected HPU.

      - name: HPU_FCH_CNT
        value: 0x01
        description: FCH_CNT nodes in selected HPU.

      - name: HPU_FCC_CNT
        value: 0x02
        description: FCC_CNT nodes in selected HPU.

      - name: HPU_VCH_CNT
        value: 0x03
        description: VCH_CNT nodes in selected HPU.

      - name: HPU_VCC_CNT
        value: 0x04
        description: VCC_CNT nodes in selected HPU.

      - name: HPU_SPLIT
        value: 0x05
        description: SPLIT nodes in selected HPU.

      - name: HPU_STR_MTCH
        value: 0x06
        description: STR_MTCH nodes in selected HPU.

      - name: HPU_CHAR
        value: 0x07
        description: CHAR nodes in selected HPU.

      - name: HPU_CC
        value: 0x08
        description: CC nodes in selected HPU.

      - name: HPU_MARK
        value: 0x09
        description: MARK nodes in selected HPU.

      - name: HPU_RAM1
        value: 0x0A
        description: Any RAM1 accesses from selected HPU.

      - name: HPU_RAM2
        value: 0x0B
        description: Any RAM2 accesses from selected HPU.

      - name: HPU_OSM
        value: 0x0C
        description: OSM accesses from selected HPU.

      - name: HPU_EXM
        value: 0x0D
        description: External memory (DLC) accesses from selected HPU.

      - name: HPU_NODECACHE_HIT
        value: 0x0E
        description: Node Cache hit in selected HPU.

      - name: HPU_RAM2_CACHE_HIT
        value: 0x0F
        description: RAM2 cache hit in selected HPU.

      - name: HPU_RNSTK_POP
        value: 0x10
        description: Run stack pop in selected HPU.

      - name: HPU_RNSTK_PUSH
        value: 0x11
        description: Run stack push in selected HPU.

      - name: HPU_RNSTK_SPILL
        value: 0x12
        description: Run stack spill in selected HPU.

      - name: HPU_RNSTK_FILL
        value: 0x13
        description: Run stack fill in selected HPU.

      - name: HPU_WALK_DONE
        value: 0x14
        description: GWALK done in selected HPU.

      - name: HPU_WALK_INSTR
        value: 0x15
        description: GWALK in selected HPU.

      - name: HPU_PAYLOAD_LEN
        value: 0x16
        description: Payload bytes (0-8/cycle) in selected HPU.

      - name: HPU_RESBUF_LEN
        value: 0x17
        description: Result (RWB) words from selected HPU.

      - name: HPU_SVSTK_LEN
        value: 0x18
        description: Save stack words from selected HPU.

      - name: HPU_SVSTK_SPILL
        value: 0x19
        description: Save stack spill from selected HPU.

      - name: HPU_RWB_SPILL
        value: 0x1A
        description: Result (RWB) spill from selected HPU.

      - name: HPU_ACTIVE
        value: 0x1B
        description: Active cycles in selected HPU.

      - name: HPU_WAIT_RAM1
        value: 0x1C
        description: Cycles in which selected HPU waits for RAM1 response.

      - name: HPU_WAIT_OSM
        value: 0x1D
        description: Cycles in which selected HPU waits for OSM response.

      - name: HPU_WAIT_DLC
        value: 0x1E
        description: Cycles in which selected HPU waits for DLC response.

      - name: HPU_WAIT_NODE
        value: 0x1F
        description: Cycles in which selected HPU waits for any node response (HNC+OSM+DLC).

      - name: HPU_WAIT_RNSTK_FILL
        value: 0x20
        description: Cycles in which selected HPU waits for run stack fill.

      - name: HPU_ALL_BYTES
        value: 0x21
        description: All processed bytes (0-8/cycle) in selected HPU.

      - name: HPU_FCH_CNT_BYTES
        value: 0x22
        description: FCH CNT bytes processed (0-8/cycle) in selected HPU.

      - name: HPU_FCC_CNT_BYTES
        value: 0x23
        description: FCC CNT bytes processed in selected HPU.

      - name: HPU_VCH_CNT_BYTES
        value: 0x24
        description: VCH CNT bytes processed (0-8/cycle) in selected HPU.

      - name: HPU_VCC_CNT_BYTES
        value: 0x25
        description: VCC CNT bytes processed in selected HPU.

      - name: HPU_STRING_BYTES
        value: 0x26
        description: String bytes processed (0-8/cycle) in selected HPU.

      - name: CL_FILL_ACTIVE
        value: 0x2C
        description: Fill bus is active in selected cluster.

      - name: CL_SPILL_ACTIVE
        value: 0x2D
        description: Spill bus is active in selected cluster.

      - name: CL_DSM_ACTIVE
        value: 0x2E
        description: DSM (DLC/OSM) bus is active in selected cluster.

      - name: CL_GWALK_ASSIGNED
        value: 0x2F
        description: GWALK is assigned to selected cluster.

      - name: GBL_CLOAD
        value: 0x30
        description: CLOAD instructions in entire HNA.

      - name: GBL_GWALK
        value: 0x31
        description: GWALK instructions in entire HNA.

      - name: GBL_PAYLOAD_LEN
        value: 0x32
        description: Payload length (0-8/cycle) in entire HNA.

      - name: GBL_RNSTK_FILL
        value: 0x34
        description: Run stack fill in entire HNA.

      - name: GBL_RNSTK_SPILL
        value: 0x35
        description: Run stack spill in entire HNA.

      - name: GBL_RWB_LEN
        value: 0x36
        description: Result words in entire HNA.

      - name: GBL_SVSTK_LEN
        value: 0x37
        description: Save stack words in entire HNA.

      - name: GBL_DLC0_REQS_FR_HNA
        value: 0x38
        description: Requests to DLC0 (HNA-only).

      - name: GBL_DLC0_REQS_ALL
        value: 0x39
        description: Requests to DLC0 (HNA+DFA).

      - name: GBL_DLC1_REQS
        value: 0x3A
        description: Requests to DLC1 (HNA-only).

      - name: GBL_DLC0_RSPS
        value: 0x3B
        description: Responses from DLC0 (HNA-only, for both LMC ports).

      - name: GBL_DLC1_RSPS
        value: 0x3C
        description: Responses from DLC1 (HNA-only, for both LMC ports).

      - name: GBL_OSM_REQS
        value: 0x3D
        description: Requests to OSM.

      - name: GBL_OSM_RSPS
        value: 0x3E
        description: Responses from OSM.

      - name: GBL_ALL_CYCLES
        value: 0x3F
        description: All cycles.


structs:
  - name: HNA_GRAPH_WALK_S
    title: HNA Graph Walk Structure
    description: This structure specifies the HNA graph walk instruction (ITYPE = 0x4).
    fields:
      - name: OSMBASE
        bits: w0(15..0)
        description: Base address of OSM, i.e., 256-bit line number. HPUs add this base address when accessing OSM.

      - name: --
        bits: w0(17..16)
        description: Reserved.

      - name: REPL
        bits: w0(19..18)
        description: |
          Replication mode. Each external memory read request generated by the HNA is associated
          with a LMC replication factor that indicates the type of replication available for the
          data structure being requested.
          0x0:  1* replication. A particular data structure exists in only one LMC.
          0x1: 2* replication. A particular data structure exists at the same relative address in
          two LMCs.
          0x2: 4* replication. A particular data structure exists at the same relative address in
          all four LMCs.
          0x3: Reserved.
          During graph walks, the HNA issues read requests for 128-byte data structures. A
          granularity of 128 bytes means bits <6:0> of the 42-bit address are ignored. Each LMC
          accesses memory with the granularity of a 1024-bit (128-byte) cache line.
          HNA converts L2/DRAM physical addresses into a 42-bit form, which removes the hole between
          lower and upper portion of DDR. This form is called an L2C+LMC internal DRAM address.
          To create a L2C+LMC internal DRAM address (L2CLMCA<41:0>), subtract
          0x1000 0000 (i.e. 256 MB) from the L2/DRAM physical address if it is upper 511.75GB of
          DDR3/4 address. If all ranks of DRAM in all LMCs have the same amount of DRAM attached,
          then the L2C+LMC internal DRAM address is contiguous, ranging from 0 up to what is
          necessary to cover the total amount of DRAM attached to CNXXXX. If some ranks of DRAM in
          some LMCs do not have the same amount of DRAM attached, there may be holes in the L2C+LMC
          internal DRAM address space. CN78XX supports two modes: a four-LMC mode, and a two-LMC
          mode.

      - name: CLMSK
        bits: w0(23..20)
        description: |
          Indicates the mask of clusters that can accept the instruction. If more than one bit is
          set, HNA picks the least loaded cluster when assigning the graph walk to a cluster.

      - name: ITYPE
        bits: w0(26..24)
        description: For a graph walk instruction, this field is always 0x4.

      - name: --
        bits: w0(27)
        description: Reserved.

      - name: LT
        bits: w0(28)
        description: |
          Load-through mode. This mode bit is used to force LDT commands onto the I/O bus so that
          L2C does not allocate L2 data during the read.

      - name: ST
        bits: w0(29)
        description: |
          Store-full hint (zero fill unused bytes of cache line). This mode bit is used to force STF
          (store-full hint) commands to L2/DRAM to indicate that unused bytes of the write operation
          will be zero filled to L2/DRAM memory for the cache line. This is a performance
          enhancement feature, as the STF hint is used by the L2 controller to zero fill unused data
          in the cache line (rather than to fetch DRAM memory).
          If ST = 0, the HPU must only write individual words when it places result data into
          L2/DRAM.
          If ST = 1, the HPU may write entire cache blocks surrounding the words of result data. The
          HPU may write result words using the STF hint to L2C/DRAM indicating its intent to write
          the entire cache line.
          Core software must never set ST = 1 when any of the possible result words may reside in
          the same 128-byte cache block as other useful data structures.
          Note: If ST=1, RWORD0 writes at the final quadword of a cache line will issue an STF-hint.

      - name: LE
        bits: w0(30)
        description: |
          Little-endian mode.
          0: the packet data in system memory is presumed to be in big-endian format.
          1: the packet data in system memory is presumed to be in little-endian format.
          Note: The graph data read by the HPUs from the RAM1/OSM or DDR3/4 memory is always
          read/interpreted in little endian format as shown in HNA Instruction Formats.

      - name: --
        bits: w0(35..31)
        description: Reserved.7

      - name: R1BASE
        bits: w0(48..36)
        description: |
          Base address of RAM1, i.e, 256 bit line number. HPUs add this base address whenever they
          access RAM1.

      - name: --
        bits: w0(54..49)
        description: Reserved.

      - name: R2BASE
        bits: w0(63..55)
        description: |
          Base address of RAM2, i.e, 256 bit line number. HPUs add this base address whenever they
          access RAM2.

      - name: FIRSTSTACKENTRY
        bits: w1(63..0)
        description: |
          Contains the first stack entry to be processed. Note that RUNHEAD pointer in
          IWORD3[RUNHEAD] points to the second stack entry to be processed.

      - name: MBASE
        bits: w2(31..0)
        description: |
          HPUs add memory base address whenever they access external DDR. This base address is a 1K
          aligned address.

      - name: --
        bits: w2(45..32)
        description: Reserved.

      - name: RUNSTACKLEN
        bits: w2(63..46)
        description: |
          Number of 64-bit stack entries that need to be processed, excluding the first stack entry
          available in IWORD1<63:0>. IWORD3[RUNHEAD] points to the head of the stack entries.

      - name: RUNHEAD
        bits: w3(38..0)
        description: |
          Points to the head of a circular doubly linked list containing the stack entries where the
          HPUs should start walking the graphs. It is an 8-byte aligned address. The lower 3 bits
          are not passed in the instruction and assumed to be zeros. The size of each chunk is
          provided in HNA_DIFCTL[SIZE].

      - name: --
        bits: w3(45..39)
        description: Reserved.

      - name: RUNSTACKSZ
        bits: w3(63..46)
        description: |
          Size of the run stack in number of 64-bit entries. It contains the total size of the run
          stack, i.e., number of total stack entries that can be added at IWORD3[RUNHEAD] before it
          becomes FULL.
          Note: RUNSTACKSZ must be greater than or equal to (RUNSTACKLEN + 1) and must be a minimum
          of 2. Hardware behavior is undefined otherwise.

      - name: RPTR
        bits: w4(38..0)
        description: |
          Points to a buffer of size (IWORD4<59:44> + 1) * 8 bytes. It is an 8-byte aligned address.
          The lower 3 bits are not passed in the instruction and assumed to be zeros.

      - name: --
        bits: w4(47..39)
        description: Reserved.

      - name: RMAX
        bits: w4(63..48)
        description: |
          Contains the size of the result buffer available at IWORD4[RPTR], i.e., number of RWORD1
          that can be written at IWORD4[RPTR]. ((RWORD0[NRWORD1] + 1) * 8) bytes is the total size
          of the buffer available at IWORD4[RPTR].
          Note: The minimum value of RMAX is 2.

      - name: DPTR
        bits: w5(41..0)
        description: This address points to the payload data and it is a byte aligned address.

      - name: --
        bits: w5(48..42)
        description: Reserved.

      - name: DLEN
        bits: w5(63..49)
        description: |
          Contains the size of the data available at IWORD5[DPTR] in bytes.
          * DLEN<14:0> must never be zero.
          * DLEN<14:0> is limited to maximum size of 1536 bytes.

      - name: SAVETAIL
        bits: w6(38..0)
        description: |
          Points to the tail of a circular doubly linked list where HPUs write the result stack
          entries. It is an 8-byte aligned address; the lower 3 bits are not passed in the
          instruction and assumed to be zeros.

      - name: --
        bits: w6(45..39)
        description: Reserved.

      - name: SVSTACKSZ
        bits: w6(63..46)
        description: |
          Size of save stack in number of 64-bit words, i.e., number of 64-bit stack entries that
          can be written at the save stack address in IWORD6[SAVETAIL].
          Note: The minimum value of SVSTACKSZ is 2.

      - name: WQPTR
        bits: w7(41..0)
        description: |
          If this value is nonzero, HNA hardware submits work after it completes the HNA
          instruction. If it is zero, HNA hardware does not submit any work after it completes the
          instruction.
          Note: WQPTR<2:0> must be zero since all work queue pointers must be 64-bit aligned.

      - name: --
        bits: w7(49..42)
        description: Reserved.

      - name: TT
        bits: w7(51..50)
        description: SSO Tag Type of WQPTR.

      - name: GRP
        bits: w7(61..52)
        description: SSO Group of WQPTR. Note that the upper two bits correspond to a node number.

      - name: --
        bits: w7(63..62)
        description: |
          Reserved. INTERNAL: More group bits.


  - name: HNA_OCM_LOAD_S
    title: HNA OCM Load Instruction Structure
    description: |
      This structure specifies the HNA OCM load instruction (ITYPE = 0x1).
      The HNA graph cache consists of the following two components:
      * Per-supercluster 256+KB Graph Cache
      Shared 2MB of OSM.
      The OCM LOAD instruction loads HNA GIG into Graph Cache portion in the super-cluster memory.
      To load a HNA GIG into OSM, software issues an OSM Write Request (OSM_WR*_REQ) ASE command.
      Refer to OSM Write Request (OSM_WR*_REQ) in the ASE chapter for more information. The 16-bit
      starting address of the GIG in OSM is used as the OSMBASE (w0<15:0>) for a GRAPH_WALK
      instruction to the corresponding graph.
    fields:
      - name: --
        bits: w0(19..0)
        description: Reserved.

      - name: CLMSK
        bits: w0(23..20)
        description: |
          Indicates which supercluster's RAM1/2 to load. CLMSK<3:2> corresponds to SC1 and
          CLMSK<1:0> corresponds to SC0. When either bit in the CLMSK is SET for a given SCx, then
          the SCx is written.
          If CLMSK<3:0>={xx01, xx10, xx11} then SC0 is selected.
          If CLMSK<3:0>={0100,1000,1100} then SC1 is selected.
          Note: Only SC1 or SC0 can be selected for a given LOAD instruction. If software specifies
          a CLMSK<3:0>=4'b1111, then only the SC0's RAM1/2 is written (interpreted by hardware as
          xx11).

      - name: ITYPE
        bits: w0(26..24)
        description: For an OCM load instruction, this field is always 0x1.

      - name: --
        bits: w0(27)
        description: Reserved.

      - name: LT
        bits: w0(28)
        description: |
          Load-through mode. This mode bit is used to force LDT commands onto the I/O bus so that
          L2C does not allocate L2 data during the read.

      - name: --
        bits: w0(34..29)
        description: Reserved.

      - name: RX
        bits: w0(35)
        description: Specifies the internal RAM number to load. 0 = Load RAM1; 1 = Load RAM2.

      - name: RXBASE
        bits: w0(48..36)
        description: |
          Contains the base address of the corresponding RAM to be loaded. If IWORD0[RX] = 0, this
          field contains the RAM1 base address. If IWORD[RX] = 1, this field contains the RAM2 base
          address. In case of a RAM2 load, RXBASE<12:9> bits are ignored.

      - name: --
        bits: w0(63..49)
        description: Reserved.

      - name: --
        bits: w1(63..0)
        description: Reserved.

      - name: --
        bits: w2(63..0)
        description: Reserved.

      - name: --
        bits: w3(63..0)
        description: Reserved.

      - name: RPTR
        bits: w4(38..0)
        description: Points to a 8-byte buffer where the result of OCM load is written.

      - name: --
        bits: w4(63..39)
        description: Reserved.

      - name: DPTR
        bits: w5(41..0)
        description: |
          RAM1/2 data is available at this address. It is an 8-byte aligned address, i.e., DPTR<2:0>
          are zeros. The format of RAM1 and RAM2 data is given in Figure XXX and Figure XXX.

      - name: --
        bits: w5(48..42)
        description: Reserved.

      - name: DLEN
        bits: w5(63..49)
        description: |
          Contains the size of RAM1 or RAM2 data available at IWORD5[DPTR] which must be a multiple
          of 32B, i.e., DLEN<4:0> must be zero.
          Software restrictions:
          DLEN<14:0> must never be zero.
          DLEN<4:0> must always be zero.
          The maximum number of lines that can be loaded per instruction is limited to 1023 lines
          (i.e., DLEN<14:5> = 0x3FF).
          Software must never specify an RXBASE/DLEN pair that causes the line address to exceed the
          maximum of RAM1/RAM2 memory space (i.e., no hardware wrap around is supported).
          If RX = 0 (i.e., RAM1), then (RXBASE<12:0> + DLEN<14:5>) <= 0x1FFF
          If RX = 1 (i.e., RAM2), then (RXBASE<12:0> + DLEN<14:5>) <= 0x1FF

      - name: --
        bits: w6(63..0)
        description: Reserved.

      - name: WQPTR
        bits: w7(41..0)
        description: |
          If this value is nonzero, HNA hardware submits work after it completes the HNA
          instruction. If it is zero, HNA hardware does not submit any work after it completes the
          instruction.
          Note: WQPTR<2:0> must be zero since all work queue pointers must be 64-bit aligned.

      - name: --
        bits: w7(49..42)
        description: Reserved.

      - name: TT
        bits: w7(51..50)
        description: SSO Tag Type.

      - name: GRP
        bits: w7(61..52)
        description: SSO Group. Note that the upper two bits correspond to a node number.

      - name: --
        bits: w7(63..62)
        description: |
          Reserved. INTERNAL: More group bits.


  - name: HNA_RESULT_S
    title: HNA Result Structure
    description: |
      This structure specifies the HNA result format.
      The HNA result has one or more 64-bit words in L2/DRAM. Each word must be naturally aligned in
      L2/DRAM. The HNA hardware writes these words to L2/DRAM during and after it processes the HNA
      instruction.
      For the Graph Walk instruction, the structure is variable length to accommodate HNA
      instructions that hit a variable number of marked nodes; but the result length can be limited
      by the IWORD4[RMAX] field of the Graph Walk instruction. Once the instruction has completed,
      software is notified of the completion using either a software poling scheme or by a work
      queue interrupt. The signaled completion ensures that software can read/process the result
      buffer information in system memory.
      An OCM load instruction returns a single RWORD0 only.
    fields:
      - name: --
        bits: w0(6..0)
        description: Reserved.

      - name: RUNLEN
        bits: w0(24..7)
        description: |
          For a Graph Walk instruction, this field contains the number of stack entries that are not
          processed or are remaining at IWORD3[RUNHEAD].

      - name: SAVELEN
        bits: w0(42..25)
        description: |
          For a Graph Walk instruction, this field contains the number of stack entries written at
          IWORD6[SAVETAIL].

      - name: DONE
        bits: w0(43)
        description: |
          Set to one by HNA hardware after it completes the HNA instruction and all results have
          been written. It is used by polling software to recognize when the HNA instruction has
          completed.

      - name: NRWORD1
        bits: w0(59..44)
        description: |
          For a Graph Walk instruction, this field should contain the number of RWORD1 entries
          written following the RWORD0 at IWORD4[RPTR].
          Note: Hardware ensures that all of the results (RWORD1) have been properly
          written/committed to L2/DRAM memory, before the DONE bit is set.

      - name: REASON
        bits: w0(63..60)
        description: |
          Completion reason code.
          0x0: DDONE HPU finished processing all input packet data bytes. DDONE has lower priority
          than all errors (ERR/BAD)
          0x1: RBUFFULL HPU consumed the last result word when it processed a packet data byte.
          RBUFFULL has the lowest priority.
          0x2: MEMERR HPU encountered an error while reading a node from RAM1/RAM2/OSM or DDR3/4.
          If the address points to RAM1/RAM2, software should correct and recover.
          If the address points to OSM or DDR3/4, software should reset the chip, as OSM and DDR3/4
          memory are ECC protected and this error is generate in case of a double-bit error.
          0x3: LDDONE HPU finished loading the RAM1/RAM2
          0x4: BADADR HPU encountered a bad node entry number. This is due to a bug in the regex
          compiler provided by Cavium. Refer the SDK for more details.
          0x5: BADNODE HPU encountered a bad node type. This is due to a bug in the regex compiler
          provided by Cavium. Refer the SDK for more details.
          0x6: BADSTACKENTRY HPU encountered a bad stack entry type. This is due to a bug in the
          regex compiler provided by Cavium. Refer the SDK for more details.
          0x7: RUNSTACKFULL Stack at IWORD3[RUNPTR] became full
          0x8: SAVESTACKFULL Stack at IWORD6[SAVEPTR] became full

      - name: OFFSET
        bits: w1(14..0)
        description: Payload offset of the match.

      - name: REV
        bits: w1(15)
        description: |
          Reserved. INTERNAL: Reverse flag.

      - name: PATTERN_BADADR
        bits: w1(36..16)
        description: |
          Matching pattern number or bad address. When RWORD0[REASON] = MEMERR, this field contains
          the offending address.

      - name: --
        bits: w1(63..37)
        description: Reserved.


registers:
  - name: HNA_CONFIG
    title: HNA Configuration Register
    address: 0x1180047000000
    bus: RSL
    description: This register specifies the HNA HPU programmable controls.
    fields:
      - name: --
        bits: 63..25
        access: RAZ
        reset: --
        typical: --
        description: Reserved.

      - name: STK_LL_DIS
        bits: 24
        access: R/W
        reset: 1
        typical: 1
        description: |
          Stack linked-list disable. When set, the linked-list mechanism for run stack and save
          stack structures is disabled. In this mode, the linked-list chunk boundary checking is not
          done, and therefore the previous/next pointers are non-existent. The stacks are
          effectively in an infinite linear buffer, bounded only by the maximum sizes provided in
          the instruction (IWORD3[RUNSTACKSZ] and IWORD6[SVSTACKSZ]). There is no space reserved for
          the previous and next pointers, and [STK_CHKSZ] is ignored.
          When the STK_LL_DIS is cleared, the stack linked-list mechanism operates as per spec.

      - name: --
        bits: 23
        access: RAZ
        reset: --
        typical: --
        description: Reserved.

      - name: STK_CHKSZ
        bits: 22..20
        access: R/W
        reset: 0x3
        typical: 0x3
        description: |
          Stack chunk size. This encoded value specifies the chunk size for both the RNSTK/SVSTK
          data structures. The RNSTK/SVSTK use a doubly linked list where each chunk's first two
          64-bit entries contain the previous and next chunk pointers.
          0x0 = 32 entries or 256 bytes
          0x1 = 64 entries or 512 bytes
          0x2 = 128 entries or 1K bytes
          0x3 = 256 entries or 2K bytes -> default power on
          0x4 = 512 entries or 4K bytes
          0x5 = 1024 entries or 8K bytes
          0x6 = 2048 entries or 16K bytes
          0x7 = 4096 entries or 32K bytes
          NOTE: This field can only be changed at initialization/power on time before the HNA is fed
          instructions.

      - name: RNSTK_LWM
        bits: 19..16
        access: R/W
        reset: 0x1
        typical: 0x1
        description: |
          RNSTK low watermark. This field specifies the low watermark for the run stack. Valid
          range: 0-15.
          Once the run stack goes below the low watermark, HNA fills entries from the global run
          stack head to the local run stack tail. The granularity of this field is represented as
          number of 128B cachelines.
          NOTE: This field can only be changed at initialization/power on time before the HNA is fed
          instructions.

      - name: RNSTK_HWM
        bits: 15..12
        access: R/W
        reset: 0xe
        typical: 0xe
        description: |
          RNSTK high watermark. This field specifies the high watermark for the run stack. Valid
          range: 0-15.
          Once the local run stack level goes above the high watermark, the HNA spills entries from
          the local run stack tail to the global run stack head (in DDR memory). The granularity of
          this field is represented as number of 128B cachelines.
          NOTE: This field can only be changed at initialization/power on time before the HNA is fed
          instructions.

      - name: --
        bits: 11..9
        access: RAZ
        reset: --
        typical: --
        description: Reserved.

      - name: ECCCORDIS
        bits: 8
        access: R/W
        reset: 0
        typical: 0
        description: |
          ECC correction disable. When set, all HNA ECC protected data structures disable their ECC
          correction logic. When clear (default) ECC correction is always enabled.

      - name: CLMSKCRIP
        bits: 7..4
        access: R/W/H
        reset: 0x0
        typical: 0x0
        description: |
          Cluster cripple mask. A one in each bit of the mask represents which HPC cluster to
          cripple. CN78XX HNA has 4 clusters, where all CLMSKCRIP mask bits are used.
          Software NOTE: The MIO_FUS___HNA_CLMASK_CRIPPLE[3:0] fuse bits are forced into this
          register at reset. Any fuse bits that contain 1 are disallowed during a write and are
          always read as 1.

      - name: HPU_CLCRIP
        bits: 3..1
        access: R/W/H
        reset: 0x0
        typical: 0x0
        description: |
          "HPU cluster cripple. Encoding which represents number of HPUs to cripple for each
          cluster. Typically HPU_CLCRIP=0x0, which enables all HPUs within each cluster. However,
          when the HNA performance counters are used, software may want to limit the number of HPUs
          per cluster available, as there are only 4 parallel performance counters.
          HPU_CLCRIP #HPUs crippled (per cluster)
          0x0 0 HPU[9:0]:ON, All engines enabled
          0x1 1 HPU[9]:OFF /HPU[8:0]:ON, (n-1) engines enabled
          0x2 3 HPU[9:7]:OFF /HPU[6:0]:ON, (n-3) engines enabled
          0x3 4 HPU[9:6]:OFF /HPU[5:0]:ON, (n-4) engines enabled
          0x4 5 HPU[9:5]:OFF /HPU[4:0]:ON, (n-5) engines enabled
          0x5 6 HPU[9:4]:OFF /HPU[3:0]:ON, (n-6) engines enabled
          0x6 8 HPU[9:2]:OFF /HPU[1:0]:ON, (n-8) engines enabled
          0x7 9 HPU[9:1]:OFF /HPU[0]:ON, (n-9) 1 engine enabled
          NOTE: Higher numbered HPUs are crippled first. For instance, on CN78XX (with 10
          HPUs/cluster), if HPU_CLCRIP=0x1, then HPU #s [9] within the cluster are crippled and only
          HPU#s [8:0] are available.
          IMPNOTE: The encodings are done in such a way as to later be used with fuses (for future
          revisions which will disable some number of HPUs). Blowing a fuse has the effect that
          there will always be fewer HPUs available. [i.e: we never want a customer to blow
          additional fuses to get more HPUs].
          Software NOTE: The MIO_FUS___HNA_NUMHPU_CRIPPLE[2:0] fuse bits are forced into this
          register at reset. Any fuse bits that contain 1 are disallowed during a write and are
          always read as 1."

      - name: HPUCLKDIS
        bits: 0
        access: R/W/H
        reset: 0
        typical: 0
        description: |
          HNA clock disable source. When set, the HNA clocks for HPU (thread engine) operation are
          disabled (to conserve overall chip clocking power when the HNA function is not used).
          NOTE: When set, software must never issue NCB-direct CSR operations to the HNA (will
          result in NCB bus timeout errors).
          NOTE: This should only be written to a different value during power-on software
          initialization.
          Software NOTE: The MIO_FUS___HNA_HPU_DISABLE fuse bit is forced into this register at
          reset. If the fuse bit contains 1, writes to HPUCLKDIS are disallowed and are always read
          as 1.


  - name: HNA_HPU_DBG
    title: HNA HPU DBG Register
    address: 0x1180047000008
    bus: RSL
    description: |
      This register specifies the HPU CSR number, cluster number = CLID and HPU number = HPUID used
      during a a CSR read of the HNA_HPU_CSR register.
    fields:
      - name: --
        bits: 63..8
        access: RAZ
        reset: --
        typical: --
        description: Reserved.

      - name: CSRNUM
        bits: 7..6
        access: R/W
        reset: 0x0
        typical: 0x0
        description: |
          HPU CSR number
          0x0 = HPU_STATUS
          0x1 = DBG_CURSTK
          0x2 = DBG_GENERAL

      - name: CLID
        bits: 5..4
        access: R/W
        reset: 0x0
        typical: 0x0
        description: Cluster number. Valid range is 0-3.

      - name: HPUID
        bits: 3..0
        access: R/W
        reset: 0x0
        typical: 0x0
        description: HPU engine ID. Valid range 0-11.


  - name: HNA_HPU_CSR
    title: HNA HPU CSR Register
    address: 0x1180047000010
    bus: RSL
    description: |
      To read one of the HPU internal CSRs for debug (i.e. HPU_STATUS, DBG_CURSTK, DBG_GENERAL),
      first a CSR write of the HNA_HPU_DBG is done to specify the HPU CSR number, cluster number =
      CLID, and HPU number = HPUID, which is followed by a CSR read of the HPA_HPU_CSR which returns
      the contents of the specified HPU CSR.
    fields:
      - name: CSRDAT
        bits: 63..0
        access: RO/H
        reset: 0x0
        typical: 0x0
        description: HPU CSR contents specified by HNA_HPU_DBG.


  - name: HNA_HPU_EIR
    title: HNA HPU Error Insertion Register
    address: 0x1180047000018
    bus: RSL
    description: |
      Used by software to force parity or ECC errors on some internal HPU data structures. A CSR
      write of this register forces either a parity or ECC error on the next access at cluster
      number = CLID, HPU number = HPUID.
    fields:
      - name: --
        bits: 63..12
        access: RAZ
        reset: --
        typical: --
        description: Reserved.

      - name: WRDONE
        bits: 11
        access: RO/H
        reset: 0
        typical: 0
        description: |
          When HNA_HPU_EIR is written, this bit is cleared by hardware. When the targeted HPU has
          received the error injection command (i.e. error injection armed), the WRDONE bit is SET.
          Software first writes HNA_HPU_EIR, then does a polling read of the WRDONE bit (until it
          becomes 1), before issuing an HNA instruction to the targeted HPU which will inject the
          intended error type for a single occurrence (one-shot).

      - name: PDPERR
        bits: 10
        access: R/W
        reset: 0
        typical: 0
        description: Packet data buffer parity error. Forces parity error on next packet data buffer read.

      - name: SVFLIPSYN
        bits: 9..8
        access: R/W
        reset: 0x0
        typical: 0x0
        description: Save stack flip syndrome control. Forces 1-bit/2-bit errors on next save stack read.

      - name: RSFLIPSYN
        bits: 7..6
        access: R/W
        reset: 0x0
        typical: 0x0
        description: Run stack flip syndrome control. Forces 1-bit/2-bit errors on next run stack read.

      - name: CLID
        bits: 5..4
        access: R/W
        reset: 0x0
        typical: 0x0
        description: HPC cluster number. Valid range is 0-3.

      - name: HPUID
        bits: 3..0
        access: R/W
        reset: 0x0
        typical: 0x0
        description: HPU engine ID. Valid range is 0-11.


  - name: HNA_CONTROL
    title: HNA Control Register
    address: 0x1180047000020
    bus: RSL
    description: This register specifies the HNA CTL/HNC programmable controls.
    fields:
      - name: --
        bits: 63..13
        access: RAZ
        reset: --
        typical: --
        description: Reserved.

      - name: FRCPERR
        bits: 12
        access: R/W
        reset: 0
        typical: 0
        description: |
          Force parity error during an OCM load. When set, a parity error is forced during the OCM
          load instruction. Software can force a single line to contain a parity error by setting
          this bit and performance a OCM load for a single line (DLEN=32), then clearing the bit.

      - name: SBDNUM
        bits: 11..6
        access: R/W
        reset: 0x0
        typical: 0x0
        description: |
          Reserved. SBD debug entry number.
          INTERNAL: HNA Scoreboard debug control. Selects which one of 48 HNA Scoreboard entries is
          latched into the HNA_SBD_DBG[0-3] registers.

      - name: SBDLCK
        bits: 5
        access: R/W
        reset: 0
        typical: 0
        description: |
          Reserved. HNA scoreboard lock strobe. INTERNAL: HNA Scoreboard debug control. When written
          with a '1', the HNA Scoreboard Debug registers (HNA_SBD_DBG[0-3]) are all locked down.
          This allows SW to lock down the contents of the entire SBD for a single instant in time.
          All subsequent reads of the HNA scoreboard registers will return the data from that
          instant in time.

      - name: --
        bits: 4..3
        access: RAZ
        reset: --
        typical: --
        description: Reserved.

      - name: PMODE
        bits: 2
        access: R/W
        reset: 1
        typical: 1
        description: |
          Reserved. NCB-NRP arbiter mode. (0=Fixed Priority {LP=DFF,HP=RGF}/1=RR
          NOTE: This should only be written to a different value during power-on software
          initialization.

      - name: QMODE
        bits: 1
        access: R/W
        reset: 1
        typical: 1
        description: |
          Reserved. NCB-NRQ arbiter mode. 0 = Fixed priority (LP = NPF, IRF, WRF, PRF, RSRF, HP =
          SLL); 1 = Round robin.
          NOTE: This should only be written to a different value during power-on software
          initialization.

      - name: IMODE
        bits: 0
        access: R/W
        reset: 1
        typical: 1
        description: |
          Reserved. NCB-inbound arbiter. 0 = Fixed priority (LP = NRQ, HP = NRP); 1 = Round robin).
          NOTE: This should only be written to a different value during power-on software
          initialization.


  - name: HNA_ERROR
    title: HNA Error Status Register
    address: 0x1180047000028
    bus: RSL
    description: This register contains error status information.
    fields:
      - name: --
        bits: 63..21
        access: RAZ
        reset: --
        typical: --
        description: Reserved.

      - name: HNC_PARERR
        bits: 20
        access: R/W1C/H
        reset: 0
        typical: 0
        description: HNC reported parity error with the response data.

      - name: OSMERR
        bits: 19
        access: R/W1C/H
        reset: 0
        typical: 0
        description: OSM reported an error with the response data.

      - name: REPLERR
        bits: 18
        access: R/W1C/H
        reset: 0
        typical: 0
        description: |
          HNA illegal replication factor error. HNA only supports 1*, 2*, and 4* port replication.
          Legal configurations for memory are 2-port or 4-port configurations. The REPLERR interrupt
          is set in the following illegal configuration cases:
          1) An 8* replication factor is detected for any memory reference.
          2) A 4* replication factor is detected for any memory reference when only 2 memory ports
          are enabled.
          NOTE: If REPLERR is set during a HNA Graph Walk operation, the walk will prematurely
          terminate with RWORD0[REA] = ERR.

      - name: HNANXM
        bits: 17
        access: R/W1C/H
        reset: 0
        typical: 0
        description: |
          HNA non-existent memory access. HPUs (and backdoor CSR HNA memory region reads) have
          access to the following 40-bit L2/DRAM address space which maps to a 38-bit physical
          DDR3/4 SDRAM address space (256 GB max).
          DR0: 0x0 0000 0000 0000 to 0x0 0000 0FFF FFFF
          maps to lower 256MB of physical DDR3/4 SDRAM
          DR1: 0x0 0000 2000 0000 to 0x0 0020 0FFF FFFF
          maps to upper 127.75GB of DDR3/4 SDRAM
          NOTE: the 2nd 256MB hole maps to I/O and is unused (nonexistent) for memory.
          In the event the HNA generates a reference to the L2/DRAM address hole (0x0000.0FFF.FFFF -
          0x0000.1FFF.FFFF), the HNANXM programmable interrupt bit will be set.
          Software Note:
          The HNA Graph compiler must avoid making references to this 2nd 256MB HOLE which is a non-
          existent memory region.
          NOTE: If HNANXM is set during a HNA Graph Walk operation, then the walk will prematurely
          terminate with RWORD0[REAS]=MEMERR.

      - name: DLC1_DBE
        bits: 16
        access: R/W1C/H
        reset: 0
        typical: 0
        description: A DLC1 response indicated a double-bit ECC error (DBE).

      - name: DLC0_DBE
        bits: 15
        access: R/W1C/H
        reset: 0
        typical: 0
        description: A DLC0 response indicated a double-bit ECC error (DBE).

      - name: DLC1_OVFERR
        bits: 14
        access: R/W1C/H
        reset: 0
        typical: 0
        description: |
          DLC1 FIFO overflow error detected. This condition should never architecturally occur, and
          is here in case hardware credit/debit scheme is not working.

      - name: DLC0_OVFERR
        bits: 13
        access: R/W1C/H
        reset: 0
        typical: 0
        description: |
          DLC0 FIFO overflow error detected. This condition should never architecturally occur, and
          is here in case hardware credit/debit scheme is not working.

      - name: HNC_OVFERR
        bits: 12
        access: R/W1C/H
        reset: 0
        typical: 0
        description: |
          HNC (RAM1) address overflow error detected.
          This condition is signaled by the HPU when an node access is made to RAM1 outside the size
          of the RAM.

      - name: HNA_INST_ERR
        bits: 11
        access: R/W1C/H
        reset: 0
        typical: 0
        description: Instruction field ITYPE is not GWALK or CLOAD.

      - name: --
        bits: 10..6
        access: RAZ
        reset: --
        typical: --
        description: Reserved.

      - name: HPU_PDB_PAR_ERR
        bits: 5
        access: R/W1C/H
        reset: 0
        typical: 0
        description: |
          A parity error was detected in a packet data buffer in one of the HNA engines. This is not
          self-correcting, and the HPU behavior is undefined.

      - name: HPU_RNSTCK_DBE
        bits: 4
        access: R/W1C/H
        reset: 0
        typical: 0
        description: |
          A double-bit ECC (DBE) error was detected in the run stack of an HPU. This is not self-
          correcting, and the HPU behavior is undefined.

      - name: HPU_RNSTCK_SBE
        bits: 3
        access: R/W1C/H
        reset: 0
        typical: 0
        description: |
          A single-bit ECC (SBE) error was detected in the run stack of an HPU. This is self-
          correcting, and the HPU should continue to operate normally.

      - name: HPU_SVSTCK_DBE
        bits: 2
        access: R/W1C/H
        reset: 0
        typical: 0
        description: |
          A double-bit ECC (DBE) error was detected in the save stack / result buffer of an HPU.
          This is not self-correcting, and the HPU behavior is undefined.

      - name: HPU_SVSTCK_SBE
        bits: 1
        access: R/W1C/H
        reset: 0
        typical: 0
        description: |
          A single-bit ECC (SBE) error was detected in the save stack / result buffer of an HPU.
          This is self-correcting, and the HPU should continue to operate normally.

      - name: DBLOVF
        bits: 0
        access: R/W1C/H
        reset: 0
        typical: 0
        description: |
          Doorbell overflow detected - status bit. When set, the 20-bit accumulated doorbell
          register had overflowed (software wrote too many doorbell requests).
          NOTE: Detection of a doorbell register overflow is a catastrophic error which may leave
          the HNA hardware in an unrecoverable state.


  - name: HNA_ERROR_CAPTURE_INFO
    title: HNA Error Capture Info Register
    address: 0x1180047000030
    bus: RSL
    description: This register holds the meta-data for the HPU_STATUS captured during HNA_ERROR events.
    fields:
      - name: --
        bits: 63..10
        access: RAZ
        reset: --
        typical: --
        description: Reserved.

      - name: CL_ID
        bits: 9..8
        access: RO/H
        reset: --
        typical: --
        description: Cluster which was the source of the HPU_STATUS.

      - name: HPU_ID
        bits: 7..4
        access: RO/H
        reset: --
        typical: --
        description: HPU which was the source of the HPU_STATUS.

      - name: --
        bits: 3..2
        access: RAZ
        reset: --
        typical: --
        description: Reserved.

      - name: OVF
        bits: 1
        access: RO/H
        reset: 0
        typical: --
        description: |
          The OVF bit indicates that at least one HNA_ERROR condition has occurred while the
          CAPTURE_DATA register contained data, resulting in lost HPU_STATUS information. This bit
          will be cleared when the VLD bit is written to 1."

      - name: VLD
        bits: 0
        access: R/W1C/H
        reset: 0
        typical: --
        description: |
          The VLD bit indicates that an HNA_ERROR has occurred and the HPU_STATUS has been captured
          in the HNA_ERROR_CAPTURE_DATA register. The first such HPU_STATUS will be stored until
          this bit is cleared by writing a 1.


  - name: HNA_ERROR_CAPTURE_DATA
    title: HNA Error Capture Data Register
    address: 0x1180047000038
    bus: RSL
    description: This register holds the HPU_STATUS data captured during HNA_ERROR events.
    fields:
      - name: HPU_STAT
        bits: 63..0
        access: RO/H
        reset: --
        typical: --
        description: |
          HPU_STATUS data captured during HNA_ERROR events. It will preserve the HPU_STATUS from the
          first error event that is detected, until the VLD bit in the HNA_ERROR_CAPTURE_INFO
          register is cleared. If multiple error events occur before the VLD bit is cleared, the
          subsequent HPU_STATUS information will be lost. The error capture is triggered by the
          following error conditions:
          * HPU memory errors (SBE or DBE on svstk/rnstk/rwb, or parity error on PDB)
          * external memory errors (OSM/DLC)
          * bad node detected in HPU
          * bad address in HPU
          * bad stack entry in HPU
          * HNC parity error
          * RAM1 address overflow
          The HPU STATUS format is as follows:
          [63:60]   4'h0
          [60:40]   failing address                 Last fetched node
          [39:36]   4'h0
          [35:28]   svstck_synd
          [27]        svstck_dbe                      Interrupt
          [26]        svstck_sbe                       Interrupt
          [25:18]   rnstck_synd
          [17]        rnstck_dbe                      Interrupt
          [16]        rnstck_sbe                      Interrupt
          [15:11]   Current opcode
          [10]        1'b0
          [9]          OSM or DLC Response Error       REASON MEMERR
          [8]          Bad node                        REASON BADNODE
          [7]          Graph location is in RAM2       REASON BADADR
          [6]          Bad stack entry                 REASON BAD STACKENTRY
          [5]          Svstck full                     REASON SVSTACK FULL
          [4]          Rwb full                        REASON RWB FULL
          [3]          Rnstck full                     REASON RUN STACK FULL
          [2]          Packet data parity error               Interrupt
          [1]          RAM1 or RAM2 parity error       REASON MEMERR
          [0]          Ram1 overflow error             REASON MEMERR


  - name: HNA_SBD_DBG0
    title: HNA Scoreboard Debug 0 Register
    address: 0x1180047000040
    bus: RSL
    description: |
      When the HNA_CONTROL[SBDLCK] bit is written to 1, the contents of this register are locked
      down. Otherwise, the contents of this register are the active contents of the HNA scoreboard
      at the time of the CSR read.
    internal: |
      INTERNAL: VERIFICATION NOTE: Read data is unsafe. X's (undefined data) can propagate (in the
      behavioral model) on the reads unless the HPU Engine specified by HNA_CONTROL[SBDNUM] has
      previously been assigned an instruction.
    fields:
      - name: SBD
        bits: 63..0
        access: RO/H
        reset: --
        typical: --
        description: |
          HNA Scoreboard 0 data.
          [63]       (1) Unused
          [62]       (1) llptr_gntd
          [61]       (1) llptr_fetch
          [60]       (1) spill_req_1a
          [59:54]    (6) hpu_svstk_lvl[5:0]
          [53:36]   (18) svstk_len[17:0]
          [35:20]   (16) Cumulative result write counter (for HDR write)
          [19]       (1) Unused
          [18:15]    (4) Completion code
          [14]       (1) Completion detected
          [13]       (1) Waiting for HDR RWrCmtRsp
          [12]       (1) 1st (of 2) RWORD0(HDR) writes (w/ DONE=0) has been issued
          [11]       (1) Waiting for HDR RWrReq
          [10]       (1) Waiting for RWrReq
          [9]        (1) Waiting for WQWrReq issue
          [8]        (1) Waiting for PRdRsp EOT
          [7]        (1) Waiting for PRdReq Issue (to NRQ)
          [6]        (1) Packet data valid
          [5]        (1) WQVLD
          [4]        (1) WQ done point (either WQWrReq issued (for WQPTR<>0) OR HDR RWrCmtRsp
          completed)
          [3]        (1) Resultant write STF/P Mode
          [2]        (1) Packet data LDT mode
          [1]        (1) Unused
          [0]        (1) Valid


  - name: HNA_SBD_DBG1
    title: HNA Scoreboard Debug 1 Register
    address: 0x1180047000048
    bus: RSL
    description: |
      When the HNA_CONTROL[SBDLCK] bit is written to 1, the contents of this register are locked
      down. Otherwise, the contents of this register are the 'active' contents of the HNA scoreboard
      at the time of the CSR read.
    internal: |
      INTERNAL: VERIFICATION NOTE: Read data is unsafe. X's (undefined data) can propagate (in the
      behavioral model) on the reads unless the HPU Engine specified by HNA_CONTROL[SBDNUM] has
      previously been assigned an instruction.
    fields:
      - name: SBD
        bits: 63..0
        access: RO/H
        reset: --
        typical: --
        description: |
          HNA Scoreboard 1 data.
          [63:58]    (6) Reserved
          [57:16]   (42) Packet data pointer
          [15]       (1) Unused
          [14:0]    (15) Packet data counter


  - name: HNA_SBD_DBG2
    title: HNA Scoreboard Debug 2 Register
    address: 0x1180047000050
    bus: RSL
    description: |
      When the HNA_CONTROL[SBDLCK] bit is written to 1, the contents of this register are locked
      down. Otherwise, the contents of this register are the actives contents of the HNA scoreboard
      at the time of the CSR read.
    internal: |
      INTERNAL: VERIFICATION NOTE: Read data is unsafe. X's (undefined data) can propagate (in the
      behavioral model) on the reads unless the HPU Engine specified by HNA_CONTROL[SBDNUM] has
      previously been assigned an instruction.
    fields:
      - name: SBD
        bits: 63..0
        access: RO/H
        reset: --
        typical: --
        description: |
          HNA Scoreboard 2 data.
          [63:48]   (16) Reserved
          [47:45]    (3) ITYPE
          [44:6]    (39) Result write pointer
          [5:0]      (6) Pending result write counter


  - name: HNA_SBD_DBG3
    title: HNA Scoreboard Debug 3 Register
    address: 0x1180047000058
    bus: RSL
    description: |
      When the HNA_CONTROL[SBDLCK] bit is written 1, the contents of this register are locked down.
      Otherwise, the contents of this register are the 'active' contents of the HNA Scoreboard at
      the time of the CSR read.
    internal: |
      INTERNAL: VERIFICATION NOTE: Read data is unsafe. X's (undefined data) can propagate (in the
      behavioral model) on the reads unless the HPU Engine specified by HNA_CONTROL[SBDNUM] has
      previously been assigned an instruction.
    fields:
      - name: SBD
        bits: 63..0
        access: RO/H
        reset: --
        typical: --
        description: |
          HNA Scoreboard 3 data.
          [63:48]   (16) RESERVED
          [47]       (1) fill_start_1a
          [46]       (1) spill_start_1a
          [45]       (1) fill_en
          [44]       (1) chunk_ptr_addr_match_1a
          [43]       (1) rnstk_ptrupdate_1a
          [42]       (1) svllrd
          [41:38]    (4) state[3:0]
          [37:29]    (9) hpu_rnstk_lvl[8:0]
          [28:11]   (18) ext_rnstk_lvl[17:0]
          [10:0]    (11) rnstk_addr[10:0]


  - name: HNA_PFC_GCTL
    title: |
      INTERNAL: HNA Performance Counter Global Control Register
    address: 0x1180047000080
    bus: RSL
    description: Global control across all performance counters.
    fields:
      - name: --
        bits: 63..12
        access: RAZ
        reset: --
        typical: --
        description: Reserved.

      - name: CNT3RCLR
        bits: 11
        access: R/W
        reset: 0
        typical: 0
        description: |
          Performance counter 3 read clear. If this bit is set, CSR reads to the HNA_PFC3_CNT will
          clear the count value. This allows software to maintain 'cumulative' counters to avoid
          hardware wraparound.

      - name: CNT2RCLR
        bits: 10
        access: R/W
        reset: 0
        typical: 0
        description: |
          Performance counter 2 read clear. If this bit is set, CSR reads to the HNA_PFC2_CNT will
          clear the count value. This allows software to maintain 'cumulative' counters to avoid
          hardware wraparound.

      - name: CNT1RCLR
        bits: 9
        access: R/W
        reset: 0
        typical: 0
        description: |
          Performance counter 1 read clear. If this bit is set, CSR reads to the HNA_PFC1_CNT will
          clear the count value. This allows software to maintain 'cumulative' counters to avoid
          hardware wraparound.

      - name: CNT0RCLR
        bits: 8
        access: R/W
        reset: 0
        typical: 0
        description: |
          Performance counter 0 read clear. If this bit is set, CSR reads to the HNA_PFC0_CNT will
          clear the count value. This allows software to maintain 'cumulative' counters to avoid
          hardware wraparound.

      - name: CNT3WCLR
        bits: 7
        access: R/W
        reset: 0
        typical: 0
        description: |
          Performance counter 3 write clear. If this bit is set, CSR writes to the HNA_PFC3_CNT will
          clear the count value. If this bit is clear, CSR writes to the HNA_PFC3_CNT will continue
          the count from the written value.

      - name: CNT2WCLR
        bits: 6
        access: R/W
        reset: 0
        typical: 0
        description: |
          Performance counter 2 write clear. If this bit is set, CSR writes to the HNA_PFC2_CNT will
          clear the count value. If this bit is clear, CSR writes to the HNA_PFC2_CNT will continue
          the count from the written value.

      - name: CNT1WCLR
        bits: 5
        access: R/W
        reset: 0
        typical: 0
        description: |
          Performance counter 1 write clear. If this bit is set, CSR writes to the HNA_PFC1_CNT will
          clear the count value. If this bit is clear, CSR writes to the HNA_PFC1_CNT will continue
          the count from the written value.

      - name: CNT0WCLR
        bits: 4
        access: R/W
        reset: 0
        typical: 0
        description: |
          Performance counter 0 write clear. If this bit is set, CSR writes to the HNA_PFC0_CNT will
          clear the count value. If this bit is clear, CSR writes to the HNA_PFC0_CNT will continue
          the count from the written value.

      - name: CNT3ENA
        bits: 3
        access: R/W
        reset: 0
        typical: 0
        description: Performance counter 3 enable. When this bit is set, the performance counter 3 is enabled.

      - name: CNT2ENA
        bits: 2
        access: R/W
        reset: 0
        typical: 0
        description: Performance counter 2 enable. When this bit is set, the performance counter 2 is enabled.

      - name: CNT1ENA
        bits: 1
        access: R/W
        reset: 0
        typical: 0
        description: Performance counter 1 enable. When this bit is set, the performance counter 1 is enabled.

      - name: CNT0ENA
        bits: 0
        access: R/W
        reset: 0
        typical: 0
        description: Performance counter 0 enable. When this bit is set, the performance counter 0 is enabled.


  - name: HNA_PFC0_CTL
    title: |
      INTERNAL: HNA Performance Counter 0 Control Register
    address: 0x1180047000088
    bus: RSL
    attributes:
      dv_fc_scratch: "ALL"
    fields:
      - name: --
        bits: 63..14
        access: RAZ
        reset: --
        typical: --
        description: Reserved.

      - name: EVSEL
        bits: 13..8
        access: R/W
        reset: --
        typical: --
        description: Performance counter 0 event selector (64 total). Enumerated by HNA_PFC_SEL_E.

      - name: --
        bits: 7..6
        access: RAZ
        reset: --
        typical: --
        description: Reserved.

      - name: CLHPU
        bits: 5..2
        access: R/W
        reset: 0x0
        typical: 0x0
        description: |
          "Performance counter 0 cluster HPU selector. When HNA_PFC_GCTL[PMODE]=0 (per-cluster HPU),
          this field
          is used to select/monitor the cluster's HPU# for all events
          associated with performance counter #0."

      - name: CLNUM
        bits: 1..0
        access: R/W
        reset: 0x0
        typical: 0x0
        description: |
          "Performance counter 0 cluster selector. When HNA_PFC_GCTL[PMODE]=0 (per-cluster HPU),
          this field is used to select/monitor the cluster# for all events associated with
          performance counter #0."


  - name: HNA_PFC0_CNT
    title: |
      INTERNAL: HNA Performance Counter 0 Register
    address: 0x1180047000090
    bus: RSL
    fields:
      - name: PFCNT
        bits: 63..0
        access: R/W/H
        reset: 0x0
        typical: --
        description: |
          HNA performance counter 0. When HNA_PFC_GCTL[CNT0ENA]=1, the event selected by
          HNA_PFC0_CTL[EVSEL] is counted. See also HNA_PFC_GCTL[CNT0WCLR] and HNA_PFC_GCTL
          [CNT0RCLR] for special clear count cases available for software data collection.


  - name: HNA_PFC1_CTL
    title: |
      INTERNAL: HNA Performance Counter 1 Control Register
    address: 0x1180047000098
    bus: RSL
    fields:
      - name: --
        bits: 63..14
        access: RAZ
        reset: --
        typical: --
        description: Reserved.

      - name: EVSEL
        bits: 13..8
        access: R/W
        reset: --
        typical: --
        description: Performance counter 1 event selector (64 total). Enumerated by HNA_PFC_SEL_E.

      - name: --
        bits: 7..6
        access: RAZ
        reset: --
        typical: --
        description: Reserved.

      - name: CLHPU
        bits: 5..2
        access: R/W
        reset: 0x0
        typical: 0x0
        description: |
          "Performance counter 1 cluster HPU selector. When HNA_PFC_GCTL[PMODE]=0 (per-cluster HPU),
          this field is used to select/monitor the cluster's HPU# for all events associated with
          performance counter 1."

      - name: CLNUM
        bits: 1..0
        access: R/W
        reset: 0x0
        typical: 0x0
        description: |
          "Performance counter 1 cluster selector. When HNA_PFC_GCTL[PMODE]=0 (per-cluster HPU),
          this field is used to select/monitor the cluster# for all events associated with
          performance counter 1."


  - name: HNA_PFC1_CNT
    title: |
      INTERNAL: HNA Performance Counter 1 Register
    address: 0x11800470000A0
    bus: RSL
    fields:
      - name: PFCNT
        bits: 63..0
        access: R/W/H
        reset: 0x0
        typical: --
        description: |
          HNA performance counter 1. When HNA_PFC_GCTL[CNT1ENA]=1, the event selected by
          HNA_PFC1_CTL[EVSEL] is counted. See also HNA_PFC_GCTL[CNT1WCLR] and HNA_PFC_GCTL
          [CNT1RCLR] for special clear count cases available for software data collection.


  - name: HNA_PFC2_CTL
    title: |
      INTERNAL: HNA Performance Counter 2 Control Register
    address: 0x11800470000A8
    bus: RSL
    fields:
      - name: --
        bits: 63..14
        access: RAZ
        reset: --
        typical: --
        description: Reserved.

      - name: EVSEL
        bits: 13..8
        access: R/W
        reset: --
        typical: --
        description: "Performance counter #2 event selector (64 total). Enumerated by HNA_PFC_SEL_E."

      - name: --
        bits: 7..6
        access: RAZ
        reset: --
        typical: --
        description: Reserved.

      - name: CLHPU
        bits: 5..2
        access: R/W
        reset: 0x0
        typical: 0x0
        description: |
          "Performance counter #2 cluster HPU Selector. When HNA_PFC_GCTL[PMODE]=0 (per-cluster
          HPU), this field is used to select/monitor the cluster's HPU# for all events associated
          with performance counter #2."

      - name: CLNUM
        bits: 1..0
        access: R/W
        reset: 0x0
        typical: 0x0
        description: |
          "Performance counter #2 cluster selector. When HNA_PFC_GCTL[PMODE]=0 (per-cluster HPU),
          this field is used to select/monitor the cluster# for all events associated with
          performance counter #2."


  - name: HNA_PFC2_CNT
    title: |
      INTERNAL: HNA Performance Counter 2 Register
    address: 0x11800470000B0
    bus: RSL
    fields:
      - name: PFCNT
        bits: 63..0
        access: R/W/H
        reset: 0x0
        typical: --
        description: |
          HNA performance counter 2. When HNA_PFC_GCTL[CNT2ENA]=1, the event selected by
          HNA_PFC2_CTL[EVSEL] is counted. See also HNA_PFC_GCTL[CNT2WCLR] and HNA_PFC_GCTL
          [CNT2RCLR] for special clear count cases available for software data collection.


  - name: HNA_PFC3_CTL
    title: |
      INTERNAL: HNA Performance Counter 3 Control Register
    address: 0x11800470000B8
    bus: RSL
    fields:
      - name: --
        bits: 63..14
        access: RAZ
        reset: --
        typical: --
        description: Reserved.

      - name: EVSEL
        bits: 13..8
        access: R/W
        reset: --
        typical: --
        description: Performance counter 3 event selector (64 total). Enumerated by HNA_PFC_SEL_E.

      - name: --
        bits: 7..6
        access: RAZ
        reset: --
        typical: --
        description: Reserved.

      - name: CLHPU
        bits: 5..2
        access: R/W
        reset: 0x0
        typical: 0x0
        description: |
          "Performance counter 3 cluster HPU selector. When HNA_PFC_GCTL[PMODE]=0 (per-cluster HPU),
          this field is used to select/monitor the cluster's HPU# for all events associated with
          performance counter #3."

      - name: CLNUM
        bits: 1..0
        access: R/W
        reset: 0x0
        typical: 0x0
        description: |
          "Performance counter 3 cluster selector. When HNA_PFC_GCTL[PMODE]=0 (per-cluster HPU),
          this field is used to select/monitor the cluster# for all events associated with
          performance counter 3."


  - name: HNA_PFC3_CNT
    title: |
      INTERNAL: HNA Performance Counter 3 Register
    address: 0x11800470000C0
    bus: RSL
    fields:
      - name: PFCNT
        bits: 63..0
        access: R/W/H
        reset: 0x0
        typical: --
        description: |
          HNA performance counter 3. When HNA_PFC_GCTL[CNT3ENA]=1, the event selected by
          HNA_PFC3_CTL[EVSEL] is counted. See also HNA_PFC_GCTL[CNT3WCLR] and HNA_PFC_GCTL
          [CNT3RCLR] for special clear count cases available for software data collection.


  - name: HNA_BIST0
    title: HNA BIST Status 0 Register
    address: 0x11800470007F0
    bus: RSL
    description: |
      This register shows the result of the BIST run on the HNA (per-HPU).
      1 = BIST error, 0 = BIST passed, is in progress, or never ran.
    fields:
      - name: --
        bits: 63..60
        access: RAZ
        reset: 0x0
        typical: 0x0
        description: Reserved.

      - name: HPC3
        bits: 59..48
        access: RO/H
        reset: 0x0
        typical: 0x0
        description: BIST results for HPC3 RAM(s) (per-HPU).

      - name: --
        bits: 47..44
        access: RAZ
        reset: 0x0
        typical: 0x0
        description: Reserved.

      - name: HPC2
        bits: 43..32
        access: RO/H
        reset: 0x0
        typical: 0x0
        description: BIST results for HPC2 RAM(s) (per-HPU).

      - name: --
        bits: 31..28
        access: RAZ
        reset: 0x0
        typical: 0x0
        description: Reserved.

      - name: HPC1
        bits: 27..16
        access: RO/H
        reset: 0x0
        typical: 0x0
        description: BIST results for HPC1 RAM(s) (per-HPU).

      - name: --
        bits: 15..12
        access: RAZ
        reset: 0x0
        typical: 0x0
        description: Reserved.

      - name: HPC0
        bits: 11..0
        access: RO/H
        reset: 0x0
        typical: 0x0
        description: BIST results for HPC0 RAM(s) (per-HPU).


  - name: HNA_BIST1
    title: HNA BIST Status 1 Register
    address: 0x11800470007F8
    bus: RSL
    description: |
      This register shows the result of the BIST run on the HNA (globals).
      1 = BIST error, 0 = BIST passed, is in progress, or never ran.
    fields:
      - name: --
        bits: 63..7
        access: RAZ
        reset: 0x0
        typical: 0x0
        description: Reserved.

      - name: HNC1
        bits: 6
        access: RO/H
        reset: 0
        typical: 0
        description: SC1 BIST results for cumulative HNC1 RAMs.

      - name: HNC0
        bits: 5
        access: RO/H
        reset: 0
        typical: 0
        description: SC0 BIST results for cumulative HNC0 RAMs.

      - name: MRP1
        bits: 4
        access: RO/H
        reset: 0
        typical: 0
        description: |
          BIST results for DSM-DLC:MRP1 RAM.

      - name: MRP0
        bits: 3
        access: RO/H
        reset: 0
        typical: 0
        description: |
          BIST results for DSM-DLC:MRP0 RAM.

      - name: --
        bits: 2..1
        access: RAZ
        reset: 0x0
        typical: 0x0
        description: Reserved.

      - name: GIB
        bits: 0
        access: RO/H
        reset: 0
        typical: 0
        description: BIST results for GIB RAM.


  - name: HNA_DBELL
    title: HNA Doorbell Register
    address: 0x1470000000000
    bus: NCB
    description: |
      To write to the HNA_DBELL register, a device issues an IOBST directed at the HNA with
      addr[34:32] = 0x0 or 0x1. To read the HNA_DBELL register, a device issues an IOBLD64 directed
      at the HNA with addr[34:32] = 0x0 or 0x1.
      If HNA_CONFIG[HPUCLKDIS]=1 (HNA-HPU clocks disabled), reads/writes to the HNA_DBELL register
      do not take effect. If the HNA-disable fuse is blown, reads/writes to the HNA_DBELL register
      do not take effect.
    fields:
      - name: --
        bits: 63..20
        access: RAZ
        reset: --
        typical: --
        description: Reserved.

      - name: DBELL
        bits: 19..0
        access: R/W/H
        reset: 0x0
        typical: --
        description: |
          Represents the cumulative total of pending HNA instructions that software has previously
          written into the HNA instruction FIFO (DIF) in main memory. Each HNA instruction contains
          a fixed size 64B instruction word which is executed by the HNA hardware. The DBELL field
          can hold up to 1M-1 (2^20-1) pending HNA instruction requests. During a software read, the
          most recent contents of HNA_DBELL are returned at the time the NCB-INB bus is driven.
          NOTE: Since HNA hardware updates this register, its contents are unpredictable in
          software.


  - name: HNA_DIFRDPTR
    title: HNA Instruction FIFO RDPTR Register
    address: 0x1470200000000
    bus: NCB
    description: |
      To write to the HNA_DIFRDPTR register, a device issues an IOBST directed at the HNA with
      addr[34:32] = 0x2 or 0x3. To read the HNA_DIFRDPTR register, a device issues an IOBLD64
      directed at the HNA with addr[34:32] = 0x2 or 0x3.
      If HNA_CONFIG[HPUCLKDIS]=1 (HNA-HPU clocks disabled), reads/writes to HNA_DIFRDPTR do not take
      effect. If the HNA-disable fuse is blown, reads/writes to HNA_DIFRDPTR do not take effect.
    fields:
      - name: --
        bits: 63..42
        access: RAZ
        reset: --
        typical: --
        description: Reserved.

      - name: RDPTR
        bits: 41..6
        access: R/W/H
        reset: 0x0
        typical: --
        description: |
          Represents the 64B-aligned address of the current instruction in the HNA Instruction FIFO
          in main memory. The RDPTR must be seeded by software at boot time, and is then maintained
          thereafter by HNA hardware. During the software seed write, RDPTR[6]=0, since HNA
          instruction chunks must be 128B aligned. During a software read, the most recent contents
          of RDPTR are returned at the time the NCB-INB bus is driven.
          NOTE: Since HNA hardware updates this register, its contents are unpredictable in software
          (unless it is guaranteed that no new doorbell register writes have occurred and HNA_DBELL
          is read as zero).

      - name: --
        bits: 5..0
        access: RAZ
        reset: --
        typical: --
        description: Reserved.


  - name: HNA_HNC0_RAM1(0..63)
    title: |
      INTERNAL: HNA HNC 0 RAM 1 Access Register
    address: 0x1470400000000 + a*0x8
    bus: NCB
    description: |
      This address space allows read-only access to HNC0 RAM1 for diagnostic use. It is defined here
      to contain 64 words (16 RAM lines) for basic DV testing, but the actual address space spans
      the entire RAM1, 8192 lines.
    fields:
      - name: RAM1_DATA
        bits: 63..0
        access: RO
        reset: --
        typical: --
        description: 64-bit chunk of RAM1.


  - name: HNA_HNC0_RAM2(0..63)
    title: |
      INTERNAL: HNA HNC 0 RAM 2 Access Register
    address: 0x1470400040000 + a*0x8
    bus: NCB
    description: |
      This address space allows read-only access to HNC0 RAM2 for diagnostic use. It is defined here
      to contain 64 words (16 RAM lines) for basic DV testing, but the actual address space spans
      the entire RAM2, 512 lines.
    fields:
      - name: RAM2_DATA
        bits: 63..0
        access: RO
        reset: --
        typical: --
        description: 64-bit chunk of RAM2.


  - name: HNA_HNC1_RAM1(0..63)
    title: |
      INTERNAL: HNA HNC 1 RAM 1 Access Register
    address: 0x1470400400000 + a*0x8
    bus: NCB
    description: |
      This address space allows read-only access to HNC1 RAM1 for diagnostic use. It is defined here
      to contain 64 words (16 RAM lines) for basic DV testing, but the actual address space spans
      the entire RAM1, 8192 lines.
    fields:
      - name: RAM1_DATA
        bits: 63..0
        access: RO
        reset: --
        typical: --
        description: 64-bit chunk of RAM1.


  - name: HNA_HNC1_RAM2(0..63)
    title: |
      INTERNAL: HNA HNC 1 RAM 2 Access Register
    address: 0x1470400440000 + a*0x8
    bus: NCB
    description: |
      This address space allows read-only access to HNC1 RAM2 for diagnostic use. It is defined here
      to contain 64 words (16 RAM lines) for basic DV testing, but the actual address space spans
      the entire RAM1, 512 lines.
    fields:
      - name: RAM2_DATA
        bits: 63..0
        access: RO
        reset: --
        typical: --
        description: 64-bit chunk of RAM2.


  - name: HNA_DIFCTL
    title: HNA Instruction FIFO Control Register
    address: 0x1470600000000
    bus: NCB
    description: |
      To write to the HNA_DIFCTL register, a device issues an IOBST directed at the HNA with
      addr[34:32]=0x6. To read the HNA_DIFCTL register, a device issues an IOBLD64 directed at the
      HNA with addr[34:32]=0x6.
      This register is intended to only be written once (at power-up). Any future writes could cause
      the HNA and FPA hardware to become unpredictable. If HNA_CONFIG[HPUCLKDIS]=1 (HNA-HPU clocks
      disabled), reads/writes to HNA_DIFCTL do not take effect. If the HNA-disable FUSE is blown,
      reads/writes to HNA_DIFCTL do not take effect.
    fields:
      - name: --
        bits: 63..42
        access: RAZ
        reset: --
        typical: --
        description: Reserved.

      - name: AURA
        bits: 41..26
        access: R/W
        reset: 0x0
        typical: --
        description: |
          Represents the 16-bit Aura ID used by HNA hardware when the HNA instruction chunk is
          recycled back to the Free Page List maintained by FPA (once the HNA instruction has been
          issued).

      - name: --
        bits: 25..13
        access: RAZ
        reset: --
        typical: --
        description: Reserved.

      - name: LDWB
        bits: 12
        access: R/W
        reset: 1
        typical: --
        description: |
          Load Don't Write Back. When set, the hardware issues LDWB command towards the cache when
          fetching last word of instructions; as a result the line is not written back when
          replaced. When clear, the hardware issues regular load towards cache which will cause the
          line to be written back before being replaced.

      - name: --
        bits: 11..9
        access: RAZ
        reset: --
        typical: --
        description: Reserved.

      - name: SIZE
        bits: 8..0
        access: R/W
        reset: 0x3
        typical: --
        description: |
          Represents the number of 64B instructions contained within each HNA instruction chunk. At
          power-on, software seeds the SIZE register with a fixed chunk size (must be at least 3).
          HNA hardware uses this field to determine the size of each HNA instruction chunk, in order
          to:
          a) determine when to read the next HNA instruction chunk pointer which is written by
          software at the end of the current HNA instruction chunk (see HNA description of next
          chunk buffer Ptr for format).
          b) determine when a HNA instruction chunk can be returned to the Free Page List maintained
          by FPA



