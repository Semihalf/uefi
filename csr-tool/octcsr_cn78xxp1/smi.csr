# -*- csr3 -*-
# You must run "csr3 rtl" after editing this file!
---
name: SMI
registers:
  - name: SMI_DRV_CTL
    title: SMI Drive Strength Control Register
    address: 0x1180000001828
    bus: RSL
    description: Enables the SMI interface. SMI Registers for the register address.
    attributes:
      dv_fc_scratch: "ALL"
    fields:
      - name: --
        bits: 63..11
        access: RAZ
        reset: --
        typical: --
        description: Reserved.

      - name: PCTL
        bits: 10..8
        access: R/W
        reset: 0x6
        typical: 0x6
        description: |
          PCTL drive strength control bits. Suggested values:
          0x4 = 75 ohm.
          0x6 = 50 ohm.
          0x7 = 40 ohm.

      - name: --
        bits: 7..3
        access: RAZ
        reset: --
        typical: --
        description: Reserved.

      - name: NCTL
        bits: 2..0
        access: R/W
        reset: 0x6
        typical: 0x6
        description: |
          NCTL drive strength control bits. Suggested values:
          0x4 = 75 ohm.
          0x6 = 50 ohm.
          0x7 = 40 ohm.


  - name: SMI(0..3)_CMD
    title: SMI Command Control Register
    address: 0x1180000003800 + a*0x80
    bus: RSL
    description: |
      This register forces a read or write command to the PHY. Write operations to this register
      create SMI transactions. Software will poll (depending on the transaction type). SMI Registers
      for the register address.
    fields:
      - name: --
        bits: 63..18
        access: RAZ
        reset: --
        typical: --
        description: Reserved.

      - name: PHY_OP
        bits: 17..16
        access: R/W
        reset: 0x0
        typical: --
        description: |
          PHY opcode, depending on SMI(0..3)_CLK[MODE] setting.
          If SMI(0..3)_CLK[MODE] = 0 (<=1Gbs / Clause 22),
          0 = write operation, encoded in the frame as 01
          1 = read operation, encoded in the frame as 10.
          If SMI(0..3)_CLK[MODE] = 1 (>1Gbs / Clause 45),
          00=address, 01=write, 11=read, 10=post-read-increment-address.

      - name: --
        bits: 15..13
        access: RAZ
        reset: --
        typical: --
        description: Reserved.

      - name: PHY_ADR
        bits: 12..8
        access: R/W
        reset: 0x0
        typical: --
        description: PHY address.

      - name: --
        bits: 7..5
        access: RAZ
        reset: --
        typical: --
        description: Reserved.

      - name: REG_ADR
        bits: 4..0
        access: R/W
        reset: 0x0
        typical: --
        description: PHY register offset.


  - name: SMI(0..3)_WR_DAT
    title: SMI Write Data Register
    address: 0x1180000003808 + a*0x80
    bus: RSL
    description: This register provides the data for a write operation. SMI Registers for the register address.
    fields:
      - name: --
        bits: 63..18
        access: RAZ
        reset: --
        typical: --
        description: Reserved.

      - name: PENDING
        bits: 17
        access: RO/H
        reset: 0
        typical: --
        description: Write transaction pending. Indicates that an SMI write transaction is in flight.

      - name: VAL
        bits: 16
        access: RO/H
        reset: 0
        typical: --
        description: Write data valid. Asserts when the write transaction completes. A read to this register clears VAL.

      - name: DAT
        bits: 15..0
        access: R/W/H
        reset: 0x0
        typical: --
        description: Write data.


  - name: SMI(0..3)_RD_DAT
    title: SMI Read Data Register
    address: 0x1180000003810 + a*0x80
    bus: RSL
    description: This register contains the data in a read operation. SMI Registers for the register address.
    fields:
      - name: --
        bits: 63..18
        access: RAZ
        reset: --
        typical: --
        description: Reserved.

      - name: PENDING
        bits: 17
        access: RO/H
        reset: 0
        typical: --
        description: Read transaction pending. Indicates that an SMI read transaction is in flight.

      - name: VAL
        bits: 16
        access: RO/H
        reset: 0
        typical: --
        description: Read data valid. Asserts when the read transaction completes. A read to this register clears VAL.

      - name: DAT
        bits: 15..0
        access: RO/H
        reset: 0x0
        typical: --
        description: Read data.


  - name: SMI(0..3)_CLK
    title: SMI Clock Control Register
    address: 0x1180000003818 + a*0x80
    bus: RSL
    description: This register determines the SMI timing characteristics. SMI Registers for the register address.
    fields:
      - name: --
        bits: 63..25
        access: RAZ
        reset: --
        typical: --
        description: Reserved.

      - name: MODE
        bits: 24
        access: R/W
        reset: 0
        typical: 0
        description: IEEE operating mode; 0 = Clause 22 compliant, 1 = Clause 45 compliant.

      - name: --
        bits: 23..21
        access: RAZ
        reset: --
        typical: --
        description: Reserved.

      - name: SAMPLE_HI
        bits: 20..16
        access: R/W
        reset: 0x0
        typical: 0x0
        description: Sample (extended bits). Specifies in coprocessor clock cycles when to sample read data.

      - name: SAMPLE_MODE
        bits: 15
        access: R/W
        reset: 0
        typical: 0
        description: |
          Read data sampling mode.
          According to the 802.3 specification, on read operations, the STA transitions SMIn_MDC and
          the PHY drives SMIn_MDIO with some delay relative to that edge. This is Edge1.
          The STA then samples SMIn_MDIO on the next rising edge of SMIn_MDC. This is Edge2. The
          read data can be sampled relative to either edge.
          0 = Sample time is relative to Edge2.
          1 = Sample time is relative to Edge1.

      - name: --
        bits: 14
        access: RAZ
        reset: --
        typical: --
        description: Reserved.

      - name: CLK_IDLE
        bits: 13
        access: R/W
        reset: 0
        typical: 0
        description: SMIn_MDC toggle. When set, this bit causes SMIn_MDC not to toggle on idle cycles.

      - name: PREAMBLE
        bits: 12
        access: R/W
        reset: 1
        typical: 1
        description: |
          Preamble. When this bit is set, the 32-bit preamble is sent first on SMI transactions.
          This field must be set to 1 when MODE = 1 in order for the receiving PHY to correctly
          frame the transaction.

      - name: SAMPLE
        bits: 11..8
        access: R/W
        reset: 0x2
        typical: 0x2
        description: |
          Sample read data. Specifies the number of coprocessor clock cycles after the rising edge
          of SMIn_MDC to wait before sampling read data.
          (SAMPLE_HI,SAMPLE) > 1
          (SAMPLE_HI,SAMPLE) + 3 <= 2 * PHASE

      - name: PHASE
        bits: 7..0
        access: R/W
        reset: 0x64
        typical: 0x64
        description: |
          MDC clock phase. Specifies the number of coprocessor clock cycles that make up an SMIn_MDC
          phase.
          PHASE > 2


  - name: SMI(0..3)_EN
    title: SMI Enable Register
    address: 0x1180000003820 + a*0x80
    bus: RSL
    description: Enables the SMI interface. SMI Registers for the register address.
    fields:
      - name: --
        bits: 63..1
        access: RAZ
        reset: --
        typical: --
        description: Reserved.

      - name: EN
        bits: 0
        access: R/W
        reset: 0
        typical: 1
        description: |
          SMI/MDIO interface enable:
          1 = Enable interface.
          0 = Disable interface: no transactions, no SMIn_MDC transitions.



