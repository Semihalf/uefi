# -*- csr3 -*-
# You must run "csr3 rtl" after editing this file!
---
name: LBK
enums:
  - name: LBK_INTSN_E
    title: LBK Interrupt Source Enumeration
    attributes:
      width: "20"
    description: Enumerates the different generated interrupts.
    values:
      - name: LBK_INT_DAT_SBE
        value: 0x12000
        description: See LBK_INT[DAT_SBE].

      - name: LBK_INT_DAT_DBE
        value: 0x12001
        description: See LBK_INT[DAT_DBE].

      - name: LBK_INT_DAT_UFLOW
        value: 0x12002
        description: See LBK_INT[DAT_UFLOW].

      - name: LBK_INT_DAT_OFLOW
        value: 0x12003
        description: See LBK_INT[DAT_OFLOW].

      - name: LBK_INT_CHAN_UFLOW
        value: 0x12004
        description: See LBK_INT[CHAN_UFLOW].

      - name: LBK_INT_CHAN_OFLOW
        value: 0x12005
        description: See LBK_INT[CHAN_OFLOW].


registers:
  - name: LBK_SFT_RST
    title: Loopback Reset Register
    address: 0x1180012000000
    bus: RSL
    fields:
      - name: --
        bits: 63..1
        access: RAZ
        reset: --
        typical: --
        description: Reserved.

      - name: RESET
        bits: 0
        access: R/W1
        reset: 0
        typical: 0
        description: Reset. When set, causes a reset of Loopback, except RSL.


  - name: LBK_CLK_GATE_CTL
    title: Loopback Reset Register
    address: 0x1180012000008
    bus: RSL
    attributes:
      chip_pass: "o78>=2.0"
    fields:
      - name: --
        bits: 63..1
        access: RAZ
        reset: --
        typical: --
        description: Reserved.

      - name: DIS
        bits: 0
        access: R/W
        reset: 1
        typical: 0
        description: Clock gate disable. When set, forces gated clock to always on. Added in pass 2.


  - name: LBK_BIST_RESULT
    title: Loopback BIST Result Register
    address: 0x1180012000020
    bus: RSL
    description: |
      This register provides access to the internal BIST results. Each bit is the BIST result of an
      individual memory (per bit, 0 = pass and 1 = fail).
    attributes:
      dv_bist_all_fail_test: "ALL"
    fields:
      - name: --
        bits: 63..1
        access: RAZ
        reset: --
        typical: --
        description: Reserved.

      - name: DAT
        bits: 0
        access: RO
        reset: --
        typical: 0
        description: BIST result of the Data FIFO RAM.


  - name: LBK_INT
    title: Loopback Interrupt Register
    address: 0x1180012000040
    bus: RSL
    fields:
      - name: --
        bits: 63..6
        access: RAZ
        reset: --
        typical: --
        description: Reserved.

      - name: CHAN_OFLOW
        bits: 5
        access: R/W1C/H
        reset: 0
        typical: 0
        description: |
          Internal assertion, packet channel credit FIFO had an overflow. Throws
          LBK_INTSN_E::LBK_INT_CHAN_OFLOW.

      - name: CHAN_UFLOW
        bits: 4
        access: R/W1C/H
        reset: 0
        typical: 0
        description: |
          Internal assertion, packet channel credit FIFO had an underflow. Throws
          LBK_INTSN_E::LBK_INT_CHAN_UFLOW.

      - name: DAT_OFLOW
        bits: 3
        access: R/W1C/H
        reset: 0
        typical: 0
        description: |
          Internal assertion, packet Data FIFO had an overflow. Throws
          LBK_INTSN_E::LBK_INT_DAT_OFLOW.

      - name: DAT_UFLOW
        bits: 2
        access: R/W1C/H
        reset: 0
        typical: 0
        description: |
          Internal assertion, packet Data FIFO had an underflow. Throws
          LBK_INTSN_E::LBK_INT_DAT_UFLOW.

      - name: DAT_DBE
        bits: 1
        access: R/W1C/H
        reset: 0
        typical: 0
        description: |
          Data RAM had a ECC double bit error. Throws LBK_INTSN_E::LBK_INT_DAT_DBE.

      - name: DAT_SBE
        bits: 0
        access: R/W1C/H
        reset: 0
        typical: 0
        description: |
          Data RAM had a ECC single bit error. Throws LBK_INTSN_E::LBK_INT_DAT_SBE.


  - name: LBK_DAT_ERR_INFO
    title: Loopback Data RAM Error Information Register
    address: 0x1180012000050
    bus: RSL
    fields:
      - name: --
        bits: 63..58
        access: RAZ
        reset: --
        typical: --
        description: Reserved.

      - name: DBE_ECC_OUT
        bits: 57..49
        access: RO/H
        reset: --
        typical: --
        description: |
          ECC_OUT captured from memory. Data is captured and retained as long as LBK_INT[DAT_DBE] is
          asserted.

      - name: DBE_SYND
        bits: 48..40
        access: RO/H
        reset: --
        typical: --
        description: |
          Syndrome captured from memory. Data is captured and retained as long as LBK_INT[DAT_DBE]
          is asserted.

      - name: DBE_ADDR
        bits: 39..32
        access: RO/H
        reset: --
        typical: --
        description: |
          Address causing error in memory. Data is captured and retained as long as LBK_INT[DAT_DBE]
          is asserted.

      - name: --
        bits: 31..26
        access: RAZ
        reset: --
        typical: --
        description: Reserved.

      - name: SBE_ECC_OUT
        bits: 25..17
        access: RO/H
        reset: --
        typical: --
        description: |
          ECC_OUT captured from memory. Data is captured and retained as long as LBK_INT[DAT_SBE] is
          asserted.

      - name: SBE_SYND
        bits: 16..8
        access: RO/H
        reset: --
        typical: --
        description: |
          Syndrome captured from memory. Data is captured and retained as long as LBK_INT[DAT_SBE]
          is asserted.

      - name: SBE_ADDR
        bits: 7..0
        access: RO/H
        reset: --
        typical: --
        description: |
          Address causing error in memory. Data is captured and retained as long as LBK_INT[DAT_SBE]
          is asserted.


  - name: LBK_ECC_CFG
    title: Loopback ECC Configuration Register
    address: 0x1180012000060
    bus: RSL
    fields:
      - name: --
        bits: 63..3
        access: RAZ
        reset: --
        typical: --
        description: Reserved.

      - name: DAT_FLIP
        bits: 2..1
        access: R/W
        reset: 0x0
        typical: 0x0
        description: |
          Testing feature. Flip syndrome bits <1:0> on writes to the Data FIFO RAM to test single-
          bit or double-bit errors.

      - name: DAT_CDIS
        bits: 0
        access: R/W
        reset: 0
        typical: 0
        description: Disable ECC corrector on Data FIFO RAM outputs.


  - name: LBK_CH(0..63)_PKIND
    title: Loopback Channel to Port Kind Register
    address: 0x1180012000200 + a*0x8
    bus: RSL
    attributes:
      dv_fc_scratch: "a=(0)"
    fields:
      - name: --
        bits: 63..6
        access: RAZ
        reset: --
        typical: --
        description: Reserved.

      - name: PKIND
        bits: 5..0
        access: R/W
        reset: 0x0
        typical: 0x0
        description: Loopback pkind for the respective loopback channel.



