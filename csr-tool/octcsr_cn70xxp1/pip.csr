# -*- csr3 -*-
# You must run "csr3 rtl" after editing this file!
---
name: PIP
attributes:
  exempt_title_check: "True"
registers:
  - name: PIP_BIST_STATUS
    title: PIP's BIST Results
    address: 0x11800A0000000
    bus: RSL
    fields:
      - name: --
        bits: 63..20
        access: RAZ
        reset: --
        typical: --
        description: Reserved.

      - name: BIST
        bits: 19..0
        access: RO
        reset: 0x0
        typical: 0x0
        description: |
          BIST Results.
          HW sets a bit in BIST for for memory that fails
          BIST.


  - name: PIP_INT_REG
    title: PIP's Interrupt Register
    address: 0x11800A0000008
    bus: RSL
    description: |
      Any exception event that occurs is captured in the PIP_INT_REG.
      PIP_INT_REG will set the exception bit regardless of the value
      of PIP_INT_EN.  PIP_INT_EN only controls if an interrupt is
      raised to software.
    internal: |
      "* TODOOVR
      The PIP Todo list stores packets that have been received and require work
      queue entry generation.  PIP will normally assert backpressure when the
      list fills up such that any error is normally is result of a programming
      the PIP_BCK_PRS[HIWATER] incorrectly.  PIP itself can handle 29M
      packets/sec @500MHz or 15Gbs @ 64B packets.
      * SKPRUNT
      If a packet size is less then the amount programmed in the per port
      skippers, then there will be nothing to parse and the entire packet will
      basically be skipped over.  This is probably not what the user desired, so
      there is an indication to software.
      * BADTAG
      A tag is considered bad when it is resued by a new packet before it was
      released by PIP.  PIP considers a tag released by one of two methods.
      . QOS dropped so that it is released over the pip__ipd_release bus.
      . WorkQ entry is validated by the pip__ipd_done signal
      * PRTNXA
      If PIP receives a packet that is not in the valid port range, the port
      processed will be mapped into the valid port space (the mapping is
      currently unpredictable) and the PRTNXA bit will be set.  PRTNXA will be
      set for packets received under the following conditions:
      * packet ports (ports 0-31)
      GMX_INF_MODE[TYPE]==0 (SGMII), received port is 4-15 or 20-31
      GMX_INF_MODE[TYPE]==1 (XAUI),  received port is 1-15 or 17-31
      * upper ports (pci and loopback ports 32-63)
      received port is 40-47 or 52-63
      * BCKPRS
      PIP can assert backpressure to the receive logic when the todo list
      exceeds a high-water mark (see PIP_BCK_PRS for more details).  When this
      occurs, PIP can raise an interrupt to software.
      * CRCERR
      Octane can compute CRC in two places.  Each RGMII port will compute its
      own CRC, but PIP can provide an additional check or check loopback or
      PCI ports. If PIP computes a bad CRC, then PIP will raise an interrupt.
      * PKTDRP
      PIP can drop packets based on QOS results received from IPD.  If the QOS
      algorithm decides to drop a packet, PIP will assert an interrupt."
    fields:
      - name: --
        bits: 63..13
        access: RAZ
        reset: --
        typical: --
        description: Reserved.

      - name: PUNYERR
        bits: 12
        access: R/W1C/H
        reset: 0
        typical: 0
        description: |
          Frame was received with length <=4B when CRC
          stripping in IPD is enable

      - name: LENERR
        bits: 11
        access: R/W1C/H
        reset: 0
        typical: 0
        description: Frame was received with length error

      - name: MAXERR
        bits: 10
        access: R/W1C/H
        reset: 0
        typical: 0
        description: Frame was received with length > max_length

      - name: MINERR
        bits: 9
        access: R/W1C/H
        reset: 0
        typical: 0
        description: Frame was received with length < min_length

      - name: BEPERR
        bits: 8
        access: R/W1C/H
        reset: 0
        typical: 0
        description: Parity Error in back end memory

      - name: FEPERR
        bits: 7
        access: R/W1C/H
        reset: 0
        typical: 0
        description: Parity Error in front end memory

      - name: TODOOVR
        bits: 6
        access: R/W1C/H
        reset: 0
        typical: 0
        description: Todo list overflow (see PIP_BCK_PRS[HIWATER])

      - name: SKPRUNT
        bits: 5
        access: R/W1C/H
        reset: 0
        typical: 0
        description: |
          Packet was engulfed by skipper
          This interrupt can occur with received PARTIAL
          packets that are truncated to SKIP bytes or
          smaller.

      - name: BADTAG
        bits: 4
        access: R/W1C/H
        reset: 0
        typical: 0
        description: A bad tag was sent from IPD

      - name: PRTNXA
        bits: 3
        access: R/W1C/H
        reset: 0
        typical: 0
        description: Non-existent port

      - name: BCKPRS
        bits: 2
        access: R/W1C/H
        reset: 0
        typical: 0
        description: PIP asserted backpressure

      - name: CRCERR
        bits: 1
        access: R/W1C/H
        reset: 0
        typical: 0
        description: PIP calculated bad CRC

      - name: PKTDRP
        bits: 0
        access: R/W1C/H
        reset: 0
        typical: 0
        description: Packet Dropped due to QOS


  - name: PIP_INT_EN
    title: PIP's Interrupt Enable Register
    address: 0x11800A0000010
    bus: RSL
    description: |
      Determines if hardward should raise an interrupt to software
      when an exception event occurs.
    attributes:
      dv_fc_scratch: "ALL"
    fields:
      - name: --
        bits: 63..13
        access: RAZ
        reset: --
        typical: --
        description: Reserved.

      - name: PUNYERR
        bits: 12
        access: R/W
        reset: 0
        typical: 0
        description: |
          Frame was received with length <=4B when CRC
          stripping in IPD is enable

      - name: LENERR
        bits: 11
        access: R/W
        reset: 0
        typical: 0
        description: Frame was received with length error

      - name: MAXERR
        bits: 10
        access: R/W
        reset: 0
        typical: 0
        description: Frame was received with length > max_length

      - name: MINERR
        bits: 9
        access: R/W
        reset: 0
        typical: 0
        description: Frame was received with length < min_length

      - name: BEPERR
        bits: 8
        access: R/W
        reset: 0
        typical: 0
        description: Parity Error in back end memory

      - name: FEPERR
        bits: 7
        access: R/W
        reset: 0
        typical: 0
        description: Parity Error in front end memory

      - name: TODOOVR
        bits: 6
        access: R/W
        reset: 0
        typical: 0
        description: Todo list overflow (see PIP_BCK_PRS[HIWATER])

      - name: SKPRUNT
        bits: 5
        access: R/W
        reset: 0
        typical: 0
        description: Packet was engulfed by skipper

      - name: BADTAG
        bits: 4
        access: R/W
        reset: 0
        typical: 0
        description: A bad tag was sent from IPD

      - name: PRTNXA
        bits: 3
        access: R/W
        reset: 0
        typical: 0
        description: Non-existent port

      - name: BCKPRS
        bits: 2
        access: R/W
        reset: 0
        typical: 0
        description: PIP asserted backpressure

      - name: CRCERR
        bits: 1
        access: R/W
        reset: 0
        typical: 0
        description: PIP calculated bad CRC

      - name: PKTDRP
        bits: 0
        access: R/W
        reset: 0
        typical: 0
        description: Packet Dropped due to QOS


  - name: PIP_STAT_CTL
    title: PIP's Stat Control Register
    address: 0x11800A0000018
    bus: RSL
    description: Controls how the PIP statistics counters are handled.
    fields:
      - name: --
        bits: 63..1
        access: RAZ
        reset: --
        typical: --
        description: Reserved.

      - name: RDCLR
        bits: 0
        access: R/W
        reset: 1
        typical: 1
        description: |
          Stat registers are read and clear
          0 = stat registers hold value when read
          1 = stat registers are cleared when read


  - name: PIP_GBL_CTL
    title: PIP's Global Control Register
    address: 0x11800A0000020
    bus: RSL
    description: |
      Global control information.  These are the global checker enables for
      IPv4/IPv6 and TCP/UDP parsing.  The enables effect all ports.
    internal: |
      The following text describes the conditions in which each checker will
      assert and flag an exception.  By disabling the checker, the exception will
      not be flagged and the packet will be parsed as best it can.  Note, by
      disabling conditions, packets can be parsed incorrectly (.i.e. IP_MAL and
      L4_MAL could cause bits to be seen in the wrong place.  IP_CHK and L4_CHK
      means that the packet was corrupted).
      * IP_CHK
      Indicates that an IPv4 packet contained an IPv4 header checksum
      violations.  Only applies to packets classified as IPv4.
      * IP_MAL
      Indicates that the packet was malformed.  Malformed packets are defined as
      packets that are not long enough to cover the IP header or not long enough
      to cover the length in the IP header.
      * IP_HOP
      Indicates that the IPv4 TTL field or IPv6 HOP field is zero.
      * IP4_OPTS
      Indicates the presence of IPv4 options.  It is set when the length != 5.
      This only applies to packets classified as IPv4.
      * IP6_EEXT
      Indicate the presence of IPv6 early extension headers.  These bits only
      apply to packets classified as IPv6.  Bit 0 will flag early extensions
      when next_header is any one of the following...
      hop-by-hop (0)
      destination (60)
      routing (43)
      Bit 1 will flag early extentions when next_header is NOT any of the
      following...
      TCP (6)
      UDP (17)
      fragmentation (44)
      ICMP (58)
      IPSEC ESP (50)
      IPSEC AH (51)
      IPCOMP
      * L4_MAL
      Indicates that a TCP or UDP packet is not long enough to cover the TCP or
      UDP header.
      * L4_PRT
      Indicates that a TCP or UDP packet has an illegal port number either the
      source or destination port is zero.
      * L4_CHK
      Indicates that a packet classified as either TCP or UDP contains an L4
      checksum failure
      * L4_LEN
      Indicates that the TCP or UDP length does not match the the IP length.
      * TCP_FLAG
      Indicates any of the following conditions...
      {URG, ACK, PSH, RST, SYN, FIN} : tcp_flag
      6'b000001: (FIN only)
      6'b000000: (0)
      6'bxxx1x1: (RST+FIN+*)
      6'b1xxx1x: (URG+SYN+*)
      6'bxxx11x: (RST+SYN+*)
      6'bxxxx11: (SYN+FIN+*)
    fields:
      - name: --
        bits: 63..28
        access: RAZ
        reset: --
        typical: --
        description: Reserved.

      - name: IHMSK_DIS
        bits: 27
        access: R/W
        reset: 0
        typical: 0
        description: |
          Instruction Header Mask Disable
          0=Allow NTAG,NTT,NGRP,NQOS bits in the
          instruction header to control which fields from
          the instruction header are used for WQE WORD2.
          1=Ignore the NTAG,NTT,NGRP,NQOS bits in the
          instruction header and act as if these fields
          were zero.  Thus always use the TAG,TT,GRP,QOS
          (depending on the instruction header length)
          from the instruction header for the WQE WORD2.

      - name: DSA_GRP_TVID
        bits: 26
        access: R/W
        reset: 0
        typical: 0
        description: |
          DSA Group Algorithm
          Use the DSA source id to compute GRP

      - name: DSA_GRP_SCMD
        bits: 25
        access: R/W
        reset: 0
        typical: 0
        description: |
          DSA Group Algorithm
          Use the DSA source id to compute GRP when the
          DSA tag command to TO_CPU

      - name: DSA_GRP_SID
        bits: 24
        access: R/W
        reset: 0
        typical: 0
        description: |
          DSA Group Algorithm
          Use the DSA VLAN id to compute GRP

      - name: --
        bits: 23..21
        access: RAZ
        reset: --
        typical: --
        description: Reserved.

      - name: RING_EN
        bits: 20
        access: R/W
        reset: 0
        typical: 1
        description: Enable DPI ring information in WQE

      - name: SPARE
        bits: 19..17
        access: R/W
        reset: 0x0
        typical: 0x0
        description: Spare Bits

      - name: IGNRS
        bits: 16
        access: R/W
        reset: 0
        typical: 0
        description: |
          Ignore the PKT_INST_HDR[RS] bit when set
          Does not apply to DPI ports (32-35)
          When using 2-byte instruction header words,
          either PIP_PRT_CFG[DYN_RS] or IGNRS should be set

      - name: VS_WQE
        bits: 15
        access: R/W
        reset: 0
        typical: 0
        description: |
          Which DSA/VLAN CFI/ID to use when VLAN Stacking
          0=use the 1st (network order) VLAN
          1=use the 2nd (network order) VLAN

      - name: VS_QOS
        bits: 14
        access: R/W
        reset: 0
        typical: 0
        description: |
          Which DSA/VLAN priority to use when VLAN Stacking
          0=use the 1st (network order) VLAN
          1=use the 2nd (network order) VLAN

      - name: L2_MAL
        bits: 13
        access: R/W
        reset: 1
        typical: 1
        description: Enable L2 malformed packet check

      - name: TCP_FLAG
        bits: 12
        access: R/W
        reset: 1
        typical: 1
        description: Enable TCP flags checks

      - name: L4_LEN
        bits: 11
        access: R/W
        reset: 1
        typical: 1
        description: Enable TCP/UDP length check

      - name: L4_CHK
        bits: 10
        access: R/W
        reset: 1
        typical: 1
        description: Enable TCP/UDP checksum check

      - name: L4_PRT
        bits: 9
        access: R/W
        reset: 1
        typical: 1
        description: Enable TCP/UDP illegal port check

      - name: L4_MAL
        bits: 8
        access: R/W
        reset: 1
        typical: 1
        description: Enable TCP/UDP malformed packet check

      - name: --
        bits: 7..6
        access: RAZ
        reset: --
        typical: --
        description: Reserved.

      - name: IP6_EEXT
        bits: 5..4
        access: R/W
        reset: 0x1
        typical: 0x3
        description: Enable IPv6 early extension headers

      - name: IP4_OPTS
        bits: 3
        access: R/W
        reset: 1
        typical: 1
        description: Enable IPv4 options check

      - name: IP_HOP
        bits: 2
        access: R/W
        reset: 1
        typical: 1
        description: Enable TTL (IPv4) / hop (IPv6) check

      - name: IP_MAL
        bits: 1
        access: R/W
        reset: 1
        typical: 1
        description: Enable malformed check

      - name: IP_CHK
        bits: 0
        access: R/W
        reset: 1
        typical: 1
        description: Enable IPv4 header checksum check


  - name: PIP_GBL_CFG
    title: PIP's Global Config Register
    address: 0x11800A0000028
    bus: RSL
    description: Global config information that applies to all ports.
    internal: |
      "* IP6_UDP
      IPv4 allows optional UDP checksum by sending the all 0's patterns.  IPv6
      outlaws this and the spec says to always check UDP checksum.  This mode
      bit allows the user to treat IPv6 as IPv4, meaning that the all 0's
      pattern will cause a UDP checksum pass."
    fields:
      - name: --
        bits: 63..19
        access: RAZ
        reset: --
        typical: --
        description: Reserved.

      - name: TAG_SYN
        bits: 18
        access: R/W
        reset: 0
        typical: 0
        description: |
          Do not include src_crc for TCP/SYN&!ACK packets
          0 = include src_crc
          1 = tag hash is dst_crc for TCP/SYN&!ACK packets

      - name: IP6_UDP
        bits: 17
        access: R/W
        reset: 1
        typical: 1
        description: |
          IPv6/UDP checksum is not optional
          0 = Allow optional checksum code
          1 = Do not allow optional checksum code

      - name: MAX_L2
        bits: 16
        access: R/W
        reset: 0
        typical: 0
        description: |
          Config bit to choose the largest L2 frame size
          Chooses the value of the L2 Type/Length field
          to classify the frame as length.
          0 = 1500 / 0x5dc
          1 = 1535 / 0x5ff

      - name: --
        bits: 15..11
        access: RAZ
        reset: --
        typical: --
        description: Reserved.

      - name: RAW_SHF
        bits: 10..8
        access: R/W
        reset: 0x0
        typical: 0x0
        description: |
          RAW Packet shift amount
          Number of bytes to pad a RAW packet.

      - name: --
        bits: 7..3
        access: RAZ
        reset: --
        typical: --
        description: Reserved.

      - name: NIP_SHF
        bits: 2..0
        access: R/W
        reset: 0x0
        typical: 0x0
        description: |
          Non-IP shift amount
          Number of bytes to pad a packet that has been
          classified as not IP.


  - name: PIP_SFT_RST
    title: PIP Soft Reset
    address: 0x11800A0000030
    bus: RSL
    description: When written to a '1', resets the pip block
    internal: |
      When RST is set to a '1' by SW, PIP will get a short reset pulse (3 cycles
      in duration).  Although this will reset much of PIP's internal state, some
      CSRs will not reset.
      . PIP_BIST_STATUS
      . PIP_STAT0_PRT*
      . PIP_STAT1_PRT*
      . PIP_STAT2_PRT*
      . PIP_STAT3_PRT*
      . PIP_STAT4_PRT*
      . PIP_STAT5_PRT*
      . PIP_STAT6_PRT*
      . PIP_STAT7_PRT*
      . PIP_STAT8_PRT*
      . PIP_STAT9_PRT*
      . PIP_XSTAT0_PRT*
      . PIP_XSTAT1_PRT*
      . PIP_XSTAT2_PRT*
      . PIP_XSTAT3_PRT*
      . PIP_XSTAT4_PRT*
      . PIP_XSTAT5_PRT*
      . PIP_XSTAT6_PRT*
      . PIP_XSTAT7_PRT*
      . PIP_XSTAT8_PRT*
      . PIP_XSTAT9_PRT*
      . PIP_STAT_INB_PKTS*
      . PIP_STAT_INB_OCTS*
      . PIP_STAT_INB_ERRS*
      . PIP_TAG_INC*
    fields:
      - name: --
        bits: 63..1
        access: RAZ
        reset: --
        typical: --
        description: Reserved.

      - name: RST
        bits: 0
        access: R/W
        reset: 0
        typical: 0
        description: Soft Reset


  - name: PIP_BCK_PRS
    title: PIP's Back Pressure Register
    address: 0x11800A0000038
    bus: RSL
    description: When to assert backpressure based on the todo list filling up
    fields:
      - name: BCKPRS
        bits: 63
        access: RO/H
        reset: 0
        typical: 0
        description: |
          PIP is currently asserting backpressure to IOB
          Backpressure from PIP will assert when the
          entries to the todo list exceed HIWATER.
          Backpressure will be held until the todo entries
          is less than or equal to LOWATER.

      - name: --
        bits: 62..13
        access: RAZ
        reset: 0x0
        typical: --
        description: Reserved.

      - name: HIWATER
        bits: 12..8
        access: R/W
        reset: 0x18
        typical: 0x18
        description: |
          Water mark in the todo list to assert backpressure
          Legal values are 1-26.  A 0 value will deadlock
          the machine.  A value > 26, will trash memory

      - name: --
        bits: 7..5
        access: RAZ
        reset: 0x0
        typical: --
        description: Reserved.

      - name: LOWATER
        bits: 4..0
        access: R/W
        reset: 0x4
        typical: 0x4
        description: |
          Water mark in the todo list to release backpressure
          The LOWATER value should be < HIWATER.


  - name: PIP_CLKEN
    address: 0x11800A0000040
    bus: RSL
    fields:
      - name: --
        bits: 63..1
        access: RAZ
        reset: 0x0
        typical: --
        description: Reserved.

      - name: CLKEN
        bits: 0
        access: R/W
        reset: 0
        typical: 0
        description: |
          Controls the conditional clocking within PIP
          0=Allow HW to control the clocks
          1=Force the clocks to be always on


  - name: PIP_IP_OFFSET
    title: Location of the IP in the workQ entry
    address: 0x11800A0000060
    bus: RSL
    description: An 8-byte offset to find the start of the IP header in the data portion of IP workQ entires
    internal: |
      In normal configurations, OFFSET must be set in the 0..4 range to allow the
      entire IP and TCP/UDP headers to be buffered in HW and calculate the L4
      checksum for TCP/UDP packets.
      The MAX value of OFFSET is determined by the the types of packets that can
      be sent to PIP as follows...
      Packet Type                 MAX OFFSET
      IPv4/TCP/UDP                 7
      IPv6/TCP/UDP                 5
      IPv6/without L4 parsing  6
      If the L4 can be ignored, then the MAX OFFSET for IPv6 packets can increase
      to 6.  Here are the following programming restrictions for IPv6 packets and
      OFFSET==6:
      . PIP_GBL_CTL[TCP_FLAG] == 0
      . PIP_GBL_CTL[L4_LEN]   == 0
      . PIP_GBL_CTL[L4_CHK]   == 0
      . PIP_GBL_CTL[L4_PRT]   == 0
      . PIP_GBL_CTL[L4_MAL]   == 0
      . PIP_DEC_IPSEC[TCP]    == 0
      . PIP_DEC_IPSEC[UDP]    == 0
      . PIP_PRT_TAG[IP6_DPRT] == 0
      . PIP_PRT_TAG[IP6_SPRT] == 0
      . PIP_PRT_TAG[TCP6_TAG] == 0
      . PIP_GBL_CFG[TAG_SYN]  == 0
    fields:
      - name: --
        bits: 63..3
        access: RAZ
        reset: --
        typical: --
        description: Reserved.

      - name: OFFSET
        bits: 2..0
        access: R/W
        reset: 0x0
        typical: 0x0
        description: |
          Number of 8B ticks to include in workQ entry
          prior to IP data
          0:  0 Bytes / IP start at WORD4 of workQ entry
          1:  8 Bytes / IP start at WORD5 of workQ entry
          2: 16 Bytes / IP start at WORD6 of workQ entry
          3: 24 Bytes / IP start at WORD7 of workQ entry
          4: 32 Bytes / IP start at WORD8 of workQ entry
          5: 40 Bytes / IP start at WORD9 of workQ entry
          6: 48 Bytes / IP start at WORD10 of workQ entry
          7: 56 Bytes / IP start at WORD11 of workQ entry


  - name: PIP_TAG_SECRET
    title: Initial value in tag generation
    address: 0x11800A0000068
    bus: RSL
    description: The source and destination IV's provide a mechanism for each Octeon to be unique.
    fields:
      - name: --
        bits: 63..32
        access: RAZ
        reset: --
        typical: --
        description: Reserved.

      - name: DST
        bits: 31..16
        access: R/W
        reset: 0x0
        typical: 0x0
        description: Secret for the destination tuple tag CRC calc

      - name: SRC
        bits: 15..0
        access: R/W
        reset: 0x0
        typical: 0x0
        description: Secret for the source tuple tag CRC calc


  - name: PIP_TAG_MASK
    title: Mask bit in the tag generation
    address: 0x11800A0000070
    bus: RSL
    fields:
      - name: --
        bits: 63..16
        access: RAZ
        reset: --
        typical: --
        description: Reserved.

      - name: MASK
        bits: 15..0
        access: R/W
        reset: 0x0
        typical: 0x0
        description: |
          When set, MASK clears individual bits of lower 16
          bits of the computed tag.  Does not effect RAW
          or INSTR HDR packets.


  - name: PIP_TODO_ENTRY
    title: Head entry of the Todo list (debug only)
    address: 0x11800A0000078
    bus: RSL
    description: Summary of the current packet that has completed and waiting to be processed
    fields:
      - name: VAL
        bits: 63
        access: RO/H
        reset: --
        typical: --
        description: Entry is valid

      - name: --
        bits: 62
        access: RAZ
        reset: --
        typical: --
        description: Reserved.

      - name: ENTRY
        bits: 61..0
        access: RO/H
        reset: --
        typical: --
        description: Todo list entry summary


  - name: PIP_DEC_IPSEC(0..3)
    title: UDP or TCP ports to watch for DEC IPSEC
    address: 0x11800A0000080 + a*0x8
    bus: RSL
    description: PIP sets the dec_ipsec based on TCP or UDP destination port.
    fields:
      - name: --
        bits: 63..18
        access: RAZ
        reset: --
        typical: --
        description: Reserved.

      - name: TCP
        bits: 17
        access: R/W
        reset: 0
        typical: 0
        description: This DPRT should be used for TCP packets

      - name: UDP
        bits: 16
        access: R/W
        reset: 0
        typical: 0
        description: This DPRT should be used for UDP packets

      - name: DPRT
        bits: 15..0
        access: R/W
        reset: 0x0
        typical: 0x0
        description: UDP or TCP destination port to match on


  - name: PIP_RAW_WORD
    title: The RAW Word2 of the workQ entry.
    address: 0x11800A00000B0
    bus: RSL
    description: The RAW Word2 to be inserted into the workQ entry of RAWFULL packets.
    fields:
      - name: --
        bits: 63..56
        access: RAZ
        reset: --
        typical: --
        description: Reserved.

      - name: WORD
        bits: 55..0
        access: R/W
        reset: 0x0
        typical: 0x0
        description: |
          Word2 of the workQ entry
          The 8-bit bufs field is still set by HW (IPD)


  - name: PIP_QOS_VLAN(0..7)
    address: 0x11800A00000C0 + a*0x8
    bus: RSL
    description: |
      If the PIP indentifies a packet is DSA/VLAN tagged, then the QOS
      can be set based on the DSA/VLAN user priority.  These eight register
      comprise the QOS values for all DSA/VLAN user priority values.
    fields:
      - name: --
        bits: 63..7
        access: RAZ
        reset: --
        typical: --
        description: Reserved.

      - name: QOS1
        bits: 6..4
        access: R/W
        reset: 0x0
        typical: 0x0
        description: |
          DSA/VLAN QOS level
          Selected when PIP_PRT_CFGx[QOS_VSEL] = 1

      - name: --
        bits: 3
        access: RAZ
        reset: --
        typical: --
        description: Reserved.

      - name: QOS
        bits: 2..0
        access: R/W
        reset: 0x0
        typical: 0x0
        description: |
          DSA/VLAN QOS level
          Selected when PIP_PRT_CFGx[QOS_VSEL] = 0


  - name: PIP_QOS_WATCH(0..7)
    address: 0x11800A0000100 + a*0x8
    bus: RSL
    description: |
      Sets up the Configuration CSRs for the four QOS Watchers.
      Each Watcher can be set to look for a specific protocol,
      TCP/UDP destination port, or Ethertype to override the
      default QOS value.
    fields:
      - name: --
        bits: 63..48
        access: RAZ
        reset: --
        typical: --
        description: Reserved.

      - name: MASK
        bits: 47..32
        access: R/W
        reset: 0x0
        typical: 0x0
        description: Mask off a range of values

      - name: --
        bits: 31..28
        access: RAZ
        reset: --
        typical: --
        description: Reserved.

      - name: GRP
        bits: 27..24
        access: R/W
        reset: 0x0
        typical: 0x0
        description: The GRP number of the watcher

      - name: --
        bits: 23
        access: RAZ
        reset: --
        typical: --
        description: Reserved.

      - name: WATCHER
        bits: 22..20
        access: R/W
        reset: 0x0
        typical: 0x0
        description: The QOS level of the watcher

      - name: --
        bits: 19
        access: RAZ
        reset: --
        typical: --
        description: Reserved.

      - name: TYP
        bits: 18..16
        access: R/W
        reset: 0x0
        typical: 0x0
        description: |
          The field for the watcher match against
          0   = disable across all ports
          1   = protocol (ipv4)
          = next_header (ipv6)
          2   = TCP destination port
          3   = UDP destination port
          4   = Ether type
          5-7 = Reserved

      - name: MATCH
        bits: 15..0
        access: R/W
        reset: 0x0
        typical: 0x0
        description: The value to watch for


  - name: PIP_FRM_LEN_CHK(0..0)
    address: 0x11800A0000180 + a*0x8
    bus: RSL
    fields:
      - name: --
        bits: 63..32
        access: RAZ
        reset: --
        typical: --
        description: Reserved.

      - name: MAXLEN
        bits: 31..16
        access: R/W
        reset: 0x600
        typical: 0x600
        description: |
          Byte count for Max-sized frame check
          PIP_PRT_CFGn[MAXERR_EN] enables the check for
          port n.
          If enabled, failing packets set the MAXERR
          interrupt and work-queue entry WORD2[opcode] is
          set to OVER_FCS (0x3, if packet has bad FCS) or
          OVER_ERR (0x4, if packet has good FCS).
          The effective MAXLEN used by HW is
          PIP_PRT_CFG[DSA_EN] == 0,
          PIP_FRM_LEN_CHK[MAXLEN] + 4*VV + 4*VS
          PIP_PRT_CFG[DSA_EN] == 1,
          PIP_FRM_LEN_CHK[MAXLEN] + PIP_PRT_CFG[SKIP]+4*VS
          If PTP_MODE, the 8B timestamp is prepended to the
          packet.  MAXLEN should be increased by 8 to
          compensate for the additional timestamp field.

      - name: MINLEN
        bits: 15..0
        access: R/W
        reset: 0x40
        typical: 0x40
        description: |
          Byte count for Min-sized frame check
          PIP_PRT_CFGn[MINERR_EN] enables the check for
          port n.
          If enabled, failing packets set the MINERR
          interrupt and work-queue entry WORD2[opcode] is
          set to UNDER_FCS (0x6, if packet has bad FCS) or
          UNDER_ERR (0x8, if packet has good FCS).
          If PTP_MODE, the 8B timestamp is prepended to the
          packet.  MINLEN should be increased by 8 to
          compensate for the additional timestamp field.


  - name: PIP_DSA_SRC_GRP
    address: 0x11800A0000190
    bus: RSL
    fields:
      - name: MAP15
        bits: 63..60
        access: R/W
        reset: 0x0
        typical: 0x0
        description: DSA Group Algorithm

      - name: MAP14
        bits: 59..56
        access: R/W
        reset: 0x0
        typical: 0x0
        description: DSA Group Algorithm

      - name: MAP13
        bits: 55..52
        access: R/W
        reset: 0x0
        typical: 0x0
        description: DSA Group Algorithm

      - name: MAP12
        bits: 51..48
        access: R/W
        reset: 0x0
        typical: 0x0
        description: DSA Group Algorithm

      - name: MAP11
        bits: 47..44
        access: R/W
        reset: 0x0
        typical: 0x0
        description: DSA Group Algorithm

      - name: MAP10
        bits: 43..40
        access: R/W
        reset: 0x0
        typical: 0x0
        description: DSA Group Algorithm

      - name: MAP9
        bits: 39..36
        access: R/W
        reset: 0x0
        typical: 0x0
        description: DSA Group Algorithm

      - name: MAP8
        bits: 35..32
        access: R/W
        reset: 0x0
        typical: 0x0
        description: DSA Group Algorithm

      - name: MAP7
        bits: 31..28
        access: R/W
        reset: 0x0
        typical: 0x0
        description: DSA Group Algorithm

      - name: MAP6
        bits: 27..24
        access: R/W
        reset: 0x0
        typical: 0x0
        description: DSA Group Algorithm

      - name: MAP5
        bits: 23..20
        access: R/W
        reset: 0x0
        typical: 0x0
        description: DSA Group Algorithm

      - name: MAP4
        bits: 19..16
        access: R/W
        reset: 0x0
        typical: 0x0
        description: DSA Group Algorithm

      - name: MAP3
        bits: 15..12
        access: R/W
        reset: 0x0
        typical: 0x0
        description: DSA Group Algorithm

      - name: MAP2
        bits: 11..8
        access: R/W
        reset: 0x0
        typical: 0x0
        description: DSA Group Algorithm

      - name: MAP1
        bits: 7..4
        access: R/W
        reset: 0x0
        typical: 0x0
        description: DSA Group Algorithm

      - name: MAP0
        bits: 3..0
        access: R/W
        reset: 0x0
        typical: 0x0
        description: |
          DSA Group Algorithm
          Use the DSA source id to compute GRP


  - name: PIP_DSA_VID_GRP
    address: 0x11800A0000198
    bus: RSL
    fields:
      - name: MAP15
        bits: 63..60
        access: R/W
        reset: 0x0
        typical: 0x0
        description: DSA Group Algorithm

      - name: MAP14
        bits: 59..56
        access: R/W
        reset: 0x0
        typical: 0x0
        description: DSA Group Algorithm

      - name: MAP13
        bits: 55..52
        access: R/W
        reset: 0x0
        typical: 0x0
        description: DSA Group Algorithm

      - name: MAP12
        bits: 51..48
        access: R/W
        reset: 0x0
        typical: 0x0
        description: DSA Group Algorithm

      - name: MAP11
        bits: 47..44
        access: R/W
        reset: 0x0
        typical: 0x0
        description: DSA Group Algorithm

      - name: MAP10
        bits: 43..40
        access: R/W
        reset: 0x0
        typical: 0x0
        description: DSA Group Algorithm

      - name: MAP9
        bits: 39..36
        access: R/W
        reset: 0x0
        typical: 0x0
        description: DSA Group Algorithm

      - name: MAP8
        bits: 35..32
        access: R/W
        reset: 0x0
        typical: 0x0
        description: DSA Group Algorithm

      - name: MAP7
        bits: 31..28
        access: R/W
        reset: 0x0
        typical: 0x0
        description: DSA Group Algorithm

      - name: MAP6
        bits: 27..24
        access: R/W
        reset: 0x0
        typical: 0x0
        description: DSA Group Algorithm

      - name: MAP5
        bits: 23..20
        access: R/W
        reset: 0x0
        typical: 0x0
        description: DSA Group Algorithm

      - name: MAP4
        bits: 19..16
        access: R/W
        reset: 0x0
        typical: 0x0
        description: DSA Group Algorithm

      - name: MAP3
        bits: 15..12
        access: R/W
        reset: 0x0
        typical: 0x0
        description: DSA Group Algorithm

      - name: MAP2
        bits: 11..8
        access: R/W
        reset: 0x0
        typical: 0x0
        description: DSA Group Algorithm

      - name: MAP1
        bits: 7..4
        access: R/W
        reset: 0x0
        typical: 0x0
        description: DSA Group Algorithm

      - name: MAP0
        bits: 3..0
        access: R/W
        reset: 0x0
        typical: 0x0
        description: |
          DSA Group Algorithm
          Use the DSA source id to compute GRP


  - name: PIP_HG_PRI_QOS
    address: 0x11800A00001A0
    bus: RSL
    fields:
      - name: --
        bits: 63..13
        access: RAZ
        reset: --
        typical: --
        description: Reserved.

      - name: UP_QOS
        bits: 12
        access: RAZ
        reset: 0
        typical: --
        description: |
          When written to '1', updates the entry in the
          HG_QOS_TABLE as specified by PRI to a value of
          QOS as follows
          HG_QOS_TABLE[PRI] = QOS

      - name: --
        bits: 11
        access: RAZ
        reset: --
        typical: --
        description: Reserved.

      - name: QOS
        bits: 10..8
        access: R/W/H
        reset: 0x0
        typical: --
        description: QOS Map level to priority

      - name: --
        bits: 7..6
        access: RAZ
        reset: --
        typical: --
        description: Reserved.

      - name: PRI
        bits: 5..0
        access: R/W
        reset: 0x0
        typical: --
        description: |
          The priority level from HiGig header
          HiGig/HiGig+ PRI = {1'b0, CNG[1:0], COS[2:0]}
          HiGig2       PRI = {DP[1:0], TC[3:0]}


  - name: PIP_VLAN_ETYPES(0..1)
    address: 0x11800A00001C0 + a*0x8
    bus: RSL
    fields:
      - name: TYPE3
        bits: 63..48
        access: R/W
        reset: 0x8100
        typical: 0x8100
        description: VLAN Ethertype

      - name: TYPE2
        bits: 47..32
        access: R/W
        reset: 0x8100
        typical: 0x8100
        description: VLAN Ethertype

      - name: TYPE1
        bits: 31..16
        access: R/W
        reset: 0x8100
        typical: 0x8100
        description: VLAN Ethertype

      - name: TYPE0
        bits: 15..0
        access: R/W
        reset: 0x8100
        typical: 0x8100
        description: |
          VLAN Ethertype
          Specifies ethertypes that will be parsed as
          containing VLAN information. Each TYPE is
          orthagonal; if all eight are not required, set
          multiple TYPEs to the same value (as in the
          0x8100 default value).


  - name: PIP_PRT_CFG(0..3,16..19,24,32..35,36..39)
    address: 0x11800A0000200 + a*0x8
    bus: RSL
    fields:
      - name: --
        bits: 63..56
        access: RAZ
        reset: --
        typical: --
        description: Reserved.

      - name: --
        bits: 55
        access: RAZ
        reset: --
        typical: --
        description: Reserved.

      - name: --
        bits: 54..53
        access: RAZ
        reset: --
        typical: --
        description: Reserved.

      - name: PAD_LEN
        bits: 52
        access: R/W
        reset: 0
        typical: 0
        description: |
          When set, disables the length check for pkts with
          padding in the client data

      - name: VLAN_LEN
        bits: 51
        access: R/W
        reset: 0
        typical: 0
        description: |
          When set, disables the length check for DSA/VLAN
          pkts

      - name: LENERR_EN
        bits: 50
        access: R/W
        reset: 1
        typical: 1
        description: |
          L2 length error check enable
          Frame was received with length error
          Typically, this check will not be enabled for
          incoming packets on the DPI ports
          because the CRC bytes may not normally be
          present.

      - name: MAXERR_EN
        bits: 49
        access: R/W
        reset: 1
        typical: 1
        description: |
          Max frame error check enable
          Frame was received with length > max_length
          max_length is defined by PIP_FRM_LEN_CHK[MAXLEN]

      - name: MINERR_EN
        bits: 48
        access: R/W
        reset: 1
        typical: 1
        description: |
          Min frame error check enable
          Frame was received with length < min_length
          Typically, this check will not be enabled for
          incoming packets on the DPI ports
          because the CRC bytes may not normally be
          present.
          min_length is defined by PIP_FRM_LEN_CHK[MINLEN]

      - name: GRP_WAT_47
        bits: 47..44
        access: R/W
        reset: 0x0
        typical: 0x0
        description: |
          GRP Watcher enable
          (Watchers 4-7)

      - name: QOS_WAT_47
        bits: 43..40
        access: R/W
        reset: 0x0
        typical: 0x0
        description: |
          QOS Watcher enable
          (Watchers 4-7)

      - name: --
        bits: 39..37
        access: RAZ
        reset: --
        typical: --
        description: Reserved.

      - name: RAWDRP
        bits: 36
        access: R/W
        reset: 0
        typical: 0
        description: |
          Allow the IPD to RED drop a packet.
          Normally, IPD will never drop a packet that PIP
          indicates is RAW.
          0=never drop RAW packets based on RED algorithm
          1=allow RAW packet drops based on RED algorithm

      - name: TAG_INC
        bits: 35..34
        access: R/W
        reset: 0x0
        typical: 0x0
        description: |
          Which of the 4 PIP_TAG_INC to use when
          calculating mask tag hash

      - name: DYN_RS
        bits: 33
        access: R/W
        reset: 0
        typical: 0
        description: |
          Dynamically calculate RS based on pkt size and
          configuration.  If DYN_RS is set then
          PKT_INST_HDR[RS] is not used.  When using 2-byte
          instruction header words, either DYN_RS or
          PIP_GBL_CTL[IGNRS] should be set.

      - name: INST_HDR
        bits: 32
        access: R/W
        reset: 0
        typical: 0
        description: |
          8-byte INST_HDR is present on all packets
          Internally set for RAWFULL/RAWSCHED packets
          on the DPI ports (32-35).
          Internally cleared for all other packets on the
          DPI ports (32-35).
          Must be zero in DSA mode

      - name: GRP_WAT
        bits: 31..28
        access: R/W
        reset: 0x0
        typical: 0x0
        description: GRP Watcher enable

      - name: HG_QOS
        bits: 27
        access: R/W
        reset: 0
        typical: 0
        description: |
          When set, uses the HiGig priority bits as a
          lookup into the HG_QOS_TABLE (PIP_HG_PRI_QOS)
          to determine the QOS value
          HG_QOS must not be set when HIGIG_EN=0

      - name: QOS
        bits: 26..24
        access: R/W
        reset: 0x0
        typical: 0x0
        description: Default QOS level of the port

      - name: QOS_WAT
        bits: 23..20
        access: R/W
        reset: 0x0
        typical: 0x0
        description: |
          QOS Watcher enable
          (Watchers 0-3)

      - name: QOS_VSEL
        bits: 19
        access: R/W
        reset: 0
        typical: 0
        description: |
          Which QOS in PIP_QOS_VLAN to use
          0 = PIP_QOS_VLAN[QOS]
          1 = PIP_QOS_VLAN[QOS1]

      - name: QOS_VOD
        bits: 18
        access: R/W
        reset: 0
        typical: 0
        description: |
          QOS VLAN over Diffserv
          if DSA/VLAN exists, it is used
          else if IP exists, Diffserv is used
          else the per port default is used
          Watchers are still highest priority

      - name: QOS_DIFF
        bits: 17
        access: R/W
        reset: 0
        typical: 0
        description: QOS Diffserv

      - name: QOS_VLAN
        bits: 16
        access: R/W
        reset: 0
        typical: 0
        description: QOS VLAN

      - name: --
        bits: 15..13
        access: RAZ
        reset: --
        typical: --
        description: Reserved.

      - name: CRC_EN
        bits: 12
        access: RO
        reset: 0
        typical: 0
        description: CRC Checking enabled

      - name: HIGIG_EN
        bits: 11
        access: R/W
        reset: 0
        typical: 0
        description: |
          Enable HiGig parsing
          Should not be set for DPI ports (ports 32-35)
          Should not be set for ports in which PTP_MODE=1
          When HIGIG_EN=1:
          DSA_EN field below must be zero
          PIP_PRT_CFGB[ALT_SKP_EN] must be zero.
          SKIP field below is both Skip I size and the
          size of the HiGig* header (12 or 16 bytes)

      - name: DSA_EN
        bits: 10
        access: R/W
        reset: 0
        typical: 0
        description: |
          Enable DSA tag parsing
          Should not be set for ports in which PTP_MODE=1
          When DSA_EN=1:
          HIGIG_EN field above must be zero
          SKIP field below is size of DSA tag (4, 8, or
          12 bytes) rather than the size of Skip I
          total SKIP (Skip I + header + Skip II
          must be zero
          INST_HDR field above must be zero (non-DPI
          ports)
          PIP_PRT_CFGB[ALT_SKP_EN] must be zero.
          For DPI ports, SLI_PKT*_INSTR_HEADER[USE_IHDR]
          and DPI_INST_HDR[R] should be clear
          MODE field below must be "skip to L2"

      - name: MODE
        bits: 9..8
        access: R/W
        reset: 0x0
        typical: 0x0
        description: |
          Parse Mode
          0 = no packet inspection (Uninterpreted)
          1 = L2 parsing / skip to L2
          2 = IP parsing / skip to L3
          3 = (illegal)
          Must be 2 ("skip to L2") when in DSA mode.

      - name: --
        bits: 7
        access: RAZ
        reset: --
        typical: --
        description: Reserved.

      - name: SKIP
        bits: 6..0
        access: R/W
        reset: 0x0
        typical: 0x0
        description: |
          Optional Skip I amount for packets.
          HW forces the SKIP to zero for packets on DPI
          ports (32-35) when a PKT_INST_HDR is present.
          See PIP_PRT_CFGB[ALT_SKP*] and PIP_ALT_SKIP_CFG.
          See HRM sections "Parse Mode and Skip Length
          Selection" and "Legal Skip Values"
          for further details.
          In DSA mode, indicates the DSA header length, not
          Skip I size. (Must be 4,8,or 12)
          In HIGIG mode, indicates both the Skip I size and
          the HiGig header size (Must be 12 or 16).
          If PTP_MODE, the 8B timestamp is prepended to the
          packet.  SKIP should be increased by 8 to
          compensate for the additional timestamp field.


  - name: PIP_PRT_TAG(0..3,16..19,24,32..35,36..39)
    address: 0x11800A0000400 + a*0x8
    bus: RSL
    fields:
      - name: --
        bits: 63..40
        access: RAZ
        reset: --
        typical: --
        description: Reserved.

      - name: GRPTAGBASE
        bits: 39..36
        access: R/W
        reset: 0x0
        typical: 0x0
        description: |
          Offset to use when computing group from tag bits
          when GRPTAG is set.

      - name: GRPTAGMASK
        bits: 35..32
        access: R/W
        reset: 0x0
        typical: 0x0
        description: |
          Which bits of the tag to exclude when computing
          group when GRPTAG is set.

      - name: GRPTAG
        bits: 31
        access: R/W
        reset: 0
        typical: 0
        description: |
          When set, use the lower bit of the tag to compute
          the group in the work queue entry
          GRP = WQE[TAG[3:0]] & ~GRPTAGMASK + GRPTAGBASE

      - name: GRPTAG_MSKIP
        bits: 30
        access: R/W
        reset: 0
        typical: 0
        description: |
          When set, GRPTAG will be used regardless if the
          packet IS_IP.

      - name: TAG_MODE
        bits: 29..28
        access: R/W
        reset: 0x0
        typical: 0x0
        description: |
          Which tag algorithm to use
          0 = always use tuple tag algorithm
          1 = always use mask tag algorithm
          2 = if packet is IP, use tuple else use mask
          3 = tuple XOR mask

      - name: INC_VS
        bits: 27..26
        access: R/W
        reset: 0x0
        typical: 0x0
        description: |
          determines the DSA/VLAN ID (VID) to be included in
          tuple tag when VLAN stacking is detected
          0 = do not include VID in tuple tag generation
          1 = include VID (VLAN0) in hash
          2 = include VID (VLAN1) in hash
          3 = include VID ({VLAN0,VLAN1}) in hash

      - name: INC_VLAN
        bits: 25
        access: R/W
        reset: 0
        typical: 0
        description: |
          when set, the DSA/VLAN ID is included in tuple tag
          when VLAN stacking is not detected
          0 = do not include VID in tuple tag generation
          1 = include VID in hash

      - name: INC_PRT
        bits: 24
        access: R/W
        reset: 0
        typical: 0
        description: sets whether the port is included in tuple tag

      - name: IP6_DPRT
        bits: 23
        access: R/W
        reset: 0
        typical: 0
        description: |
          sets whether the TCP/UDP dst port is
          included in tuple tag for IPv6 packets

      - name: IP4_DPRT
        bits: 22
        access: R/W
        reset: 0
        typical: 0
        description: |
          sets whether the TCP/UDP dst port is
          included in tuple tag for IPv4

      - name: IP6_SPRT
        bits: 21
        access: R/W
        reset: 0
        typical: 0
        description: |
          sets whether the TCP/UDP src port is
          included in tuple tag for IPv6 packets

      - name: IP4_SPRT
        bits: 20
        access: R/W
        reset: 0
        typical: 0
        description: |
          sets whether the TCP/UDP src port is
          included in tuple tag for IPv4

      - name: IP6_NXTH
        bits: 19
        access: R/W
        reset: 0
        typical: 0
        description: |
          sets whether ipv6 includes next header in tuple
          tag hash

      - name: IP4_PCTL
        bits: 18
        access: R/W
        reset: 0
        typical: 0
        description: |
          sets whether ipv4 includes protocol in tuple
          tag hash

      - name: IP6_DST
        bits: 17
        access: R/W
        reset: 0
        typical: 0
        description: |
          sets whether ipv6 includes dst address in tuple
          tag hash

      - name: IP4_DST
        bits: 16
        access: R/W
        reset: 0
        typical: 0
        description: |
          sets whether ipv4 includes dst address in tuple
          tag hash

      - name: IP6_SRC
        bits: 15
        access: R/W
        reset: 0
        typical: 0
        description: |
          sets whether ipv6 includes src address in tuple
          tag hash

      - name: IP4_SRC
        bits: 14
        access: R/W
        reset: 0
        typical: 0
        description: |
          sets whether ipv4 includes src address in tuple
          tag hash

      - name: TCP6_TAG
        bits: 13..12
        access: R/W
        reset: 0x0
        typical: 0x0
        description: |
          sets the tag_type of a TCP packet (IPv6)
          0 = ordered tags
          1 = atomic tags
          2 = Null tags

      - name: TCP4_TAG
        bits: 11..10
        access: R/W
        reset: 0x0
        typical: 0x0
        description: |
          sets the tag_type of a TCP packet (IPv4)
          0 = ordered tags
          1 = atomic tags
          2 = Null tags

      - name: IP6_TAG
        bits: 9..8
        access: R/W
        reset: 0x0
        typical: 0x0
        description: |
          sets whether IPv6 packet tag type
          0 = ordered tags
          1 = atomic tags
          2 = Null tags

      - name: IP4_TAG
        bits: 7..6
        access: R/W
        reset: 0x0
        typical: 0x0
        description: |
          sets whether IPv4 packet tag type
          0 = ordered tags
          1 = atomic tags
          2 = Null tags

      - name: NON_TAG
        bits: 5..4
        access: R/W
        reset: 0x0
        typical: 0x0
        description: |
          sets whether non-IP packet tag type
          0 = ordered tags
          1 = atomic tags
          2 = Null tags

      - name: GRP
        bits: 3..0
        access: R/W
        reset: 0x0
        typical: 0x0
        description: 4-bit value indicating the group to schedule to


  - name: PIP_QOS_DIFF(0..63)
    address: 0x11800A0000600 + a*0x8
    bus: RSL
    fields:
      - name: --
        bits: 63..3
        access: RAZ
        reset: --
        typical: --
        description: Reserved.

      - name: QOS
        bits: 2..0
        access: R/W
        reset: 0x0
        typical: 0x0
        description: Diffserv QOS level


  - name: PIP_STAT0_PRT(0..3,16..19,24,32..35,36..39)
    address: 0x11800A0000800 + a*0x50
    bus: RSL
    description: |
      "PIP Statistics Counters
      Note: special stat counter behavior
      1) Read and write operations must arbitrate for the statistics resources
      along with the packet engines which are incrementing the counters.
      In order to not drop packet information, the packet HW is always a
      higher priority and the CSR requests will only be satisified when
      there are idle cycles.  This can potentially cause long delays if the
      system becomes full.
      2) stat counters can be cleared in two ways.  If PIP_STAT_CTL[RDCLR] is
      set, then all read accesses will clear the register.  In addition,
      any write to a stats register will also reset the register to zero.
      Please note that the clearing operations must obey rule #1 above.
      3) all counters are wrapping - software must ensure they are read periodically
      4) The counters accumulate statistics for packets that are sent to PKI.  If
      PTP_MODE is enabled, the 8B timestamp is prepended to the packet.  This
      additional 8B of data is captured in the octet counts.
      PIP_STAT0_PRT = PIP_STAT_DRP_PKTS / PIP_STAT_DRP_OCTS"
    attributes:
      exempt_natural_alignment: "a"
    fields:
      - name: DRP_PKTS
        bits: 63..32
        access: R/W/H
        reset: 0x0
        typical: --
        description: |
          Inbound packets marked to be dropped by the IPD
          QOS widget per port

      - name: DRP_OCTS
        bits: 31..0
        access: R/W/H
        reset: 0x0
        typical: --
        description: |
          Inbound octets marked to be dropped by the IPD
          QOS widget per port


  - name: PIP_STAT1_PRT(0..3,16..19,24,32..35,36..39)
    address: 0x11800A0000808 + a*0x50
    bus: RSL
    attributes:
      exempt_natural_alignment: "a"
    fields:
      - name: --
        bits: 63..48
        access: RAZ
        reset: --
        typical: --
        description: Reserved.

      - name: OCTS
        bits: 47..0
        access: R/W/H
        reset: 0x0
        typical: --
        description: Number of octets received by PIP (good and bad)


  - name: PIP_STAT2_PRT(0..3,16..19,24,32..35,36..39)
    address: 0x11800A0000810 + a*0x50
    bus: RSL
    attributes:
      exempt_natural_alignment: "a"
    fields:
      - name: PKTS
        bits: 63..32
        access: R/W/H
        reset: 0x0
        typical: --
        description: Number of packets processed by PIP

      - name: RAW
        bits: 31..0
        access: R/W/H
        reset: 0x0
        typical: --
        description: |
          RAWFULL + RAWSCH Packets without an L1/L2 error
          received by PIP per port


  - name: PIP_STAT3_PRT(0..3,16..19,24,32..35,36..39)
    address: 0x11800A0000818 + a*0x50
    bus: RSL
    attributes:
      exempt_natural_alignment: "a"
    fields:
      - name: BCST
        bits: 63..32
        access: R/W/H
        reset: 0x0
        typical: --
        description: |
          Number of indentified L2 broadcast packets
          Does not include multicast packets
          Only includes packets whose parse mode is
          SKIP_TO_L2.

      - name: MCST
        bits: 31..0
        access: R/W/H
        reset: 0x0
        typical: --
        description: |
          Number of indentified L2 multicast packets
          Does not include broadcast packets
          Only includes packets whose parse mode is
          SKIP_TO_L2.


  - name: PIP_STAT4_PRT(0..3,16..19,24,32..35,36..39)
    address: 0x11800A0000820 + a*0x50
    bus: RSL
    attributes:
      exempt_natural_alignment: "a"
    fields:
      - name: H65TO127
        bits: 63..32
        access: R/W/H
        reset: 0x0
        typical: --
        description: Number of 65-127B packets

      - name: H64
        bits: 31..0
        access: R/W/H
        reset: 0x0
        typical: --
        description: Number of 1-64B packets


  - name: PIP_STAT5_PRT(0..3,16..19,24,32..35,36..39)
    address: 0x11800A0000828 + a*0x50
    bus: RSL
    attributes:
      exempt_natural_alignment: "a"
    fields:
      - name: H256TO511
        bits: 63..32
        access: R/W/H
        reset: 0x0
        typical: --
        description: Number of 256-511B packets

      - name: H128TO255
        bits: 31..0
        access: R/W/H
        reset: 0x0
        typical: --
        description: Number of 128-255B packets


  - name: PIP_STAT6_PRT(0..3,16..19,24,32..35,36..39)
    address: 0x11800A0000830 + a*0x50
    bus: RSL
    attributes:
      exempt_natural_alignment: "a"
    fields:
      - name: H1024TO1518
        bits: 63..32
        access: R/W/H
        reset: 0x0
        typical: --
        description: Number of 1024-1518B packets

      - name: H512TO1023
        bits: 31..0
        access: R/W/H
        reset: 0x0
        typical: --
        description: Number of 512-1023B packets


  - name: PIP_STAT7_PRT(0..3,16..19,24,32..35,36..39)
    address: 0x11800A0000838 + a*0x50
    bus: RSL
    internal: |
      DPI does not check FCS, therefore FCS will never increment on DPI ports 32-35
    attributes:
      exempt_natural_alignment: "a"
    fields:
      - name: FCS
        bits: 63..32
        access: R/W/H
        reset: 0x0
        typical: --
        description: Number of packets with FCS or Align opcode errors

      - name: H1519
        bits: 31..0
        access: R/W/H
        reset: 0x0
        typical: --
        description: Number of 1519-max packets


  - name: PIP_STAT8_PRT(0..3,16..19,24,32..35,36..39)
    address: 0x11800A0000840 + a*0x50
    bus: RSL
    internal: |
      DPI does not check FCS, therefore FRAG will never increment on DPI ports 32-35
    attributes:
      exempt_natural_alignment: "a"
    fields:
      - name: FRAG
        bits: 63..32
        access: R/W/H
        reset: 0x0
        typical: --
        description: Number of packets with length < min and FCS error

      - name: UNDERSZ
        bits: 31..0
        access: R/W/H
        reset: 0x0
        typical: --
        description: Number of packets with length < min


  - name: PIP_STAT9_PRT(0..3,16..19,24,32..35,36..39)
    address: 0x11800A0000848 + a*0x50
    bus: RSL
    internal: |
      DPI does not check FCS, therefore JABBER will never increment on DPI ports 32-35
    attributes:
      exempt_natural_alignment: "a"
    fields:
      - name: JABBER
        bits: 63..32
        access: R/W/H
        reset: 0x0
        typical: --
        description: Number of packets with length > max and FCS error

      - name: OVERSZ
        bits: 31..0
        access: R/W/H
        reset: 0x0
        typical: --
        description: Number of packets with length > max


  - name: PIP_STAT10_PRT(0..3,16..19,24,32..35,36..39)
    address: 0x11800A0001480 + a*0x10
    bus: RSL
    attributes:
      exempt_natural_alignment: "a"
    fields:
      - name: BCAST
        bits: 63..32
        access: R/W/H
        reset: 0x0
        typical: --
        description: |
          Number of packets with L2 Broadcast DMAC
          that were dropped due to RED.
          The HW will consider a packet to be an L2
          broadcast packet when the 48-bit DMAC is all 1's.
          Only applies when the parse mode for the packet
          is SKIP-TO-L2.

      - name: MCAST
        bits: 31..0
        access: R/W/H
        reset: 0x0
        typical: --
        description: |
          Number of packets with L2 Mulitcast DMAC
          that were dropped due to RED.
          The HW will consider a packet to be an L2
          multicast packet when the least-significant bit
          of the first byte of the DMAC is set and the
          packet is not an L2 broadcast packet.
          Only applies when the parse mode for the packet
          is SKIP-TO-L2.


  - name: PIP_STAT11_PRT(0..3,16..19,24,32..35,36..39)
    address: 0x11800A0001488 + a*0x10
    bus: RSL
    attributes:
      exempt_natural_alignment: "a"
    fields:
      - name: BCAST
        bits: 63..32
        access: R/W/H
        reset: 0x0
        typical: --
        description: |
          Number of packets with L3 Broadcast Dest Address
          that were dropped due to RED.
          The HW considers an IPv4 packet to be broadcast
          when all bits are set in the MSB of the
          destination address. IPv6 does not have the
          concept of a broadcast packets.
          Only applies when the parse mode for the packet
          is SKIP-TO-L2 and the packet is IP or the parse
          mode for the packet is SKIP-TO-IP.

      - name: MCAST
        bits: 31..0
        access: R/W/H
        reset: 0x0
        typical: --
        description: |
          Number of packets with L3 Multicast Dest Address
          that were dropped due to RED.
          The HW considers an IPv4 packet to be multicast
          when the most-significant nibble of the 32-bit
          destination address is 0xE (i.e. it is a class D
          address). The HW considers an IPv6 packet to be
          multicast when the most-significant byte of the
          128-bit destination address is all 1's.
          Only applies when the parse mode for the packet
          is SKIP-TO-L2 and the packet is IP or the parse
          mode for the packet is SKIP-TO-IP.


  - name: PIP_TAG_INC(0..63)
    title: Which bytes to include in the new tag hash algorithm
    address: 0x11800A0001800 + a*0x8
    bus: RSL
    description: "# $PIP_TAG_INC@ = 0x300+@ @=(0..63) RegType=(RSL) RtlReg=(pip_tag_inc_csr_direct_TestbuilderTask)"
    fields:
      - name: --
        bits: 63..8
        access: RAZ
        reset: --
        typical: --
        description: Reserved.

      - name: EN
        bits: 7..0
        access: R/W
        reset: 0x0
        typical: 0x0
        description: |
          Which bytes to include in mask tag algorithm
          Broken into 4, 16-entry masks to cover 128B
          PIP_PRT_CFG[TAG_INC] selects 1 of 4 to use
          registers  0-15 map to PIP_PRT_CFG[TAG_INC] == 0
          registers 16-31 map to PIP_PRT_CFG[TAG_INC] == 1
          registers 32-47 map to PIP_PRT_CFG[TAG_INC] == 2
          registers 48-63 map to PIP_PRT_CFG[TAG_INC] == 3
          [7] coresponds to the MSB of the 8B word
          [0] coresponds to the LSB of the 8B word
          If PTP_MODE, the 8B timestamp is prepended to the
          packet.  The EN byte masks should be adjusted to
          compensate for the additional timestamp field.


  - name: PIP_STAT_INB_PKTS(0..3,16..19,24,32..35,36..39)
    address: 0x11800A0001A00 + a*0x20
    bus: RSL
    description: |
      Inbound stats collect all data sent to PIP from all packet interfaces.
      Its the raw counts of everything that comes into the block.  The counts
      will reflect all error packets and packets dropped by the PKI RED engine.
      These counts are intended for system debug, but could convey useful
      information in production systems.
    attributes:
      exempt_natural_alignment: "a"
    fields:
      - name: --
        bits: 63..32
        access: RAZ
        reset: --
        typical: --
        description: Reserved.

      - name: PKTS
        bits: 31..0
        access: R/W/H
        reset: 0x0
        typical: --
        description: |
          Number of packets without errors
          received by PIP


  - name: PIP_STAT_INB_OCTS(0..3,16..19,24,32..35,36..39)
    address: 0x11800A0001A08 + a*0x20
    bus: RSL
    description: |
      Inbound stats collect all data sent to PIP from all packet interfaces.
      Its the raw counts of everything that comes into the block.  The counts
      will reflect all error packets and packets dropped by the PKI RED engine.
      These counts are intended for system debug, but could convey useful
      information in production systems. The OCTS will include the bytes from
      timestamp fields in PTP_MODE.
    attributes:
      exempt_natural_alignment: "a"
    fields:
      - name: --
        bits: 63..48
        access: RAZ
        reset: --
        typical: --
        description: Reserved.

      - name: OCTS
        bits: 47..0
        access: R/W/H
        reset: 0x0
        typical: --
        description: |
          Total number of octets from all packets received
          by PIP


  - name: PIP_STAT_INB_ERRS(0..3,16..19,24,32..35,36..39)
    address: 0x11800A0001A10 + a*0x20
    bus: RSL
    description: |
      Inbound stats collect all data sent to PIP from all packet interfaces.
      Its the raw counts of everything that comes into the block.  The counts
      will reflect all error packets and packets dropped by the PKI RED engine.
      These counts are intended for system debug, but could convey useful
      information in production systems.
    attributes:
      exempt_natural_alignment: "a"
    fields:
      - name: --
        bits: 63..16
        access: RAZ
        reset: --
        typical: --
        description: Reserved.

      - name: ERRS
        bits: 15..0
        access: R/W/H
        reset: 0x0
        typical: --
        description: |
          Number of packets with errors
          received by PIP


  - name: PIP_BSEL_EXT_CFG(0..3)
    address: 0x11800A0002800 + a*0x10
    bus: RSL
    description: tag, offset, and skip values to be used when using the corresponding extractor.
    fields:
      - name: --
        bits: 63..56
        access: RAZ
        reset: --
        typical: --
        description: Reserved.

      - name: UPPER_TAG
        bits: 55..40
        access: R/W
        reset: 0x0
        typical: --
        description: |
          Extra Tag bits to be added to tag field from table
          Only included when PIP_PRT_TAG[INC_PRT]=0
          WORD2[TAG<31:16>]

      - name: TAG
        bits: 39..32
        access: R/W
        reset: 0x0
        typical: --
        description: |
          Extra Tag bits to be added to tag field from table
          WORD2[TAG<15:8>]

      - name: --
        bits: 31..25
        access: RAZ
        reset: --
        typical: --
        description: Reserved.

      - name: OFFSET
        bits: 24..16
        access: R/W
        reset: 0x0
        typical: --
        description: |
          Indicates offset to add to extractor mem adr
          to get final address to the lookup table

      - name: --
        bits: 15..7
        access: RAZ
        reset: --
        typical: --
        description: Reserved.

      - name: SKIP
        bits: 6..0
        access: R/W
        reset: 0x0
        typical: --
        description: |
          Indicates number of bytes to skip from start of
          packet 0-64


  - name: PIP_BSEL_EXT_POS(0..3)
    address: 0x11800A0002808 + a*0x10
    bus: RSL
    description: bit positions and valids to be used when using the corresponding extractor.
    internal: |
      Examples on bit positioning:
      the most-significant-bit of the 3rd byte         ... PIP_BSEL_EXT_CFG*[SKIP]=1 POSn=15
      (decimal) or
      PIP_BSEL_EXT_CFG*[SKIP]=0 POSn=23 (decimal)
      the least-significant-bit of the 5th byte        ... PIP_BSEL_EXT_CFG*[SKIP]=4 POSn=0
      the second-least-significant bit of the 1st byte ... PIP_BSEL_EXT_CFG*[SKIP]=0 POSn=1
      POSn_VAL and POSn correspond to <n> in the resultant index into
      PIP_BSEL_TBL_ENT. When only x bits (0 < x < 7) are to be extracted,
      POS[7:x] should normally be clear.
    fields:
      - name: POS7_VAL
        bits: 63
        access: R/W
        reset: 0
        typical: --
        description: Valid bit for bit position 7

      - name: POS7
        bits: 62..56
        access: R/W
        reset: 0x0
        typical: --
        description: |
          Bit position for the 8th bit  from 128 bit segment
          of pkt that is defined by the SKIP field of
          PIP_BSEL_EXT_CFG register.

      - name: POS6_VAL
        bits: 55
        access: R/W
        reset: 0
        typical: --
        description: Valid bit for bit position 6

      - name: POS6
        bits: 54..48
        access: R/W
        reset: 0x0
        typical: --
        description: |
          Bit position for the 7th bit  from 128 bit segment
          of pkt that is defined by the SKIP field of
          PIP_BSEL_EXT_CFG register.

      - name: POS5_VAL
        bits: 47
        access: R/W
        reset: 0
        typical: --
        description: Valid bit for bit position 5

      - name: POS5
        bits: 46..40
        access: R/W
        reset: 0x0
        typical: --
        description: |
          Bit position for the 6th bit  from 128 bit segment
          of pkt that is defined by the SKIP field of
          PIP_BSEL_EXT_CFG register.

      - name: POS4_VAL
        bits: 39
        access: R/W
        reset: 0
        typical: --
        description: Valid bit for bit position 4

      - name: POS4
        bits: 38..32
        access: R/W
        reset: 0x0
        typical: --
        description: |
          Bit position for the 5th bit  from 128 bit segment
          of pkt that is defined by the SKIP field of
          PIP_BSEL_EXT_CFG register.

      - name: POS3_VAL
        bits: 31
        access: R/W
        reset: 0
        typical: --
        description: Valid bit for bit position 3

      - name: POS3
        bits: 30..24
        access: R/W
        reset: 0x0
        typical: --
        description: |
          Bit position for the 4th bit  from 128 bit segment
          of pkt that is defined by the SKIP field of
          PIP_BSEL_EXT_CFG register.

      - name: POS2_VAL
        bits: 23
        access: R/W
        reset: 0
        typical: --
        description: Valid bit for bit position 2

      - name: POS2
        bits: 22..16
        access: R/W
        reset: 0x0
        typical: --
        description: |
          Bit position for the 3rd bit  from 128 bit segment
          of pkt that is defined by the SKIP field of
          PIP_BSEL_EXT_CFG register.

      - name: POS1_VAL
        bits: 15
        access: R/W
        reset: 0
        typical: --
        description: Valid bit for bit position 1

      - name: POS1
        bits: 14..8
        access: R/W
        reset: 0x0
        typical: --
        description: |
          Bit position for the 2nd bit  from 128 bit segment
          of pkt that is defined by the SKIP field of
          PIP_BSEL_EXT_CFG register.

      - name: POS0_VAL
        bits: 7
        access: R/W
        reset: 0
        typical: --
        description: Valid bit for bit position 0

      - name: POS0
        bits: 6..0
        access: R/W
        reset: 0x0
        typical: --
        description: |
          Bit position for the 1st bit  from 128 bit segment
          of pkt that is defined by the SKIP field of
          PIP_BSEL_EXT_CFG register.


  - name: PIP_ALT_SKIP_CFG(0..3)
    address: 0x11800A0002A00 + a*0x8
    bus: RSL
    fields:
      - name: --
        bits: 63..57
        access: RAZ
        reset: --
        typical: --
        description: Reserved.

      - name: LEN
        bits: 56
        access: R/W
        reset: 0
        typical: --
        description: |
          Indicates the length of the selection field
          0 = 0,    BIT0
          1 = BIT1, BIT0

      - name: --
        bits: 55..48
        access: RAZ
        reset: --
        typical: --
        description: Reserved.

      - name: --
        bits: 47..46
        access: RAZ
        reset: --
        typical: --
        description: Reserved.

      - name: BIT1
        bits: 45..40
        access: R/W
        reset: 0x0
        typical: --
        description: |
          Indicates the bit location in the first word of
          the packet to use to select the skip amount.
          BIT1 must be present in the packet.

      - name: --
        bits: 39..38
        access: RAZ
        reset: --
        typical: --
        description: Reserved.

      - name: BIT0
        bits: 37..32
        access: R/W
        reset: 0x0
        typical: --
        description: |
          Indicates the bit location in the first word of
          the packet to use to select the skip amount.
          BIT0 must be present in the packet.

      - name: --
        bits: 31..24
        access: RAZ
        reset: --
        typical: --
        description: Reserved.

      - name: --
        bits: 23
        access: RAZ
        reset: --
        typical: --
        description: Reserved.

      - name: SKIP3
        bits: 22..16
        access: R/W
        reset: 0x0
        typical: --
        description: |
          Indicates number of bytes to skip from start of
          packet 0-64

      - name: --
        bits: 15
        access: RAZ
        reset: --
        typical: --
        description: Reserved.

      - name: SKIP2
        bits: 14..8
        access: R/W
        reset: 0x0
        typical: --
        description: |
          Indicates number of bytes to skip from start of
          packet 0-64

      - name: --
        bits: 7
        access: RAZ
        reset: --
        typical: --
        description: Reserved.

      - name: SKIP1
        bits: 6..0
        access: R/W
        reset: 0x0
        typical: --
        description: |
          Indicates number of bytes to skip from start of
          packet 0-64


  - name: PIP_BSEL_TBL_ENT(0..511)
    address: 0x11800A0003000 + a*0x8
    bus: RSL
    fields:
      - name: TAG_EN
        bits: 63
        access: R/W
        reset: 0
        typical: --
        description: Enables the use of the TAG field

      - name: GRP_EN
        bits: 62
        access: R/W
        reset: 0
        typical: --
        description: Enables the use of the GRP field

      - name: TT_EN
        bits: 61
        access: R/W
        reset: 0
        typical: --
        description: Enables the use of the TT field

      - name: QOS_EN
        bits: 60
        access: R/W
        reset: 0
        typical: --
        description: Enables the use of the QOS field

      - name: --
        bits: 59..40
        access: RAZ
        reset: --
        typical: --
        description: Reserved.

      - name: TAG
        bits: 39..32
        access: R/W
        reset: 0x0
        typical: --
        description: TAG bits to be used if TAG_EN is set

      - name: --
        bits: 31..20
        access: RAZ
        reset: --
        typical: --
        description: Reserved.

      - name: GRP
        bits: 19..16
        access: R/W
        reset: 0x0
        typical: --
        description: GRP field to be used if GRP_EN is set

      - name: --
        bits: 15..10
        access: RAZ
        reset: --
        typical: --
        description: Reserved.

      - name: TT
        bits: 9..8
        access: R/W
        reset: 0x0
        typical: --
        description: TT field to be used if TT_EN is set

      - name: --
        bits: 7..3
        access: RAZ
        reset: --
        typical: --
        description: Reserved.

      - name: QOS
        bits: 2..0
        access: R/W
        reset: 0x0
        typical: --
        description: |
          QOS field to be used if QOS_EN is set

          include in the workQ entry for packets received
          on a PCI RAW port.  Measured from the beginning
          of the packet.
          include in the workQ entry.  From the beginning
          of the IP header.
          include in the workQ entry.  From the beginning
          of the packet.


  - name: PIP_PRT_CFGB(0..3,16..19,24,32..35,36..39)
    address: 0x11800A0008000 + a*0x8
    bus: RSL
    fields:
      - name: --
        bits: 63..40
        access: RAZ
        reset: --
        typical: --
        description: Reserved.

      - name: --
        bits: 39
        access: RAZ
        reset: --
        typical: --
        description: Reserved.

      - name: ALT_SKP_SEL
        bits: 38..37
        access: R/W
        reset: 0x0
        typical: --
        description: |
          Alternate skip selector
          When enabled (ALT_SKP_EN), selects which of the
          four PIP_ALT_SKIP_CFGx to use with the packets
          arriving on the port-kind.

      - name: ALT_SKP_EN
        bits: 36
        access: R/W
        reset: 0
        typical: --
        description: |
          Enable the alternate skip selector
          When enabled, the HW is able to recompute the
          SKIP I value based on the packet contents.
          Up to two of the initial 64 bits of the header
          are used along with four PIP_ALT_SKIP_CFGx to
          determine the updated SKIP I value.
          The bits of the packet used should be present in
          all packets.
          PIP_PRT_CFG[DSA_EN,HIGIG_EN] must be disabled
          when ALT_SKP_EN is set.
          ALT_SKP_EN must not be set for DPI ports (32-35)
          when a PKT_INST_HDR is present.
          ALT_SKP_EN should not be enabled for ports which
          have GMX_RX_FRM_CTL[PTP_MODE] set as the timestamp
          will be prepended onto the initial 64 bits of the
          packet.

      - name: --
        bits: 35
        access: RAZ
        reset: --
        typical: --
        description: Reserved.

      - name: BSEL_NUM
        bits: 34..33
        access: R/W
        reset: 0x0
        typical: 0x0
        description: |
          Which of the 4 bit select extractors to use
          (Alias to PIP_PRT_CFG)

      - name: BSEL_EN
        bits: 32
        access: R/W
        reset: 0
        typical: 0
        description: |
          Enable to turn on/off use of bit select extractor
          (Alias to PIP_PRT_CFG)

      - name: --
        bits: 31..0
        access: RAZ
        reset: --
        typical: --
        description: Reserved.



