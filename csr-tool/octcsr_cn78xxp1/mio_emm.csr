# -*- csr3 -*-
# You must run "csr3 rtl" after editing this file!
---
name: MIO_EMM
attributes:
  dv_fc_scratch_exempt: "RSL"
enums:
  - name: MIO_EMM_INTSN_E
    title: eMMC Interrupt Source Enumeration
    attributes:
      width: "20"
    description: Enumerates the different interrupts.
    values:
      - name: MIO_EMM_DMA_DONE
        value: 0x09000
        description: See MIO_EMM_DMA_INT[DONE].

      - name: MIO_EMM_DMA_FIFO
        value: 0x09001
        description: |
          Reserved. INTERNAL: Reserved bit in HRM; see MIO_EMM_DMA_INT[FIFO].

      - name: MIO_EMM_INT_BUF_DONE
        value: 0x09040
        description: See MIO_EMM_INT[BUF_DONE].

      - name: MIO_EMM_INT_CMD_DONE
        value: 0x09041
        description: See MIO_EMM_INT[CMD_DONE].

      - name: MIO_EMM_INT_DMA_DONE
        value: 0x09042
        description: See MIO_EMM_INT[DMA_DONE].

      - name: MIO_EMM_INT_CMD_ERR
        value: 0x09043
        description: See MIO_EMM_INT[CMD_ERR].

      - name: MIO_EMM_INT_DMA_ERR
        value: 0x09044
        description: See MIO_EMM_INT[DMA_ERR].

      - name: MIO_EMM_INT_SWITCH_DONE
        value: 0x09045
        description: See MIO_EMM_INT[SWITCH_DONE].

      - name: MIO_EMM_INT_SWITCH_ERR
        value: 0x09046
        description: See MIO_EMM_INT[SWITCH_ERR].


registers:
  - name: MIO_EMM_DMA_FIFO_CFG
    title: |
      INTERNAL: eMMC Internal DMA FIFO Configuration Register
    address: 0x1180000000160
    bus: RSL
    description: This register controls DMA FIFO Operations.
    fields:
      - name: --
        bits: 63..17
        access: RAZ
        reset: --
        typical: --
        description: Reserved.

      - name: CLR
        bits: 16
        access: R/W
        reset: 1
        typical: --
        description: DMA FIFO Clear. When set erases all commands in the DMA FIFO. Must be zero for normal operation.

      - name: --
        bits: 15..13
        access: RAZ
        reset: --
        typical: --
        description: Reserved.

      - name: INT_LVL
        bits: 12..8
        access: R/W
        reset: 0x10
        typical: --
        description: |
          Interrupt threshold that specifies the number of entries remaining in the DMA FIFO. A
          value of 16 or more disables the interrupt. See MIO_EMM_DMA_INT[FIFO].

      - name: --
        bits: 7..5
        access: RAZ
        reset: --
        typical: --
        description: Reserved.

      - name: COUNT
        bits: 4..0
        access: RO/H
        reset: 0x0
        typical: --
        description: |
          Number of entries in the DMA FIFO. This count is incremented by writes to the
          MIO_EMM_DMA_FIFO_CMD register and decremented each time the internal DMA engine completes
          the previous command successfully.

          Up to 16 entries can be placed in the FIFO. Entries written to a full FIFO will be
          ignored.


  - name: MIO_EMM_DMA_FIFO_ADR
    title: |
      INTERNAL: eMMC Internal DMA FIFO Address Register
    address: 0x1180000000170
    bus: RSL
    description: |
      This register specifies the internal address that is loaded into the eMMC internal DMA FIFO.
      The FIFO is used to queue up operations for the MIO_EMM_DMA_CFG/MIO_EMM_DMA_ADR when the DMA
      completes successfully.
    fields:
      - name: --
        bits: 63..42
        access: RAZ
        reset: --
        typical: --
        description: Reserved.

      - name: ADR
        bits: 41..0
        access: R/W
        reset: 0x0
        typical: --
        description: DMA engine address. Must be 64-bit aligned.


  - name: MIO_EMM_DMA_FIFO_CMD
    title: |
      INTERNAL: eMMMC Internal DMA FIFO Command Register
    address: 0x1180000000178
    bus: RSL
    description: |
      This register specifies a command that is loaded into the eMMC internal DMA FIFO.  The FIFO is
      used to queue up operations for the MIO_EMM_DMA_CFG/MIO_EMM_DMA_ADR when the DMA completes
      successfully. Writes to this register store both the MIO_EMM_DMA_FIFO_CMD and the
      MIO_EMM_DMA_FIFO_ADR contents into the FIFO and increment the MIO_EMM_DMA_FIFO_CFG[COUNT]
      field.

      Note: This register has a similar format to the MIO_EMM_DMA_CFG register with the exception
      that the EN and CLR fields are absent. These are supported in the MIO_EMM_DMA_FIFO_CFG.
    fields:
      - name: --
        bits: 63
        access: RAZ
        reset: --
        typical: --
        description: Reserved.

      - name: RW
        bits: 62
        access: R/W
        reset: 0
        typical: --
        description: |
          DMA engine R/W bit: 0 = read, 1 = write.

      - name: --
        bits: 61..60
        access: RAZ
        reset: --
        typical: --
        description: Reserved.

      - name: SWAP32
        bits: 59
        access: R/W
        reset: 0
        typical: --
        description: DMA engine 32-bit swap.

      - name: SWAP16
        bits: 58
        access: R/W
        reset: 0
        typical: --
        description: DMA engine enable 16-bit swap.

      - name: SWAP8
        bits: 57
        access: R/W
        reset: 0
        typical: --
        description: DMA engine enable 8-bit swap.

      - name: ENDIAN
        bits: 56
        access: R/W
        reset: 0
        typical: --
        description: |
          DMA engine endian mode: 0 = big-endian, 1 = little-endian.

      - name: SIZE
        bits: 55..36
        access: R/W/H
        reset: 0x0
        typical: --
        description: |
          DMA engine size. Specified in the number of 64-bit transfers (encoded in -1 notation). For
          example, to transfer 512 bytes, SIZE = 64 - 1 = 63.

      - name: --
        bits: 35..0
        access: RAZ
        reset: --
        typical: --
        description: Reserved.


  - name: MIO_EMM_DMA_CFG
    title: eMMC DMA Configuration Register
    address: 0x1180000000180
    bus: RSL
    description: |
      This register controls the internal DMA engine used with the eMMC/SD flash controller. Sixty-
      four-bit operations must be used to access this register.
    fields:
      - name: EN
        bits: 63
        access: R/W/H
        reset: 0
        typical: --
        description: DMA engine enable.

      - name: RW
        bits: 62
        access: R/W
        reset: 0
        typical: --
        description: |
          DMA engine R/W bit: 0 = read, 1 = write.

      - name: CLR
        bits: 61
        access: R/W
        reset: 0
        typical: --
        description: DMA engine abort. When set to 1, DMA is aborted and EN is cleared on completion.

      - name: --
        bits: 60
        access: RAZ
        reset: --
        typical: --
        description: Reserved.

      - name: SWAP32
        bits: 59
        access: R/W
        reset: 0
        typical: --
        description: DMA engine 32-bit swap.

      - name: SWAP16
        bits: 58
        access: R/W
        reset: 0
        typical: --
        description: DMA engine enable 16-bit swap.

      - name: SWAP8
        bits: 57
        access: R/W
        reset: 0
        typical: --
        description: DMA engine enable 8-bit swap.

      - name: ENDIAN
        bits: 56
        access: R/W
        reset: 0
        typical: --
        description: |
          DMA engine endian mode: 0 = big-endian, 1 = little-endian.

      - name: SIZE
        bits: 55..36
        access: R/W/H
        reset: 0x0
        typical: --
        description: |
          DMA engine size. Specified in the number of 64-bit transfers (encoded in -1 notation). For
          example, to transfer 512 bytes, SIZE = 64 - 1 = 63.

      - name: --
        bits: 35..0
        access: RAZ
        reset: --
        typical: --
        description: Reserved.


  - name: MIO_EMM_DMA_ADR
    title: eMMC DMA Address Register
    address: 0x1180000000188
    bus: RSL
    description: |
      This register sets the address for eMMC/SD flash transfers to/from memory. Sixty-four-bit
      operations must be used to access this register.
    fields:
      - name: --
        bits: 63..42
        access: RAZ
        reset: --
        typical: --
        description: Reserved.

      - name: ADR
        bits: 41..0
        access: R/W/H
        reset: 0x0
        typical: --
        description: DMA engine address. Must be 64-bit aligned.


  - name: MIO_EMM_DMA_INT
    title: eMMC DMA Interrupt Register
    address: 0x1180000000190
    bus: RSL
    description: Sixty-four-bit operations must be used to access this register.
    fields:
      - name: --
        bits: 63..2
        access: RAZ
        reset: --
        typical: --
        description: Reserved.

      - name: FIFO
        bits: 1
        access: R/W1C/H
        reset: 0
        typical: --
        description: |
          INIERNAL Set as reserved in HRM
          Internal DMA FIFO has dropped to level specified by MIO_EMM_DMA_FIFO_CFG[INT_LVL]. Throws
          MIO_EMM_INTSN_E::MIO_EMM_DMA_FIFO.

      - name: DONE
        bits: 0
        access: R/W1C/H
        reset: 0
        typical: --
        description: |
          Internal DMA engine request completion interrupt. Throws
          MIO_EMM_INTSN_E::MIO_EMM_DMA_DONE.


  - name: MIO_EMM_CFG
    title: MIO eMMC Configuration Register
    address: 0x1180000002000
    bus: RSL
    fields:
      - name: --
        bits: 63..17
        access: RAZ
        reset: 0x0
        typical: --
        description: Reserved.

      - name: BOOT_FAIL
        bits: 16
        access: R/W
        reset: 0
        typical: --
        description: |
          Software should set BOOT_FAIL when an unrecoverable error occurs while attempting to boot
          from eMMC or NOR Flash. When set, the following pattern will be output:
          * BOOT_AD<31:0> driven to 0.
          * BOOT_CE_<7:0>_L driven to 1.
          * BOOT_ALE driven to 1.
          * BOOT_OE_L driven to 0.
          * BOOT_WE_L driven to 0.

      - name: --
        bits: 15..4
        access: RAZ
        reset: 0x0
        typical: --
        description: Reserved.

      - name: BUS_ENA
        bits: 3..0
        access: R/W
        reset: 0x0
        typical: --
        description: |
          eMMC bus enable mask.

          Setting bit0 of BUS_ENA causes EMMC_CMD[0] to become dedicated eMMC bus 0 command (i.e.
          disabling any NOR use).

          Setting bit1 of BUS_ENA causes EMMC_CMD[1] to become dedicated eMMC bus 1 command (i.e.
          disabling any NOR use).

          Setting bit2 of BUS_ENA causes EMMC_CMD[2] to become dedicated eMMC bus 2 command (i.e.
          disabling any NOR use).

          Bit3 of BUS_ENA is reserved.

          Setting any bit of BUS_ENA causes EMMC_CLK to become the eMMC clock for both bus0 and
          bus1.


  - name: MIO_EMM_MODE(0..3)
    title: MIO eMMC Operating Mode Register
    address: 0x1180000002008 + a*0x8
    bus: RSL
    attributes:
      exempt_natural_alignment: "a"
    fields:
      - name: --
        bits: 63..49
        access: RAZ
        reset: 0x0
        typical: --
        description: Reserved.

      - name: HS_TIMING
        bits: 48
        access: RO/H
        reset: 0
        typical: --
        description: Current high-speed timing mode. Required when CLK frequency is higher than 20MHz.

      - name: --
        bits: 47..43
        access: RAZ
        reset: 0x0
        typical: --
        description: Reserved.

      - name: BUS_WIDTH
        bits: 42..40
        access: RO/H
        reset: 0x0
        typical: --
        description: |
          Current card bus mode. Out of reset, the card is in 1-bit data bus mode. Select bus width.
          0x0 = 1-bit data bus (power on).
          0x1 = 4-bit data bus.
          0x2 = 8-bit data bus.
          0x3 = Reserved.
          0x4 = Reserved.
          0x5 = 4-bit data bus (dual data rate).
          0x6 = 8-bit data bus (dual data rate).
          0x7 = Reserved.
          0x8 = Reserved.

      - name: --
        bits: 39..36
        access: RAZ
        reset: 0x0
        typical: --
        description: Reserved.

      - name: POWER_CLASS
        bits: 35..32
        access: RO/H
        reset: 0x0
        typical: --
        description: |
          Out of reset, the card power class is 0, which is the minimum current consumption class
          for the card. EXT_CSD bytes [203:200] and [239:238] contain the power class for different
          BUS_WITDH and CLK frequencies. Software should write this field with the 4-bit field from
          the EXT_CSD bytes corresponding to the selected operating mode.

      - name: CLK_HI
        bits: 31..16
        access: RO/H
        reset: 0x9c4
        typical: --
        description: Current number of coprocessor-clocks to hold the eMMC CLK pin high.

      - name: CLK_LO
        bits: 15..0
        access: RO/H
        reset: 0x9c4
        typical: --
        description: Current number of coprocessor-clocks to hold the eMMC CLK pin low.


  - name: MIO_EMM_SWITCH
    title: MIO eMMC Operating Mode Switch Register
    address: 0x1180000002048
    bus: RSL
    fields:
      - name: --
        bits: 63..62
        access: RAZ
        reset: 0x0
        typical: --
        description: Reserved.

      - name: BUS_ID
        bits: 61..60
        access: R/W/H
        reset: 0x0
        typical: --
        description: Specifies the eMMC bus id.

      - name: SWITCH_EXE
        bits: 59
        access: R/W/H
        reset: 0
        typical: --
        description: |
          When SWITCH_EXE is 0, the operating modes are updated directly without performing any
          SWITCH operations. This allows software to perform the SWITCH operations manually, then
          update the hardware.

          Software writes this bit to a 1 to indicate that hardware should perform the necessary
          SWITCH operations.

          * First, the POWER_CLASS switch is performed. If it fails, SWITCH_ERR0 is set and the
          remaining SWITCH operations are not performed. If it succeeds, the POWER_CLASS field is
          updated and the HS_TIMING switch is performed.

          * If the HS_TIMING switch fails, SWITCH_ERR1 is set and the remaining SWITCH operations
          are not performed. If it succeeds, the HS_TIMING field is updated and the BUS_WIDTH switch
          operation is performed.

          * If the BUS_WIDTH switch operation fails, SWITCH_ERR2 is set. If it succeeds, the
          BUS_WITDH is updated.

          Changes to CLK_HI and CLK_LO are discarded if any SWITCH_ERR occurs.

      - name: SWITCH_ERR0
        bits: 58
        access: RO/H
        reset: 0
        typical: --
        description: Error encountered while performing POWER_CLASS switch. See MIO_EMM_RSP_STS.

      - name: SWITCH_ERR1
        bits: 57
        access: RO/H
        reset: 0
        typical: --
        description: Error encountered while performing HS_TIMING switch. See MIO_EMM_RSP_STS.

      - name: SWITCH_ERR2
        bits: 56
        access: RO/H
        reset: 0
        typical: --
        description: Error encountered while performing BUS_WIDTH switch. See MIO_EMM_RSP_STS.

      - name: --
        bits: 55..49
        access: RAZ
        reset: 0x0
        typical: --
        description: Reserved.

      - name: HS_TIMING
        bits: 48
        access: R/W
        reset: 0
        typical: --
        description: Requested update to HS_TIMING

      - name: --
        bits: 47..43
        access: RAZ
        reset: 0x0
        typical: --
        description: Reserved.

      - name: BUS_WIDTH
        bits: 42..40
        access: R/W
        reset: 0x0
        typical: --
        description: Requested update to BUS_WIDTH

      - name: --
        bits: 39..36
        access: RAZ
        reset: 0x0
        typical: --
        description: Reserved.

      - name: POWER_CLASS
        bits: 35..32
        access: R/W
        reset: 0x0
        typical: --
        description: Requested update to POWER_CLASS

      - name: CLK_HI
        bits: 31..16
        access: R/W
        reset: 0x9c4
        typical: --
        description: Requested update to CLK_HI

      - name: CLK_LO
        bits: 15..0
        access: R/W
        reset: 0x9c4
        typical: --
        description: Requested update to CLK_LO


  - name: MIO_EMM_DMA
    title: MIO eMMC DMA Configuration Register
    address: 0x1180000002050
    bus: RSL
    fields:
      - name: --
        bits: 63
        access: RAZ
        reset: 0
        typical: --
        description: Reserved.

      - name: SKIP_BUSY
        bits: 62
        access: R/W
        reset: 0
        typical: --
        description: |
          Controls when DMA is completed.
          0 = DMA doesn't complete until card has dropped the BUSY signal.
          1 = Complete DMA after last transfer regardless of the BUSY signal. Status of signal can
          be read in MIO_EMM_RSP_STS[RSP_BUSYBIT].

      - name: BUS_ID
        bits: 61..60
        access: R/W
        reset: 0x0
        typical: --
        description: Specify the eMMC bus

      - name: DMA_VAL
        bits: 59
        access: R/W/H
        reset: 0
        typical: --
        description: |
          Software writes this bit to a 1 to indicate that hardware should perform the DMA transfer.
          Hardware clears this bit when the DMA operation completes or is terminated.

      - name: SECTOR
        bits: 58
        access: R/W/H
        reset: 0
        typical: --
        description: Specify CARD_ADDR and eMMC are using sector (512B) addressing.

      - name: DAT_NULL
        bits: 57
        access: R/W
        reset: 0
        typical: --
        description: |
          Do not perform any eMMC commands. A DMA read returns all 0s. A DMA write tosses the data.
          In the case of a failure, this can be used to unwind the DMA engine.

      - name: THRES
        bits: 56..51
        access: R/W
        reset: 0x0
        typical: --
        description: |
          Number of 8-byte blocks of data that must exist in the DBUF before starting the 512-byte
          block transfer. Zero indicates to wait for the entire block.

      - name: REL_WR
        bits: 50
        access: R/W
        reset: 0
        typical: --
        description: Set the reliable write parameter when performing CMD23 (SET_BLOCK_COUNT) for a multiple block.

      - name: RW
        bits: 49
        access: R/W
        reset: 0
        typical: --
        description: Read/write bit (0 = read, 1 = write)

      - name: MULTI
        bits: 48
        access: R/W
        reset: 0
        typical: --
        description: Perform operation using a multiple block command instead of a series of single block commands.

      - name: BLOCK_CNT
        bits: 47..32
        access: R/W/H
        reset: 0x0
        typical: --
        description: |
          Number of blocks to read/write. Hardware decrements the block count after each successful
          block transfer.

      - name: CARD_ADDR
        bits: 31..0
        access: R/W/H
        reset: 0x0
        typical: --
        description: |
          Data address for media <= 2GB is a 32-bit byte address, and data address for media > 2GB
          is a 32-bit sector (512B) address. Hardware advances the card address after each
          successful block transfer by 512 for byte addressing and by 1 for sector addressing.


  - name: MIO_EMM_CMD
    title: MIO eMMC Command Register
    address: 0x1180000002058
    bus: RSL
    fields:
      - name: --
        bits: 63
        access: RAZ
        reset: 0
        typical: --
        description: Reserved.

      - name: SKIP_BUSY
        bits: 62
        access: R/W
        reset: 0
        typical: --
        description: |
          Controls when command is completed.
          0 = Command doesn't complete until card has dropped the BUSY signal.
          1 = Complete command regardless of the BUSY signal. Status of signal can be read in
          MIO_EMM_RSP_STS[RSP_BUSYBIT].

      - name: BUS_ID
        bits: 61..60
        access: R/W
        reset: 0x0
        typical: --
        description: Specify the eMMC bus

      - name: CMD_VAL
        bits: 59
        access: R/W/H
        reset: --
        typical: --
        description: Request valid. Software writes this bit to a 1. Hardware clears it when the operation completes.

      - name: --
        bits: 58..56
        access: RAZ
        reset: 0x0
        typical: --
        description: Reserved.

      - name: DBUF
        bits: 55
        access: R/W
        reset: 0
        typical: --
        description: Specify the data buffer to be used for a block transfer.

      - name: OFFSET
        bits: 54..49
        access: R/W
        reset: 0x0
        typical: --
        description: |
          Debug only. Specify the number of 8-byte transfers used in the command. Value is
          64-OFFSET. The block transfer still starts at the first byte in the 512B data buffer.
          Software must ensure CMD16 has updated the card block length.

      - name: --
        bits: 48..43
        access: RAZ
        reset: 0x0
        typical: --
        description: Reserved.

      - name: CTYPE_XOR
        bits: 42..41
        access: R/W
        reset: 0x0
        typical: --
        description: |
          Command type override; typically zero. Value is XOR'd with the default command type. See
          Command and Response Types for command types per command index. Types are:
          0x0 = No data.
          0x1 = Read data into Dbuf.
          0x2 = Write data from Dbuf.
          0x3 = Reserved.

      - name: RTYPE_XOR
        bits: 40..38
        access: R/W
        reset: 0x0
        typical: --
        description: |
          Response type override; typically zero. Value is XOR'd with default response type. See
          Command and Response Types for response types per command index. Types are:
          0x0 = No Response.
          0x1 = R1, 48 bits.
          0x2 = R2, 136 bits.
          0x3 = R3, 48 bits.
          0x4 = R4, 48 bits.
          0x5 = R5, 48 bits.
          0x6, 0x7 = Reserved.

      - name: CMD_IDX
        bits: 37..32
        access: R/W/H
        reset: 0x0
        typical: --
        description: eMMC command

      - name: ARG
        bits: 31..0
        access: R/W/H
        reset: 0x0
        typical: --
        description: eMMC command argument


  - name: MIO_EMM_RSP_STS
    title: MIO eMMC Response Status Register
    address: 0x1180000002060
    bus: RSL
    fields:
      - name: --
        bits: 63..62
        access: RAZ
        reset: 0x0
        typical: --
        description: Reserved.

      - name: BUS_ID
        bits: 61..60
        access: RO/H
        reset: 0x0
        typical: --
        description: eMMC bus ID to which the response status corresponds.

      - name: CMD_VAL
        bits: 59
        access: RO/H
        reset: 0
        typical: --
        description: |
          Read-only copy of MIO_EMM_CMD[CMD_VAL]. CMD_VAL = 1 indicates that a direct operation is
          in progress.

      - name: SWITCH_VAL
        bits: 58
        access: RO/H
        reset: 0
        typical: --
        description: |
          Read-only copy of MIO_EMM_SWITCH[SWITCH_EXE]. SWITCH_VAL = 1 indicates that a switch
          operation is in progress.

      - name: DMA_VAL
        bits: 57
        access: RO/H
        reset: 0
        typical: --
        description: Read-only copy of MIO_EMM_DMA[DMA_VAL]. DMA_VAL = 1 indicates that a DMA operation is in progress.

      - name: DMA_PEND
        bits: 56
        access: RO/H
        reset: 0
        typical: --
        description: |
          The DMA engine has a pending transfer resulting from an error. Software can resume the
          transfer by writing MIO_EMM_DMA[DMA_VAL] = 1.

          Software can terminate the transfer by writing MIO_EMM_DMA[DMA_VAL] = 1 and
          MIO_EMM_DMA[DAT_NULL] = 1. Hardware will then clear DMA_PEND and perform the DMA
          operation.

      - name: ACC_TIMEOUT
        bits: 55
        access: RO/H
        reset: 0
        typical: --
        description: |
          The store operation to the device took longer than MIO_EMM_ACCESS_WDOG[CLK_CNT]
          coprocessor-clocks to complete.
          Valid when DMA_PEND=1.

      - name: --
        bits: 54..29
        access: RAZ
        reset: 0x0
        typical: --
        description: Reserved.

      - name: DBUF_ERR
        bits: 28
        access: RO/H
        reset: 0
        typical: --
        description: |
          For CMD_TYPE = 1, indicates that a DMA read data arrived from the card without a free
          DBUF. For CMD_TYPE = 2, indicates a DBUF underflow occurred during a DMA write. See
          MIO_EMM_DMA[THRES].

      - name: --
        bits: 27..24
        access: RAZ
        reset: 0x0
        typical: --
        description: Reserved.

      - name: DBUF
        bits: 23
        access: RO/H
        reset: 0
        typical: --
        description: DBUF corresponding to the most recently attempted block transfer.

      - name: BLK_TIMEOUT
        bits: 22
        access: RO/H
        reset: 0
        typical: --
        description: Timeout waiting for read data or 3-bit CRC token.

      - name: BLK_CRC_ERR
        bits: 21
        access: RO/H
        reset: 0
        typical: --
        description: |
          For CMD_TYPE = 1, indicates a card read data CRC mismatch. MIO_EMM_RSP_STS[DBUF] indicates
          the failing data buffer.

          For CMD_TYPE = 2, indicates card returned 3-bit CRC status token indicating that the card
          encountered a write data CRC check mismatch. MIO_EMM_RSP_STS[DBUF] indicates the failing
          data buffer.

      - name: RSP_BUSYBIT
        bits: 20
        access: RO/H
        reset: 0
        typical: --
        description: |
          Debug only. eMMC protocol utilizes DAT0 as a busy signal during block writes and R1b
          responses. This bit should read zero before any DMA or Command with data is executed.

      - name: STP_TIMEOUT
        bits: 19
        access: RO/H
        reset: 0
        typical: --
        description: Stop transmission response timeout.

      - name: STP_CRC_ERR
        bits: 18
        access: RO/H
        reset: 0
        typical: --
        description: Stop transmission response had a CRC error.

      - name: STP_BAD_STS
        bits: 17
        access: RO/H
        reset: 0
        typical: --
        description: Stop transmission response had bad status.

      - name: STP_VAL
        bits: 16
        access: RO/H
        reset: 0
        typical: --
        description: Stop transmission response valid.

      - name: RSP_TIMEOUT
        bits: 15
        access: RO/H
        reset: 0
        typical: --
        description: Response timeout.

      - name: RSP_CRC_ERR
        bits: 14
        access: RO/H
        reset: 0
        typical: --
        description: Response CRC error.

      - name: RSP_BAD_STS
        bits: 13
        access: RO/H
        reset: 0
        typical: --
        description: Response bad status.

      - name: RSP_VAL
        bits: 12
        access: RO/H
        reset: 0
        typical: --
        description: Response ID. See MIO_EMM_RSP_HI/MIO_EMM_RSP_LO.

      - name: RSP_TYPE
        bits: 11..9
        access: RO/H
        reset: 0x0
        typical: --
        description: Indicates the response type. See MIO_EMM_RSP_HI/MIO_EMM_RSP_LO.

      - name: CMD_TYPE
        bits: 8..7
        access: RO/H
        reset: 0x0
        typical: --
        description: |
          eMMC command type.
          0x0 = No data.
          0x1 = Read.
          0x2 = Write.

      - name: CMD_IDX
        bits: 6..1
        access: RO/H
        reset: 0x0
        typical: --
        description: eMMC command index most recently attempted.

      - name: CMD_DONE
        bits: 0
        access: RO/H
        reset: 0
        typical: --
        description: |
          eMMC command completed. Once the command has completed, the status is final and can be
          examined by software.


  - name: MIO_EMM_RSP_LO
    title: MIO eMMC Response Data Low Register
    address: 0x1180000002068
    bus: RSL
    fields:
      - name: DAT
        bits: 63..0
        access: RO/H
        reset: --
        typical: --
        description: |
          Command response (as per JEDEC eMMC spec and SD Specifications).

          <pre>
          RSP_TYPE = 1:
          DAT[63:46] = 0x0
          DAT[45:40] = Command index
          DAT[39: 8] = Card status
          DAT[ 7: 1] = CRC7
          DAT[    0] = End bit

          RSP_TYPE = 2:
          DAT[63: 1] = CID[63:1] or CSD[63:1] including CRC
          DAT[    0] = End bit

          RSP_TYPE = 3:
          DAT[63:46] = 0x0
          DAT[45:40] = Check bits (0x3F)
          DAT[39: 8] = OCR register
          DAT[ 7: 1] = Check bits (0x7F)
          DAT[    0] = End bit

          RSP_TYPE = 4:
          DAT[63:46] = 0x0
          DAT[45:40] = CMD39 ('10111')
          DAT[39:24] = RCA[31:16]
          DAT[   23] = Status
          DAT[22:16] = Register address
          DAT[15: 8] = Register contents
          DAT[ 7: 1] = CRC7
          DAT[    0] = End bit

          RSP_TYPE = 5:
          DAT[63:46] = 0x0
          DAT[45:40] = CMD40 ('10100')
          DAT[39:24] = RCA[31:16]
          DAT[   23] = Status
          DAT[22:16] = Register address
          DAT[15: 8] = Not defined. May be used for IRQ data
          DAT[ 7: 1] = CRC7
          DAT[    0] = End bit
          </pre>


  - name: MIO_EMM_RSP_HI
    title: MIO eMMC Response Data High Register
    address: 0x1180000002070
    bus: RSL
    fields:
      - name: DAT
        bits: 63..0
        access: RO/H
        reset: --
        typical: --
        description: |
          Command response (as per JEDEC eMMC spec and SD Specifications):
          _ RSP_TYPE = 1: DAT[63:0] = 0x0.
          _ RSP_TYPE = 2: DAT[63:0] = CID[127:64] or CSD[127:64].
          _ RSP_TYPE = 3: DAT[63:0] = 0x0.
          _ RSP_TYPE = 4: DAT[63:0] = 0x0.
          _ RSP_TYPE = 5: DAT[63:0] = 0x0.


  - name: MIO_EMM_INT
    title: MIO eMMC Interrupt Register
    address: 0x1180000002078
    bus: RSL
    fields:
      - name: --
        bits: 63..7
        access: RAZ
        reset: 0x0
        typical: --
        description: Reserved.

      - name: SWITCH_ERR
        bits: 6
        access: R/W1C/H
        reset: --
        typical: --
        description: |
          Switch operation encountered an error. Throws MIO_EMM_INTSN_E::MIO_EMM_INT_SWITCH_ERR.

      - name: SWITCH_DONE
        bits: 5
        access: R/W1C/H
        reset: --
        typical: --
        description: |
          Switch operation completed successfully. Throws MIO_EMM_INTSN_E::MIO_EMM_INT_SWITCH_DONE.

      - name: DMA_ERR
        bits: 4
        access: R/W1C/H
        reset: --
        typical: --
        description: |
          DMA transfer encountered an error. See MIO_EMM_RSP_STS. Throws
          MIO_EMM_INTSN_E::MIO_EMM_INT_DMA_ERR.

      - name: CMD_ERR
        bits: 3
        access: R/W1C/H
        reset: --
        typical: --
        description: |
          Operation specified by MIO_EMM_CMD encountered an error. See MIO_EMM_RSP_STS. Throws
          MIO_EMM_INTSN_E::MIO_EMM_INT_CMD_ERR.

      - name: DMA_DONE
        bits: 2
        access: R/W1C/H
        reset: --
        typical: --
        description: |
          DMA transfer completed successfully. Throws MIO_EMM_INTSN_E::MIO_EMM_INT_DMA_DONE.

      - name: CMD_DONE
        bits: 1
        access: R/W1C/H
        reset: --
        typical: --
        description: |
          Operation specified by MIO_EMM_CMD completed successfully. Throws
          MIO_EMM_INTSN_E::MIO_EMM_INT_CMD_DONE.

      - name: BUF_DONE
        bits: 0
        access: R/W1C/H
        reset: --
        typical: --
        description: |
          The next 512B block transfer of a multiblock transfer has completed. Throws
          MIO_EMM_INTSN_E::MIO_EMM_INT_BUF_DONE.


  - name: MIO_EMM_WDOG
    title: MIO eMMC Watchdog Register
    address: 0x1180000002088
    bus: RSL
    fields:
      - name: --
        bits: 63..26
        access: RAZ
        reset: 0x0
        typical: --
        description: Reserved.

      - name: CLK_CNT
        bits: 25..0
        access: R/W
        reset: 0x27ea818
        typical: --
        description: |
          Maximum number of CLK_CNT cycles to wait for the card to return a response, read data, or
          the 3-bit CRC status token following write data. The following timeouts are detected:

          Expected response to a command doesn't occur causing MIO_EMM_RSP_STS[RSP_TIMEOUT].

          On a read command, expected data isn't returned causing MIO_EMM_RSP_STS[BLK_TIMEOUT].

          On a multi read command, expected data isn't returned causing
          MIO_EMM_RSP_STS[BLK_TIMEOUT].

          On a write command, expected token to a write block isn't received causing
          MIO_EMM_RSP_STS[BLK_TIMEOUT].

          If a stop command is issued by the hardware and no response is returned causing
          MIO_EMM_RSP_STS[STP_TIMEOUT].

          Issues this timeout doesn't cover are stalls induced by the card which are not limited by
          the specifications.
          For example, when a write multi command is issued to the card and a block (not the last)
          is transferred the card can "stall" the Octeon by forcing emmc_data<0> low for as long as
          it wants to free up buffer space.

          The second case is when the last block of a write or multi write is being transferred and
          the card elects to perform some background tasks. The same stall mechanism with
          emmc_data<0> is used but this can last for an extend time period.


  - name: MIO_EMM_SAMPLE
    title: MIO eMMC Sampling Register
    address: 0x1180000002090
    bus: RSL
    fields:
      - name: --
        bits: 63..26
        access: RAZ
        reset: 0x0
        typical: --
        description: Reserved.

      - name: CMD_CNT
        bits: 25..16
        access: R/W
        reset: 0x0
        typical: 0x0
        description: Number of coprocessor-clocks before the eMMC clock rising edge to sample the command pin.

      - name: --
        bits: 15..10
        access: RAZ
        reset: 0x0
        typical: --
        description: Reserved.

      - name: DAT_CNT
        bits: 9..0
        access: R/W
        reset: 0x0
        typical: 0x0
        description: Number of coprocessor-clocks before the eMMC clock edge to sample the data pin.


  - name: MIO_EMM_STS_MASK
    title: MIO eMMC Status Mask Register
    address: 0x1180000002098
    bus: RSL
    fields:
      - name: --
        bits: 63..32
        access: RAZ
        reset: 0x0
        typical: --
        description: Reserved.

      - name: STS_MSK
        bits: 31..0
        access: R/W
        reset: 0xe4390080
        typical: --
        description: |
          Any bit set in STS_MSK causes the corresponding bit in the card status to be considered
          when computing response bad status.


  - name: MIO_EMM_RCA
    title: MIO eMMC Relative Card Address Register
    address: 0x11800000020A0
    bus: RSL
    fields:
      - name: --
        bits: 63..16
        access: RAZ
        reset: 0x0
        typical: --
        description: Reserved.

      - name: CARD_RCA
        bits: 15..0
        access: R/W/H
        reset: 0x1
        typical: 0x1
        description: |
          Whenever software performs CMD7, hardware updates CARD_RCA with the relative card address
          from the MIO_EMM_CMD[ARG], unless the operation encounters an error.


  - name: MIO_EMM_BUF_IDX
    title: MIO eMMC Data Buffer Address Register
    address: 0x11800000020E0
    bus: RSL
    fields:
      - name: --
        bits: 63..17
        access: RAZ
        reset: 0x0
        typical: --
        description: Reserved.

      - name: INC
        bits: 16
        access: R/W
        reset: 0
        typical: --
        description: |
          Automatically advance BUF_NUM/OFFSET after each access to MIO_EMM_BUF_DAT. Wraps after the
          last offset of the last data buffer.

      - name: --
        bits: 15..7
        access: RAZ
        reset: 0x0
        typical: --
        description: Reserved.

      - name: BUF_NUM
        bits: 6
        access: R/W
        reset: 0
        typical: --
        description: Specify the data buffer for the next access to MIO_EMM_BUF_DAT.

      - name: OFFSET
        bits: 5..0
        access: R/W
        reset: 0x0
        typical: --
        description: Specify the 8B data buffer offset for the next access to MIO_EMM_BUF_DAT.


  - name: MIO_EMM_BUF_DAT
    title: MIO eMMC Data Buffer Access Register
    address: 0x11800000020E8
    bus: RSL
    fields:
      - name: DAT
        bits: 63..0
        access: R/W/H
        reset: --
        typical: --
        description: Direct access to the 1KB data buffer memory. Address specified by MIO_EMM_BUF_IDX.


  - name: MIO_EMM_ACCESS_WDOG
    title: MIO eMMC Access Watchdog Register
    address: 0x11800000020F0
    bus: RSL
    fields:
      - name: --
        bits: 63..32
        access: RAZ
        reset: 0x0
        typical: --
        description: Reserved.

      - name: CLK_CNT
        bits: 31..0
        access: R/W
        reset: 0x0
        typical: --
        description: |
          Number of coprocessor-clocks to allow for a store operation to the device to complete
          before hardware will halt the operation.
          Hardware will inject an error on the next 512-byte block boundary.   The pending DMA
          operation can be resumed or terminated. A value of zero disables timer.



